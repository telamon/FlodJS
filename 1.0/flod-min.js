window.neoart=Object.create(null);
function ByteArray(n){var l=Object.create(null,{endian:{value:1,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},buffer:{value:null,writable:!0},view:{value:null,writable:!0},bytesAvailable:{get:function(){return this.length-this.index}},position:{get:function(){return this.index},set:function(e){0>e?e=0:e>this.length&&(e=this.length);this.index=e}},clear:{value:function(){this.buffer=new ArrayBuffer;this.view=null;this.index=this.length=0}},readAt:{value:function(e){return this.view.getUint8(e)}},
readByte:{value:function(){return this.view.getInt8(this.index++)}},readShort:{value:function(){var e=this.view.getInt16(this.index,this.endian);this.index+=2;return e}},readInt:{value:function(){var e=this.view.getInt32(this.index,this.endian);this.index+=4;return e}},readUbyte:{value:function(){return this.view.getUint8(this.index++)}},readUshort:{value:function(){var e=this.view.getUint16(this.index,this.endian);this.index+=2;return e}},readUint:{value:function(){var e=this.view.getUint32(this.index,
this.endian);this.index+=4;return e}},readBytes:{value:function(e,j,c){var e=e.view,f=this.index,a=this.view;if((c+=f)>this.length)c=this.length;for(;f<c;++f)e.setUint8(j++,a.getUint8(f))}},readString:{value:function(e){var j=this.index,c=this.view,f="";if((e+=j)>this.length)e=this.length;for(;j<e;++j)f+=String.fromCharCode(c.getUint8(j));this.index=e;return f}},writeAt:{value:function(e,j){this.view.setUint8(e,j)}},writeByte:{value:function(e){this.view.setInt8(this.index++,e)}},writeShort:{value:function(e){this.view.setInt16(this.index,
e);this.index+=2}},writeInt:{value:function(e){this.view.setInt32(this.index,e);this.index+=4}}});l.buffer=n;l.view=new DataView(n);l.length=n.byteLength;return Object.seal(l)}function Sample(){return Object.create(null,{l:{value:0,writable:!0},r:{value:0,writable:!0},next:{value:null,writable:!0}})}
function CoreMixer(){return Object.create(null,{player:{value:null,writable:!0},channels:{value:[],writable:!0},buffer:{value:[],writable:!0},samplesTick:{value:0,writable:!0},samplesLeft:{value:0,writable:!0},remains:{value:0,writable:!0},completed:{value:0,writable:!0},bufferSize:{get:function(){return this.buffer.length},set:function(n){var l;l=this.buffer.length||0;if(!(n==l||512>n))if(this.buffer.length=n,n>l){this.buffer[l]=Sample();for(l=++l;l<n;++l)this.buffer[l]=this.buffer[l-1].next=Sample()}}},
complete:{get:function(){return this.completed},set:function(n){this.completed=n^this.player.loopSong}},reset:{value:function(){var n=this.channels[0],l=this.buffer[0];for(this.completed=this.remains=this.samplesLeft=0;n;)n.initialize(),n=n.next;for(;l;)l.l=l.r=0,l=l.next}},restore:{configurable:!0,value:function(){}}})}
function CorePlayer(){var n=Object.create(null,{context:{value:null,writable:!0},node:{value:null,writable:!0},analyse:{value:0,writable:!0},endian:{value:0,writable:!0},sampleRate:{value:0,writable:!0},playSong:{value:0,writable:!0},lastSong:{value:0,writable:!0},version:{value:0,writable:!0},title:{value:"",writable:!0},channels:{value:0,writable:!0},loopSong:{value:0,writable:!0},speed:{value:0,writable:!0},tempo:{value:0,writable:!0},mixer:{value:null,writable:!0},tick:{value:0,writable:!0},paused:{value:0,
writable:!0},callback:{value:null,writable:!0},quality:{configurable:!0,set:function(l){this.callback=l?this.mixer.accurate.bind(this.mixer):this.mixer.fast.bind(this.mixer)}},toggle:{value:function(l){this.mixer.channels[l].mute^=1}},setup:{configurable:!0,value:function(){}},load:{value:function(l){this.lastSong=this.playSong=this.version=0;this.mixer.restore();l.view||(l=ByteArray(l));l.position=0;if(67324752==l.readUint())if(window.neoart.Unzip)l=ZipFile(l),l=l.uncompress(l.entries[0]);else throw"Unzip support is not available.";
l.endian=this.endian;l.position=0;this.loader(l);this.version&&this.setup();return this.version}},play:{value:function(){var l;this.version&&(this.paused?this.paused=0:(this.initialize(),this.node=this.context.createJavaScriptNode(this.mixer.bufferSize),this.node.onaudioprocess=this.callback),this.analyse&&window.neoart.Flectrum?(l=window.neoart.analyserNode=this.context.createAnalyser(),this.node.connect(l),l.connect(this.context.destination)):this.node.connect(this.context.destination),l=document.createEvent("Event"),
l.initEvent("flodPlay",!0,!1),document.dispatchEvent(l))}},pause:{value:function(){if(this.node){this.node.disconnect();this.paused=1;var l=document.createEvent("Event");l.initEvent("flodPause",!0,!1);document.dispatchEvent(l)}}},stop:{value:function(){if(this.node){this.node.disconnect();this.node.onaudioprocess=this.node=null;this.paused=0;var l=document.createEvent("Event");l.initEvent("flodStop",!0,!1);document.dispatchEvent(l)}}},reset:{value:function(){this.tick=0;this.mixer.initialize();this.mixer.samplesTick=
2.5*this.sampleRate/this.tempo>>0}}});window.neoart.audioContext||(window.neoart.audioContext=new webkitAudioContext);n.context=window.neoart.audioContext;n.sampleRate=n.context.sampleRate;return n}
function ZipFile(n){function l(a){var b=Object.create(null,{count:{value:null,writable:!0},symbol:{value:null,writable:!0}});b.count=new Uint16Array(a);b.symbol=new Uint16Array(a);return Object.seal(b)}function e(){var j=Object.create(null,{output:{value:null,writable:!0},inpbuf:{value:null,writable:!0},inpcnt:{value:0,writable:!0},outcnt:{value:0,writable:!0},bitbuf:{value:0,writable:!0},bitcnt:{value:0,writable:!0},flencode:{value:null,writable:!0},fdiscode:{value:null,writable:!0},dlencode:{value:null,
writable:!0},ddiscode:{value:null,writable:!0},input:{set:function(a){this.inpbuf=a[0];this.inpbuf.endian=a[2];this.inpcnt=this.inpbuf.position=0;this.output=ByteArray(new ArrayBuffer(a[1]));this.output.endian=a[2];this.outcnt=this.output.position=0}},inflate:{value:function(){var a,b;do if(b=this.bits(1),a=this.bits(2),a=0==a?this.stored():1==a?this.codes(this.flencode,this.fdiscode):2==a?this.dynamic():1)throw c;while(!b)}},initialize:{value:function(){var a=new Uint8Array(288),b=0;this.flencode=
l(288);for(this.fdiscode=l(30);144>b;++b)a[b]=8;for(;256>b;++b)a[b]=9;for(;280>b;++b)a[b]=7;for(;288>b;++b)a[b]=8;this.construct(this.fdiscode,a,288);for(b=0;30>b;++b)a[b]=5;this.construct(this.fdiscode,a,30);this.dlencode=l(286);this.ddiscode=l(30)}},construct:{value:function(a,b,d){for(var c=0,h=1,g=new Uint16Array(16),f=0;16>c;++c)a.count[c]=0;for(;f<d;++f)a.count[b[f]]++;if(a.count[0]==d)return 0;for(c=1;16>c;++c)if(h<<=1,h-=a.count[c],0>h)return h;for(c=1;15>c;++c)g[c+1]=g[c]+a.count[c];for(f=
0;f<d;++f)0!=b[f]&&(a.symbol[g[b[f]]++]=f);return h}},bits:{value:function(a){for(var b=this.bitbuf,d=this.inpbuf.length;this.bitcnt<a;){if(this.inpcnt==d)throw f;b|=this.inpbuf.readAt(this.inpcnt++)<<this.bitcnt;this.bitcnt+=8}this.bitbuf=b>>a;this.bitcnt-=a;return b&(1<<a)-1}},codes:{value:function(b,d){var c,h,g;do{g=this.decode(b);if(0>g)return g;if(256>g)this.output.writeAt(this.outcnt++,g);else if(256<g){g-=257;if(29<=g)throw ERRRO7;h=p[g]+this.bits(o[g]);g=this.decode(d);if(0>g)return g;c=
r[g]+this.bits(u[g]);if(c>this.outcnt)throw a;for(c=this.outcnt-c;h--;)this.output.writeAt(this.outcnt++,this.output.readAt(c++))}}while(256!=g);return 0}},decode:{value:function(a){for(var b=this.bitbuf,d=0,c,h=0,g=0,i=this.inpbuf.length,j=this.bitcnt,e=1;;){for(;j--;){d|=b&1;b>>=1;c=a.count[e];if(d<h+c)return this.bitbuf=b,this.bitcnt=this.bitcnt-e&7,a.symbol[g+(d-h)];g+=c;h+=c;h<<=1;d<<=1;++e}j=16-e;if(!j)break;if(this.inpcnt==i)throw f;b=this.inpbuf.readAt(this.inpcnt++);8<j&&(j=8)}return-9}},
stored:{value:function(){var a=this.inpbuf.length,d;this.bitbuf=this.bitcnt=0;if(this.inpcnt+4>a)throw f;d=this.inpbuf.readAt(this.inpcnt++);d|=this.inpbuf.readAt(this.inpcnt++)<<8;if(this.inpbuf.readAt(this.inpcnt++)!=(~d&255)||this.inpbuf.readAt(this.inpcnt++)!=(~d>>8&255))throw b;if(this.inpcnt+d>a)throw f;for(;d--;)this.output.writeAt(this.outcnt++,this.inpbuf.readAt(this.inpcnt++));return 0}},dynamic:{value:function(){var a=new Uint8Array(316),b;b=0;var c,f=this.bits(5)+257,j=this.bits(5)+1;
c=this.bits(4)+4;var e=f+j,r;if(286<f||30<j)throw h;for(;b<c;++b)a[t[b]]=this.bits(3);for(;19>b;++b)a[t[b]]=0;if(b=this.construct(this.dlencode,a,19))throw d;for(b=0;b<e;)if(r=this.decode(this.dlencode),16>r)a[b++]=r;else{c=0;if(16==r){if(0==b)throw g;c=a[b-1];r=3+this.bits(2)}else r=17==r?3+this.bits(3):11+this.bits(7);if(b+r>e)throw i;for(;r--;)a[b++]=c}b=this.construct(this.dlencode,a,f);if(0>b||0<b&&1!=f-this.dlencode.count[0])throw q;b=this.construct(this.ddiscode,a.subarray(f),j);if(0>b||0<
b&&1!=j-this.ddiscode.count[0])throw m;return this.codes(this.dlencode,this.ddiscode)}}});j.initialize();return Object.seal(j)}function j(){return Object.create(null,{name:{value:"",writable:!0},extra:{value:null,writable:!0},version:{value:0,writable:!0},flag:{value:0,writable:!0},method:{value:0,writable:!0},time:{value:0,writable:!0},crc:{value:0,writable:!0},compressed:{value:0,writable:!0},size:{value:0,writable:!0},offset:{value:0,writable:!0},date:{get:function(){return new Date((this.time>>
25&127)+1980,(this.time>>21&15)-1,this.time>>16&31,this.time>>11&31,this.time>>5&63,(this.time&31)<<1)}},isDirectory:{get:function(){return"/"==this.name.charAt(this.name.length-1)}}})}if(!n)return null;var c="Invalid block type.",f="Available inflate data did not terminate.",a="Distance is too far back.",b="Stored block length did not match one's complement.",h="Too many length or distance codes.",d="Code lengths codes incomplete.",g="Repeat lengths with no first length.",i="Repeat more than specified lengths.",
q="Invalid literal/length code lengths.",m="Invalid distance code lengths.",p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],s=Object.create(null,{endian:{value:1,
writable:!0},entries:{value:null,writable:!0},stream:{value:null,writable:!0},uncompress:{value:function(a){var b=this.stream,d;if(!a)return null;b.position=a.offset+28;d=b.readUshort();b.position=30+a.name.length+d;if(a.compressed)switch(d=ByteArray(new ArrayBuffer(a.compressed),this.endian),b.readBytes(d,0,a.compressed),a.method){case 0:return d;case 8:return b=e(),b.input=[d,a.size,this.endian],b.inflate(),b.output;default:throw"Compression method not supported.";}}},parseCentral:{value:function(){for(var a=
this.stream,b,d=ByteArray(new ArrayBuffer(46),this.endian),c=0,h=this.entries.length,g;c<h;++c){a.readBytes(d,0,46);if(33639248!=d.readUint())throw"Unexpected end of archive.";d.position+=24;g=d.readUshort();if(!g)throw"Unexpected end of archive.";b=j();b.name=a.readString(g);if(g=d.readUshort())b.extra=ByteArray(new ArrayBuffer(g),this.endian),a.readBytes(b.extra,0,g);a.position+=d.readUshort();d.position=6;b.version=d.readUshort();b.flag=d.readUshort();if(1==(b.flag&1))throw"Encrypted archive not supported.";
b.method=d.readUshort();b.time=d.readUint();b.crc=d.readUint();b.compressed=d.readUint();b.size=d.readUint();d.position=42;b.offset=d.readUint();Object.freeze(b);this.entries[c]=b}}},parseEnd:{value:function(){var a=this.stream,b=a.length-22,d=b-65536;0>d&&(d=0);do if(80==a.readAt(b)&&(a.position=b,101010256==a.readUint()))break;while(--b>d);if(b==d)throw"The archive is either in unknown format or damaged.";a.position=b+10;this.entries=[];this.entries.length=a.readUshort();a.position=b+16;a.position=
a.readUint();this.parseCentral()}}});n.view||(n=ByteArray(n));n.endian=1;n.position=0;s.stream=n;s.parseEnd();return Object.seal(s)}window.neoart.Unzip=1;
function AmigaChannel(n){var l=Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},panning:{value:0,writable:!0},delay:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},audena:{value:0,writable:!0},audcnt:{value:0,writable:!0},audloc:{value:0,writable:!0},audper:{value:0,writable:!0},audvol:{value:0,writable:!0},timer:{value:0,writable:!0},level:{value:0,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},enabled:{get:function(){return this.audena},
set:function(e){e!=this.audena&&(this.audena=e,this.audloc=this.pointer,this.audcnt=this.pointer+this.length,this.timer=1,e&&(this.delay+=2))}},period:{set:function(e){if(1>e||65535<e)e=65535;this.audper=e}},volume:{set:function(e){0>e?e=0:64<e&&(e=64);this.audvol=e}},initialize:{value:function(){this.audloc=this.audcnt=this.audena=0;this.audper=50;this.length=this.pointer=this.delay=this.rdata=this.ldata=this.timer=this.audvol=0}},resetData:{value:function(){this.rdata=this.ldata=0}}});l.panning=
l.level=0==(++n&2)?-1:1;return Object.seal(l)}
function AmigaFilter(){return Object.create(null,{active:{value:0,writable:!0},forced:{value:-1,writable:!0},l0:{value:0,writable:!0},l1:{value:0,writable:!0},l2:{value:0,writable:!0},l3:{value:0,writable:!0},l4:{value:0,writable:!0},r0:{value:0,writable:!0},r1:{value:0,writable:!0},r2:{value:0,writable:!0},r3:{value:0,writable:!0},r4:{value:0,writable:!0},initialize:{value:function(){this.r0=this.r1=this.r2=this.r3=this.r4=this.l0=this.l1=this.l2=this.l3=this.l4=0}},process:{value:function(n,l){var e=
0.5139651662784244;0==n&&(this.l0=0.4860348337215757*l.l+e*this.l0,this.r0=0.4860348337215757*l.r+e*this.r0,e=0.06850445132502514,l.l=this.l1=0.9314955486749749*this.l0+e*this.l1,l.r=this.r1=0.9314955486749749*this.r0+e*this.r1);0<(this.active|this.forced)&&(e=0.47866541564678,this.l2=0.52133458435322*l.l+e*this.l2,this.r2=0.52133458435322*l.r+e*this.r2,this.l3=0.52133458435322*this.l2+e*this.l3,this.r3=0.52133458435322*this.r2+e*this.r3,l.l=this.l4=0.52133458435322*this.l3+e*this.l4,l.r=this.r4=
0.52133458435322*this.r3+e*this.r4);1<l.l?l.l=1:-1>l.l&&(l.l=-1);1<l.r?l.r=1:-1>l.r&&(l.r=-1)}}})}function AmigaRow(){return Object.create(null,{note:{value:0,writable:!0},sample:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}
function AmigaSample(){return Object.create(null,{name:{value:"",writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},repeat:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0}})}function AmigaStep(){return Object.create(null,{pattern:{value:0,writable:!0},transpose:{value:0,writable:!0}})}
function Amiga(){var n=CoreMixer();Object.defineProperties(n,{filter:{value:null,writable:!0},model:{value:1,writable:!0},memory:{value:[],writable:!0},loopPtr:{value:0,writable:!0},loopLen:{value:4,writable:!0},clock:{value:0,writable:!0},master:{value:0,writable:!0},ready:{value:0,writable:!0},volume:{set:function(l){0<l?(64<l&&(l=64),this.master=0.00390625*(l/64)):this.master=0}},initialize:{value:function(){var l=this.memory.length,e=l+this.loopLen;this.reset();this.filter.initialize();if(!this.ready){this.ready=
1;for(this.loopPtr=l;l<e;++l)this.memory[l]=0}}},restore:{value:function(){this.ready=0;this.memory.length=0}},store:{value:function(l,e,j){var c,f,a=l.position,b=this.memory.length;j&&(l.position=j);f=l.position+e;f>=l.length&&(c=f-l.length,e=l.length-l.position);for(f=b,e+=b;f<e;++f)this.memory[f]=l.readByte();for(e+=c;f<e;++f)this.memory[f]=0;j&&(l.position=a);return b}},fast:{value:function(l){var e,j,c=this.memory,f,a=0,b,h=0,d,g,i=this.bufferSize,q,m,p;if(this.completed){if(!this.remains){this.player.stop();
return}i=this.remains}for(;a<i;){this.samplesLeft||(this.player.process(),this.samplesLeft=this.samplesTick,this.completed&&(i=a+this.samplesTick,i>this.bufferSize&&(this.remains=i-this.bufferSize,i=this.bufferSize)));m=this.samplesLeft;a+m>=i&&(m=i-a);b=h+m;for(e=this.channels[0];e;){g=this.buffer[h];if(e.audena){q=e.audper/this.clock;p=e.audvol*this.master;f=p*(1-e.level);d=p*(1+e.level);for(j=h;j<b;++j)e.delay?e.delay--:1>--e.timer&&(e.mute||(p=0.0078125*c[e.audloc],e.ldata=p*f,e.rdata=p*d),e.audloc++,
e.timer+=q,e.audloc>=e.audcnt&&(e.audloc=e.pointer,e.audcnt=e.pointer+e.length)),g.l+=e.ldata,g.r+=e.rdata,g=g.next}else for(j=h;j<b;++j)g.l+=e.ldata,g.r+=e.rdata,g=g.next;e=e.next}h=b;a+=m;this.samplesLeft-=m}p=this.model;c=this.filter;g=this.buffer[0];e=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);for(j=0;j<i;++j)c.process(p,g),e[j]=g.l,l[j]=g.r,g.l=g.r=0,g=g.next}}});n.channels[0]=AmigaChannel(0);n.channels[0].next=n.channels[1]=AmigaChannel(1);n.channels[1].next=n.channels[2]=
AmigaChannel(2);n.channels[2].next=n.channels[3]=AmigaChannel(3);n.bufferSize=8192;n.filter=AmigaFilter();n.master=0.00390625;return Object.seal(n)}
function AmigaPlayer(n){var l=CorePlayer();Object.defineProperties(l,{quality:{set:function(){this.callback=this.mixer.fast.bind(this.mixer)}},stereo:{set:function(e){var j=this.mixer.channels[0];for(0>e?e=0:1<e&&(e=1);j;)j.level=e*j.panning,j=j.next}},volume:{set:function(e){0>e?e=0:1<e&&(e=1);this.mixer.master=0.00390625*e}},frequency:{value:function(e){e?(this.mixer.clock=3579545/this.sampleRate,this.mixer.samplesTick=735):(this.mixer.clock=3546895/this.sampleRate,this.mixer.samplesTick=882)}}});
l.mixer=n||Amiga();l.mixer.player=l;l.frequency(0);l.channels=4;l.endian=0;l.quality=0;l.speed=6;l.tempo=125;return l}
function SBChannel(){return Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},enabled:{value:0,writable:!0},sample:{value:null,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},pointer:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},speed:{value:0,writable:!0},dir:{value:0,writable:!0},oldSample:{value:null,writable:!0},oldLength:{value:0,writable:!0},oldPointer:{value:0,writable:!0},oldFraction:{value:0,writable:!0},
oldSpeed:{value:0,writable:!0},oldDir:{value:0,writable:!0},volume:{value:0,writable:!0},lvol:{value:0,writable:!0},rvol:{value:0,writable:!0},panning:{value:128,writable:!0},lpan:{value:0.5,writable:!0},rpan:{value:0.5,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},mixCounter:{value:0,writable:!0},lmixRampU:{value:0,writable:!0},lmixDeltaU:{value:0,writable:!0},rmixRampU:{value:0,writable:!0},rmixDeltaU:{value:0,writable:!0},lmixRampD:{value:0,writable:!0},lmixDeltaD:{value:0,
writable:!0},rmixRampD:{value:0,writable:!0},rmixDeltaD:{value:0,writable:!0},volCounter:{value:0,writable:!0},lvolDelta:{value:0,writable:!0},rvolDelta:{value:0,writable:!0},panCounter:{value:0,writable:!0},lpanDelta:{value:0,writable:!0},rpanDelta:{value:0,writable:!0},initialize:{value:function(){this.enabled=0;this.sample=null;this.dir=this.speed=this.fraction=this.delta=this.pointer=this.index=this.length=0;this.oldSample=null;this.rvol=this.lvol=this.volume=this.oldDir=this.oldSpeed=this.oldFraction=
this.oldPointer=this.oldLength=0;this.panning=128;this.rpan=this.lpan=0.5;this.rpanDelta=this.lpanDelta=this.panCounter=this.rvolDelta=this.lvolDelta=this.volCounter=this.rmixDeltaD=this.rmixRampD=this.lmixDeltaD=this.lmixRampD=this.rmixDeltaU=this.rmixRampU=this.lmixDeltaU=this.lmixRampU=this.mixCounter=this.rdata=this.ldata=0}}})}
function SBSample(){return Object.create(null,{name:{value:"",writable:!0},bits:{value:8,writable:!0},volume:{value:0,writable:!0},length:{value:0,writable:!0},data:{value:[],writable:!0},loopMode:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopLen:{value:0,writable:!0},store:{value:function(n){var l=0,e,j=this.length,c;this.loopLen||(this.loopMode=0);c=n.position;this.loopMode?(j=this.loopStart+this.loopLen,this.data=new Float32Array(j+1)):this.data=new Float32Array(this.length+1);if(8==
this.bits){c+j>n.length&&(j=n.length-c);for(e=0;e<j;e++)l=n.readByte()+l,-128>l?l+=256:127<l&&(l-=256),this.data[e]=0.0078125*l}else{c+(j<<1)>n.length&&(j=n.length-c>>1);for(e=0;e<j;e++)l=n.readShort()+l,-32768>l?l+=65536:32767<l&&(l-=65536),this.data[e]=3.051758E-5*l}l=c+length;this.loopMode?(this.length=this.loopStart+this.loopLen,this.data[j]=1==this.loopMode?this.data[this.loopStart]:this.data[j-1]):this.data[this.length]=0;if(j!=this.length){c=this.data[j-1];for(e=j;e<this.length;e++)this.data[e]=
c}n.position=l<n.length?l:n.length-1}}})}
function Soundblaster(){var n=CoreMixer();Object.defineProperties(n,{setup:{value:function(l){var e=1;this.channels.length=l;for(this.channels[0]=SBChannel();e<l;++e)this.channels[e]=this.channels[e-1].next=SBChannel()}},initialize:{value:function(){this.reset()}},fast:{value:function(l){var e,j,c,f=0,a,b=0,h,d,g=this.bufferSize,i,q;if(this.completed){if(!this.remains){this.player.stop();return}g=this.remains}for(;f<g;){this.samplesLeft||(this.player.process(),this.player.fast(),this.samplesLeft=
this.samplesTick,this.completed&&(g=f+this.samplesTick,g>this.bufferSize&&(this.remains=g-this.bufferSize,g=this.bufferSize)));i=this.samplesLeft;f+i>=g&&(i=g-f);a=b+i;for(e=this.channels[0];e;){if(e.enabled){h=e.sample;j=h.data;d=this.buffer[b];for(c=b;c<a;++c){if(e.index!=e.pointer){if(e.index>=e.length)if(h.loopMode)e.pointer=h.loopStart+(e.index-e.length),e.length=h.length,2==h.loopMode&&(e.dir=e.dir?0:h.length+h.loopStart-1);else{e.enabled=0;break}else e.pointer=e.index;e.mute?(e.ldata=0,e.rdata=
0):(q=e.dir?j[e.dir-e.pointer]:j[e.pointer],e.ldata=q*e.lvol,e.rdata=q*e.rvol)}e.index=e.pointer+e.delta;if(1<=(e.fraction+=e.speed))e.index++,e.fraction--;d.l+=e.ldata;d.r+=e.rdata;d=d.next}}e=e.next}b=a;f+=i;this.samplesLeft-=i}d=this.buffer[0];e=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);for(c=0;c<g;++c)1<d.l?d.l=1:-1>d.l&&(d.l=-1),1<d.r?d.r=1:-1>d.r&&(d.r=-1),e[c]=d.l,l[c]=d.r,d.l=d.r=0,d=d.next}},accurate:{value:function(l){var e,j,c,f,a,b=0,h,d=0,g,i,q,m,p=this.bufferSize,
o,r;if(this.completed){if(!this.remains){this.player.stop();return}p=this.remains}for(;b<p;){this.samplesLeft||(this.player.process(),this.player.accurate(),this.samplesLeft=this.samplesTick,this.completed&&(p=b+this.samplesTick,p>this.bufferSize&&(this.remains=p-this.bufferSize,p=this.bufferSize)));o=this.samplesLeft;b+o>=p&&(o=p-b);h=d+o;for(e=this.channels[0];e;){if(e.enabled){i=e.sample;j=i.data;if(q=e.oldSample)c=q.data;m=this.buffer[d];for(a=d;a<h;++a){r=e.mute?0:j[e.pointer];r+=(j[e.pointer+
e.dir]-r)*e.fraction;if(1<=(e.fraction+=e.speed))f=e.fraction>>0,e.fraction-=f,0<e.dir?(e.pointer+=f,e.pointer>e.length&&(e.fraction+=e.pointer-e.length,e.pointer=e.length)):(e.pointer-=f,e.pointer<e.length&&(e.fraction+=e.length-e.pointer,e.pointer=e.length));if(e.mixCounter){if(q){g=e.mute?0:c[e.oldPointer];g+=(c[e.oldPointer+e.oldDir]-g)*e.oldFraction;if(1<(e.oldFraction+=e.oldSpeed))f=e.oldFraction>>0,e.oldFraction-=f,0<e.oldDir?(e.oldPointer+=f,e.oldPointer>e.oldLength&&(e.oldFraction+=e.oldPointer-
e.oldLength,e.oldPointer=e.oldLength)):(e.oldPointer-=f,e.oldPointer<e.oldLength&&(e.oldFraction+=e.oldLength-e.oldPointer,e.oldPointer=e.oldLength));m.l+=r*e.lmixRampU+g*e.lmixRampD;m.r+=r*e.rmixRampU+g*e.rmixRampD;e.lmixRampD-=e.lmixDeltaD;e.rmixRampD-=e.rmixDeltaD}else m.l+=r*e.lmixRampU,m.r+=r*e.rmixRampU;e.lmixRampU+=e.lmixDeltaU;e.rmixRampU+=e.rmixDeltaU;e.mixCounter--;e.oldPointer==e.oldLength&&(q.loopMode?1==q.loopMode?(e.oldPointer=q.loopStart,e.oldLength=q.length):0<e.oldDir?(e.oldPointer=
q.length-1,e.oldLength=q.loopStart,e.oldDir=-1):(e.oldFraction-=1,e.oldPointer=q.loopStart,e.oldLength=q.length,e.oldDir=1):(q=null,e.oldPointer=0))}else m.l+=r*e.lvol,m.r+=r*e.rvol,e.volCounter?(e.lvol+=e.lvolDelta,e.rvol+=e.rvolDelta,e.volCounter--):e.panCounter&&(e.lpan+=e.lpanDelta,e.rpan+=e.rpanDelta,e.panCounter--,e.lvol=e.volume*e.lpan,e.rvol=e.volume*e.rpan);if(e.pointer==e.length)if(i.loopMode)1==i.loopMode?(e.pointer=i.loopStart,e.length=i.length):0<e.dir?(e.pointer=i.length-1,e.length=
i.loopStart,e.dir=-1):(e.fraction-=1,e.pointer=i.loopStart,e.length=i.length,e.dir=1);else{e.enabled=0;break}m=m.next}}e=e.next}d=h;b+=o;this.samplesLeft-=o}m=this.buffer[0];e=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);for(a=0;a<p;++a)1<m.l?m.l=1:-1>m.l&&(m.l=-1),1<m.r?m.r=1:-1>m.r&&(m.r=-1),e[a]=m.l,l[a]=m.r,m.l=m.r=0,m=m.next}}});n.bufferSize=8192;return Object.seal(n)}
function SBPlayer(n){var l=CorePlayer();Object.defineProperties(l,{track:{value:null,writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},timer:{value:0,writable:!0},master:{value:0,writable:!0},setup:{configurable:!1,value:function(){this.mixer.setup(this.channels)}}});l.mixer=n||Soundblaster();l.mixer.player=l;l.endian=1;l.quality=1;return l}
(function(){var n="Unknown Format,Ultimate SoundTracker,D.O.C. SoundTracker 9,Master SoundTracker,D.O.C. SoundTracker 2.0/2.2,SoundTracker 2.3,SoundTracker 2.4,NoiseTracker 1.0,NoiseTracker 1.1,NoiseTracker 2.0,ProTracker 1.0,ProTracker 1.1/2.1,ProTracker 1.2/2.0,His Master's NoiseTracker,SoundFX 1.0/1.7,SoundFX 1.8,SoundFX 1.945,SoundFX 1.994/2.0,BP SoundMon V1,BP SoundMon V2,BP SoundMon V3,Delta Music 1.0,Delta Music 2.0,Digital Mugician,Digital Mugician 7 Voices,Future Composer 1.0/1.3,Future Composer 1.4,SidMon 1.0,SidMon 2.0,FastTracker II,Sk@leTracker,MadTracker 2.0,MilkyTracker,OpenMPT".split(",");window.neoart.FileLoader=
function(){var l=Object.create(null,{player:{value:null,writable:!0},index:{value:0,writable:!0},amiga:{value:null,writable:!0},mixer:{value:null,writable:!0},tracker:{get:function(){return this.player?n[this.index+this.player.version]:""}},load:{value:function(e){var j;e.view||(e=ByteArray(e));e.endian=1;e.position=0;if(67324752==e.readUint())if(window.neoart.Unzip)e=ZipFile(e),e=e.uncompress(e.entries[0]);else throw"Unzip support is not available.";if(this.player&&"STPlayer"!=this.player.id&&(this.player.load(e),
this.player.version))return player;if(336<e.length&&(e.position=38,j=e.readString(20),"FastTracker v2.00   "==j||"Sk@le Tracker"==j||"MadTracker 2.0"==j||"MilkyTracker        "==j||-1!=j.indexOf("OpenMPT")))if(this.player=window.neoart.F2Player(this.mixer),this.player.load(e),this.player.version)return this.index=28,this.player;if(2149<e.length)if(e.position=1080,j=e.readString(4),"M.K."==j||"FLT4"==j){if(this.player=window.neoart.MKPlayer(this.amiga),this.player.load(e),this.player.version)return this.index=
4,this.player}else if("FEST"==j&&(this.player=window.neoart.HMPlayer(this.amiga),this.player.load(e),this.player.version))return this.index=12,this.player;if(2149<e.length&&(e.position=1080,j=e.readString(4),"M.K."==j||"M!K!"==j))if(this.player=window.neoart.PTPlayer(this.amiga),this.player.load(e),this.player.version)return this.index=9,this.player;if(1685<e.length&&(e.position=60,j=e.readString(4),"SONG"!=j&&(e.position=124,j=e.readString(4)),"SONG"==j||"SO31"==j))if(this.player=window.neoart.FXPlayer(this.amiga),
this.player.load(e),this.player.version)return this.index=13,this.player;if(4<e.length&&(e.position=0,j=e.readString(4),"ALL "==j&&(this.player=window.neoart.D1Player(this.amiga),this.player.load(e),this.player.version))||3018<e.length&&(e.position=3014,j=e.readString(4),".FNL"==j&&(this.player=window.neoart.D2Player(this.amiga),this.player.load(e),this.player.version)))return this.index=20,this.player;if(30<e.length&&(e.position=26,j=e.readString(3),"BPS"==j||"V.2"==j||"V.3"==j))if(this.player=window.neoart.BPPlayer(this.amiga),
this.player.load(e),this.player.version)return this.index=17,this.player;if(4<e.length&&(e.position=0,j=e.readString(4),"SMOD"==j||"FC14"==j))if(this.player=window.neoart.FCPlayer(this.amiga),this.player.load(e),this.player.version)return this.index=24,this.player;if(10<e.length&&(e.position=0,j=e.readString(9)," MUGICIAN"==j&&(this.player=window.neoart.DMPlayer(this.amiga),this.player.load(e),this.player.version)))return this.index=22,this.player;if(86<e.length&&(e.position=58,j=e.readString(28),
"SIDMON II - THE MIDI VERSION"==j&&(this.player=window.neoart.S2Player(this.amiga),this.player.load(e),this.player.version)))return this.index=26,this.player;if(5220<e.length&&(this.player=window.neoart.S1Player(this.amiga),this.player.load(e),this.player.version))return this.index=26,this.player;if(1625<e.length&&(this.player=window.neoart.STPlayer(this.amiga),this.player.load(e),this.player.version))return this.index=0,this.player;this.player=window.neoart.DWPlayer(this.amiga);this.player.load(e);
if(this.player.version)return this.index=WHITTAKER,this.player;e.clear();this.index=0;return this.player=null}}});l.amiga=Amiga();return Object.seal(l)}()})();
(function(){function n(j){return Object.create(null,{index:{value:j,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,writable:!0},restart:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},synth:{value:0,writable:!0},synthPtr:{value:0,writable:!0},arpeggio:{value:0,writable:!0},autoArpeggio:{value:0,writable:!0},autoSlide:{value:0,writable:!0},
vibrato:{value:0,writable:!0},volume:{value:0,writable:!0},volumeDef:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrPtr:{value:0,writable:!0},adsrCtr:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoPtr:{value:0,writable:!0},lfoCtr:{value:0,writable:!0},egControl:{value:0,writable:!0},egPtr:{value:0,writable:!0},egCtr:{value:0,writable:!0},egValue:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxCtr:{value:0,writable:!0},modControl:{value:0,writable:!0},modPtr:{value:0,
writable:!0},modCtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.enabled=0;this.samplePtr=this.sample=this.period=this.note=this.restart=0;this.sampleLen=2;this.synth=0;this.synthPtr=-1;this.modCtr=this.modPtr=this.modControl=this.fxCtr=this.fxControl=this.egValue=this.egCtr=this.egPtr=this.egControl=this.lfoCtr=this.lfoPtr=this.lfoControl=this.adsrCtr=this.adsrPtr=this.adsrControl=this.volumeDef=this.volume=this.vibrato=this.autoSlide=this.autoArpeggio=this.arpeggio=
0}}})}var l=[6848,6464,6080,5760,5440,5120,4832,4576,4320,4064,3840,3616,3424,3232,3040,2880,2720,2560,2416,2288,2160,2032,1920,1808,1712,1616,1520,1440,1360,1280,1208,1144,1080,1016,960,904,856,808,760,720,680,640,604,572,540,508,480,452,428,404,380,360,340,320,302,286,270,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95,90,85,80,76,72,68,64,60,57],e=[0,64,128,64,0,-64,-128,-64];window.neoart.BPPlayer=function(j){j=AmigaPlayer(j);Object.defineProperties(j,{id:{value:"BPPlayer"},
tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},buffer:{value:null,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},nextPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},repeatCtr:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},initialize:{value:function(){var c,f,a,b=this.voices[0];this.reset();this.speed=6;this.tick=1;
this.repeatCtr=this.jumpFlag=this.nextPos=this.patternPos=this.trackPos=0;this.arpeggioCtr=1;for(this.vibratoPos=0;b;){if(-1<b.synthPtr){a=b.index<<5;f=b.synthPtr+32;for(c=b.synthPtr;c<f;++c)this.mixer.memory[c]=this.buffer[a++]}b.initialize();b.channel=this.mixer.channels[b.index];b.samplePtr=this.mixer.loopPtr;b=b.next}for(c=0;128>c;++c)this.buffer[c]=0}},loader:{value:function(c){var f=0,a=0,b,h,d;this.title=c.readString(26);b=c.readString(4);if("BPSM"==b)this.version=1;else{b=b.substr(0,3);if("V.2"==
b)this.version=2;else if("V.3"==b)this.version=3;else return;c.position=29;d=c.readUbyte()}for(this.length=c.readUshort();16>++a;)b=AmigaSample(),Object.defineProperties(b,{synth:{value:0,writable:!0},table:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrTable:{value:0,writable:!0},adsrLen:{value:0,writable:!0},adsrSpeed:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoTable:{value:0,writable:!0},lfoDepth:{value:0,writable:!0},lfoLen:{value:0,writable:!0},lfoDelay:{value:0,writable:!0},
lfoSpeed:{value:0,writable:!0},egControl:{value:0,writable:!0},egTable:{value:0,writable:!0},egLen:{value:0,writable:!0},egDelay:{value:0,writable:!0},egSpeed:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxDelay:{value:0,writable:!0},fxSpeed:{value:0,writable:!0},modControl:{value:0,writable:!0},modTable:{value:0,writable:!0},modLen:{value:0,writable:!0},modDelay:{value:0,writable:!0},modSpeed:{value:0,writable:!0}}),b=Object.seal(b),255==c.readUbyte()?(b.synth=1,b.table=c.readUbyte(),b.pointer=
b.table<<6,b.length=c.readUshort()<<1,b.adsrControl=c.readUbyte(),b.adsrTable=c.readUbyte()<<6,b.adsrLen=c.readUshort(),b.adsrSpeed=c.readUbyte(),b.lfoControl=c.readUbyte(),b.lfoTable=c.readUbyte()<<6,b.lfoDepth=c.readUbyte(),b.lfoLen=c.readUshort(),3>this.version?(c.readByte(),b.lfoDelay=c.readUbyte(),b.lfoSpeed=c.readUbyte(),b.egControl=c.readUbyte(),b.egTable=c.readUbyte()<<6,c.readByte(),b.egLen=c.readUshort(),c.readByte(),b.egDelay=c.readUbyte(),b.egSpeed=c.readUbyte(),b.fxSpeed=1,b.modSpeed=
1,b.volume=c.readUbyte(),c.position+=6):(b.lfoDelay=c.readUbyte(),b.lfoSpeed=c.readUbyte(),b.egControl=c.readUbyte(),b.egTable=c.readUbyte()<<6,b.egLen=c.readUshort(),b.egDelay=c.readUbyte(),b.egSpeed=c.readUbyte(),b.fxControl=c.readUbyte(),b.fxSpeed=c.readUbyte(),b.fxDelay=c.readUbyte(),b.modControl=c.readUbyte(),b.modTable=c.readUbyte()<<6,b.modSpeed=c.readUbyte(),b.modDelay=c.readUbyte(),b.volume=c.readUbyte(),b.modLen=c.readUshort())):(c.position--,b.synth=0,b.name=c.readString(24),b.length=c.readUshort()<<
1,b.length?(b.loop=c.readUshort(),b.repeat=c.readUshort()<<1,b.volume=c.readUshort(),b.loop+b.repeat>=b.length&&(b.repeat=b.length-b.loop)):(b.pointer--,b.repeat=2,c.position+=6)),this.samples[a]=b;b=this.length<<2;this.tracks.length=b;for(a=0;a<b;++a)h=AmigaStep(),Object.defineProperties(h,{soundTranspose:{value:0,writable:!0}}),h=Object.seal(h),h.pattern=c.readUshort(),h.soundTranspose=c.readByte(),h.transpose=c.readByte(),h.pattern>f&&(f=h.pattern),this.tracks[a]=h;b=f<<4;this.patterns.length=
b;for(a=0;a<b;++a)f=AmigaRow(),f.note=c.readByte(),f.sample=c.readUbyte(),f.effect=f.sample&15,f.sample=(f.sample&240)>>4,f.param=c.readByte(),this.patterns[a]=f;this.mixer.store(c,d<<6);for(a=0;16>++a;)b=this.samples[a],!b.synth&&b.length&&(b.pointer=this.mixer.store(c,b.length),b.loopPtr=b.pointer+b.loop)}},process:{value:function(){var c,f,a,b,h,d=this.mixer.memory,g,i=this.voices[0];this.arpeggioCtr=--this.arpeggioCtr&3;for(this.vibratoPos=++this.vibratoPos&7;i;){c=i.channel;i.period+=i.autoSlide;
c.period=i.vibrato?i.period+(e[this.vibratoPos]/i.vibrato>>0):i.period;c.pointer=i.samplePtr;c.length=i.sampleLen;if(i.arpeggio||i.autoArpeggio)b=i.note,this.arpeggioCtr?1==this.arpeggioCtr&&(b+=(i.arpeggio&15)+(i.autoArpeggio&15)):b+=((i.arpeggio&240)>>4)+((i.autoArpeggio&240)>>4),c.period=i.period=l[b+35],i.restart=0;if(i.synth&&(b=this.samples[i.sample],i.adsrControl&&0==--i.adsrCtr&&(i.adsrCtr=b.adsrSpeed,f=128+d[b.adsrTable+i.adsrPtr]>>2,c.volume=f*i.volume>>6,++i.adsrPtr==b.adsrLen&&(i.adsrPtr=
0,1==i.adsrControl&&(i.adsrControl=0))),i.lfoControl&&0==--i.lfoCtr&&(i.lfoCtr=b.lfoSpeed,f=d[b.lfoTable+i.lfoPtr],b.lfoDepth&&(f=f/b.lfoDepth>>0),c.period=i.period+f,++i.lfoPtr==b.lfoLen&&(i.lfoPtr=0,1==i.lfoControl&&(i.lfoControl=0))),!(0>i.synthPtr))){if(i.egControl&&0==--i.egCtr){i.egCtr=b.egSpeed;f=i.egValue;i.egValue=128+d[b.egTable+i.egPtr]>>3;if(i.egValue!=f)if(g=(i.index<<5)+f,a=i.synthPtr+f,i.egValue<f){f-=i.egValue;for(h=a-f;a>h;)d[--a]=this.buffer[--g]}else{f=i.egValue-f;for(h=a+f;a<h;)d[a++]=
~this.buffer[g++]+1}++i.egPtr==b.egLen&&(i.egPtr=0,1==i.egControl&&(i.egControl=0))}switch(i.fxControl){case 1:if(0==--i.fxCtr){i.fxCtr=b.fxSpeed;a=i.synthPtr;h=i.synthPtr+32;for(f=0<a?d[a-1]:0;a<h;)f=f+d[a+1]>>1,d[a++]=f}break;case 2:g=(i.index<<5)+31;h=i.synthPtr+32;f=b.fxSpeed;for(a=i.synthPtr;a<h;++a)this.buffer[g]<d[a]?d[a]-=f:this.buffer[g]>d[a]&&(d[a]+=f),g--;break;case 3:case 5:g=i.index<<5;h=i.synthPtr+32;f=b.fxSpeed;for(a=i.synthPtr;a<h;++a)this.buffer[g]<d[a]?d[a]-=f:this.buffer[g]>d[a]&&
(d[a]+=f),g++;break;case 4:g=i.synthPtr+64;h=i.synthPtr+32;f=b.fxSpeed;for(a=i.synthPtr;a<h;++a)d[g]<d[a]?d[a]-=f:d[g]>d[a]&&(d[a]+=f),g++;break;case 6:if(0==--i.fxCtr){i.fxControl=0;i.fxCtr=1;g=i.synthPtr+64;h=i.synthPtr+32;for(a=i.synthPtr;a<h;++a)d[a]=d[g++]}}i.modControl&&0==--i.modCtr&&(i.modCtr=b.modSpeed,d[i.synthPtr+32]=d[b.modTable+i.modPtr],++i.modPtr==b.modLen&&(i.modPtr=0,1==i.modControl&&(i.modControl=0)))}i=i.next}if(0==--this.tick){this.tick=this.speed;for(i=this.voices[0];i;){c=i.channel;
i.enabled=0;h=this.tracks[(this.trackPos<<2)+i.index];g=this.patterns[this.patternPos+(h.pattern-1<<4)];b=g.note;a=g.effect;f=g.param;if(b){i.autoArpeggio=i.autoSlide=i.vibrato=0;if(10!=a||0==(f&240))b+=h.transpose;i.note=b;i.period=l[b+35];i.restart=13>a?i.volumeDef=1:0;b=g.sample;0==b&&(b=i.sample);if(10!=a||0==(f&15))b+=h.soundTranspose;if(13>a&&(!i.synth||i.sample!=b))i.sample=b,i.enabled=1}switch(a){case 0:i.arpeggio=f;break;case 1:i.volume=f;i.volumeDef=0;if(3>this.version||!i.synth)c.volume=
i.volume;break;case 2:this.tick=this.speed=f;break;case 3:this.mixer.filter.active=f;break;case 4:i.period-=f;i.arpeggio=0;break;case 5:i.period+=f;i.arpeggio=0;break;case 6:3==this.version?i.vibrato=f:repeatCtr=f;break;case 7:3==this.version?(this.nextPos=f,this.jumpFlag=1):0==this.repeatCtr&&(this.trackPos=f);break;case 8:i.autoSlide=f;break;case 9:i.autoArpeggio=f;3==this.version&&(i.adsrPtr=0,0==i.adsrControl&&(i.adsrControl=1));break;case 11:i.fxControl=f;break;case 13:i.autoArpeggio=f;i.fxControl^=
1;i.adsrPtr=0;0==i.adsrControl&&(i.adsrControl=1);break;case 14:i.autoArpeggio=f;i.adsrPtr=0;0==i.adsrControl&&(i.adsrControl=1);break;case 15:i.autoArpeggio=f}i=i.next}this.jumpFlag?(this.trackPos=this.nextPos,this.patternPos=this.jumpFlag=0):16==++this.patternPos&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1));for(i=this.voices[0];i;){c=i.channel;i.enabled&&(c.enabled=i.enabled=0);if(0!=i.restart&&-1<i.synthPtr){g=i.index<<5;h=i.synthPtr+32;for(a=i.synthPtr;a<
h;++a)d[a]=this.buffer[g++];i.synthPtr=-1}i=i.next}for(i=this.voices[0];i;){if(0!=i.restart){c=i.channel;c.period=i.period;i.restart=0;b=this.samples[i.sample];if(b.synth){if(i.synth=1,i.egValue=0,i.adsrPtr=i.lfoPtr=i.egPtr=i.modPtr=0,i.adsrCtr=1,i.lfoCtr=b.lfoDelay+1,i.egCtr=b.egDelay+1,i.fxCtr=b.fxDelay+1,i.modCtr=b.modDelay+1,i.adsrControl=b.adsrControl,i.lfoControl=b.lfoControl,i.egControl=b.egControl,i.fxControl=b.fxControl,i.modControl=b.modControl,c.pointer=i.samplePtr=b.pointer,c.length=i.sampleLen=
b.length,i.adsrControl?(f=128+d[b.adsrTable]>>2,i.volumeDef&&(i.volume=b.volume,i.volumeDef=0),c.volume=f*i.volume>>6):c.volume=i.volumeDef?b.volume:i.volume,i.egControl||i.fxControl||i.modControl){i.synthPtr=b.pointer;a=i.index<<5;h=i.synthPtr+32;for(g=i.synthPtr;g<h;++g)this.buffer[a++]=d[g]}}else i.synth=i.lfoControl=0,0>b.pointer?(i.samplePtr=this.mixer.loopPtr,i.sampleLen=2):(c.pointer=b.pointer,c.volume=i.volumeDef?b.volume:i.volume,2!=b.repeat?(i.samplePtr=b.loopPtr,c.length=i.sampleLen=b.repeat):
(i.samplePtr=this.mixer.loopPtr,i.sampleLen=2,c.length=b.length));c.enabled=i.enabled=1}i=i.next}}}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);j.buffer=new Int8Array(128);return Object.seal(j)}})();
(function(){function n(j){return Object.create(null,{index:{value:j,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},status:{value:0,writable:!0},speed:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},tableCtr:{value:0,writable:!0},
tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},volume:{value:0,writable:!0},attackCtr:{value:0,writable:!0},decayCtr:{value:0,writable:!0},releaseCtr:{value:0,writable:!0},sustain:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.status=this.patternPos=this.trackPos=0;this.speed=1;this.row=this.step=null;this.releaseCtr=this.decayCtr=this.attackCtr=this.volume=
this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.pitchBend=this.arpeggioPos=this.period=this.note=0;this.sustain=1}}})}function l(){var j=AmigaSample();Object.defineProperties(j,{synth:{value:0,writable:!0},attackStep:{value:0,writable:!0},attackDelay:{value:0,writable:!0},decayStep:{value:0,writable:!0},decayDelay:{value:0,writable:!0},releaseStep:{value:0,writable:!0},releaseDelay:{value:0,writable:!0},sustain:{value:0,writable:!0},arpeggio:{value:null,
writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},table:{value:null,writable:!0},tableDelay:{value:0,writable:!0},vibratoWait:{value:0,writable:!0},vibratoStep:{value:0,writable:!0},vibratoLen:{value:0,writable:!0}});j.arpeggio=new Int8Array(8);j.table=new Int8Array(48);return Object.seal(j)}var e=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,960,904,
856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D1Player=function(j){j=AmigaPlayer(j);Object.defineProperties(j,{id:{value:"D1Player"},pointers:{value:null,writable:!0},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var c=this.voices[0];
this.reset();for(this.speed=6;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[20],c=c.next}},loader:{value:function(c){var f,a=0,b,h=0,d,g,i;if("ALL "==c.readString(4)){for(f=new Uint32Array(25);25>a;++a)f[a]=c.readUint();this.pointers=new Uint32Array(4);for(a=1;4>a;++a)this.pointers[a]=this.pointers[h]+(f[h++]>>1)-1;d=this.pointers[3]+(f[3]>>1)-1;this.tracks.length=d;b=104+f[1]-2;c.position=104;h=1;for(a=0;a<d;++a)g=AmigaStep(),i=c.readUshort(),65535==i||c.position==
b?(g.pattern=-1,g.transpose=c.readUshort(),b+=f[h++]):(c.position--,g.pattern=(i>>2&16320)>>2,g.transpose=c.readByte()),this.tracks[a]=g;d=f[4]>>2;this.patterns.length=d;for(a=0;a<d;++a)b=AmigaRow(),b.sample=c.readUbyte(),b.note=c.readUbyte(),b.effect=c.readUbyte()&31,b.param=c.readUbyte(),this.patterns[a]=b;b=5;for(a=0;20>a;++a){this.samples[a]=null;if(0!=f[b]){g=l();g.attackStep=c.readUbyte();g.attackDelay=c.readUbyte();g.decayStep=c.readUbyte();g.decayDelay=c.readUbyte();g.sustain=c.readUshort();
g.releaseStep=c.readUbyte();g.releaseDelay=c.readUbyte();g.volume=c.readUbyte();g.vibratoWait=c.readUbyte();g.vibratoStep=c.readUbyte();g.vibratoLen=c.readUbyte();g.pitchBend=c.readByte();g.portamento=c.readUbyte();g.synth=c.readUbyte();g.tableDelay=c.readUbyte();for(h=0;8>h;++h)g.arpeggio[h]=c.readByte();g.length=c.readUshort();g.loop=c.readUshort();g.repeat=c.readUshort()<<1;g.synth=g.synth?0:1;if(g.synth){for(h=0;48>h;++h)g.table[h]=c.readByte();d=f[b]-78}else d=g.length;g.pointer=this.mixer.store(c,
d);g.loopPtr=g.pointer+g.loop;this.samples[a]=g}b++}g=l();g.pointer=g.loopPtr=this.mixer.memory.length;g.length=g.repeat=2;this.samples[20]=g;this.version=1}}},process:{value:function(){for(var c,f,a,b,h=this.voices[0];h;){f=h.channel;0==--h.speed&&(h.speed=this.speed,0==h.patternPos&&(h.step=this.tracks[this.pointers[h.index]+h.trackPos],0>h.step.pattern&&(h.trackPos=h.step.transpose,h.step=this.tracks[this.pointers[h.index]+h.trackPos]),h.trackPos++),a=this.patterns[h.step.pattern+h.patternPos],
a.effect&&(h.row=a),a.note&&(f.enabled=0,h.row=a,h.note=a.note+h.step.transpose,h.arpeggioPos=h.pitchBend=h.status=0,b=h.sample=this.samples[a.sample],b.synth||(f.pointer=b.pointer),f.length=b.length,h.tableCtr=h.tablePos=0,h.vibratoCtr=b.vibratoWait,h.vibratoPos=b.vibratoLen,h.vibratoDir=b.vibratoLen<<1,h.volume=h.attackCtr=h.decayCtr=h.releaseCtr=0,h.sustain=b.sustain),16==++h.patternPos&&(h.patternPos=0));b=h.sample;if(b.synth)if(0==h.tableCtr){h.tableCtr=b.tableDelay;do c=1,48<=h.tablePos&&(h.tablePos=
0),a=b.table[h.tablePos],h.tablePos++,0<=a?(f.pointer=b.pointer+(a<<5),c=0):-1!=a?b.tableDelay=a&127:h.tablePos=b.table[h.tablePos];while(c)}else h.tableCtr--;b.portamento&&(a=e[h.note]+h.pitchBend,0!=h.period?h.period<a?(h.period+=b.portamento,h.period>a&&(h.period=a)):(h.period-=b.portamento,h.period<a&&(h.period=a)):h.period=a);0==h.vibratoCtr?(h.vibratoPeriod=h.vibratoPos*b.vibratoStep,0==(h.status&1)?(h.vibratoPos++,h.vibratoPos==h.vibratoDir&&(h.status^=1)):(h.vibratoPos--,0==h.vibratoPos&&
(h.status^=1))):h.vibratoCtr--;h.pitchBend=0>b.pitchBend?h.pitchBend+b.pitchBend:h.pitchBend-b.pitchBend;if(h.row)switch(a=h.row,a.effect){case 1:if(a=a.param&15)this.speed=a;break;case 2:h.pitchBend-=a.param;break;case 3:h.pitchBend+=a.param;break;case 4:this.mixer.filter.active=a.param;break;case 5:b.vibratoWait=a.param;break;case 6:b.vibratoStep=a.param;case 7:b.vibratoLen=a.param;break;case 8:b.pitchBend=a.param;break;case 9:b.portamento=a.param;break;case 10:b.volume=64;break;case 11:b.arpeggio[0]=
a.param;break;case 12:b.arpeggio[1]=a.param;break;case 13:b.arpeggio[2]=a.param;break;case 14:b.arpeggio[3]=a.param;break;case 15:b.arpeggio[4]=a.param;break;case 16:b.arpeggio[5]=a.param;break;case 17:b.arpeggio[6]=a.param;break;case 18:b.arpeggio[7]=a.param;break;case 19:b.arpeggio[0]=b.arpeggio[4]=a.param;break;case 20:b.arpeggio[1]=b.arpeggio[5]=a.param;break;case 21:b.arpeggio[2]=b.arpeggio[6]=a.param;break;case 22:b.arpeggio[3]=b.arpeggio[7]=a.param;break;case 23:a=a.param;64<a&&(a=64);b.attackStep=
a;break;case 24:b.attackDelay=a.param;break;case 25:a=a.param;64<a&&(a=64);b.decayStep=a;break;case 26:b.decayDelay=a.param;break;case 27:b.sustain=a.param&b.sustain&255;break;case 28:b.sustain=(b.sustain&65280)+a.param;break;case 29:a=a.param;64<a&&(a=64);b.releaseStep=a;break;case 30:b.releaseDelay=a.param}b.portamento?a=h.period:(a=e[h.note+b.arpeggio[h.arpeggioPos]],h.arpeggioPos=++h.arpeggioPos&7,a-=b.vibratoLen*b.vibratoStep,a+=h.pitchBend,h.period=0);f.period=a+h.vibratoPeriod;c=h.status&14;
a=h.volume;0==c&&(0==h.attackCtr?(h.attackCtr=b.attackDelay,a+=b.attackStep,64<=a&&(c|=2,h.status|=2,a=64)):h.attackCtr--);2==c&&(0==h.decayCtr?(h.decayCtr=b.decayDelay,a-=b.decayStep,a<=b.volume&&(c|=6,h.status|=6,a=b.volume)):h.decayCtr--);6==c&&(0==h.sustain?(c|=14,h.sustain|=14):h.sustain--);14==c&&(0==h.releaseCtr?(h.releaseCtr=b.releaseDelay,a-=b.releaseStep,0>a&&(h.status&=9,a=0)):h.releaseCtr--);f.volume=h.volume=a;f.enabled=1;b.synth||(b.loop?(f.pointer=b.loopPtr,f.length=b.repeat):(f.pointer=
this.mixer.loopPtr,f.length=2));h=h.next}}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);return Object.seal(j)}})();
(function(){function n(j){return Object.create(null,{index:{value:j,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},restart:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioPtr:{value:0,
writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},tableCtr:{value:0,writable:!0},tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},vibratoSustain:{value:0,writable:!0},volume:{value:0,writable:!0},volumeMax:{value:0,writable:!0},volumePos:{value:0,writable:!0},volumeSustain:{value:0,writable:!0},initialize:{value:function(){this.sample=
null;this.restart=this.patternPos=this.trackLen=this.trackPos=this.trackPtr=0;this.row=this.step=null;this.volume=this.vibratoSustain=this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.portamento=this.pitchBend=this.arpeggioPos=this.arpeggioPtr=this.finalPeriod=this.period=this.note=0;this.volumeMax=63;this.volumeSustain=this.volumePos=0}}})}function l(){var j=AmigaSample();Object.defineProperties(j,{index:{value:0,writable:!0},pitchBend:{value:0,writable:!0},
synth:{value:0,writable:!0},table:{value:null,writable:!0},vibratos:{value:null,writable:!0},volumes:{value:null,writable:!0}});j.table=new Uint8Array(48);j.vibratos=new Uint8Array(15);j.volumes=new Uint8Array(15);return Object.seal(j)}var e=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,
269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D2Player=function(j){j=AmigaPlayer(j);Object.defineProperties(j,{id:{value:"D2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},data:{value:null,writable:!0},arpeggios:{value:null,writable:!0},voices:{value:[],writable:!0},noise:{value:0,writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();this.speed=
5;this.tick=1;for(this.noise=0;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[this.samples.length-1],c.trackPtr=this.data[c.index],c.restart=this.data[c.index+4],c.trackLen=this.data[c.index+8],c=c.next}},loader:{value:function(c){var f=0,a,b=0,h,d,g;c.position=3014;if(".FNL"==c.readString(4)){c.position=4042;for(this.data=new Uint16Array(12);4>f;++f)this.data[f+4]=c.readUshort(),g=c.readUshort()>>1,this.data[f+8]=g,b+=g;g=b;for(f=3;0<f;--f)this.data[f]=g-=this.data[f+
8];this.tracks.length=b;for(f=0;f<b;++f)a=AmigaStep(),a.pattern=c.readUbyte()<<4,a.transpose=c.readByte(),this.tracks[f]=a;b=c.readUint()>>2;this.patterns.length=b;for(f=0;f<b;++f)a=AmigaRow(),a.note=c.readUbyte(),a.sample=c.readUbyte(),a.effect=c.readUbyte()-1,a.param=c.readUbyte(),this.patterns[f]=a;c.position+=254;g=c.readUshort();d=c.position;c.position-=256;b=1;h=new Uint16Array(128);for(f=0;128>f;++f)a=c.readUshort(),a!=g&&(h[b++]=a);this.samples.length=b;for(f=0;f<b;++f){c.position=d+h[f];
g=l();g.length=c.readUshort()<<1;g.loop=c.readUshort();g.repeat=c.readUshort()<<1;for(a=0;15>a;++a)g.volumes[a]=c.readUbyte();for(a=0;15>a;++a)g.vibratos[a]=c.readUbyte();g.pitchBend=c.readUshort();g.synth=c.readByte();g.index=c.readUbyte();for(a=0;48>a;++a)g.table[a]=c.readUbyte();this.samples[f]=g}b=c.readUint();this.mixer.store(c,b);c.position+=64;for(f=0;8>f;++f)h[f]=c.readUint();b=this.samples.length;d=c.position;for(f=0;f<b;++f)g=this.samples[f],0<=g.synth||(c.position=d+h[g.index],g.pointer=
this.mixer.store(c,g.length),g.loopPtr=g.pointer+g.loop);c.position=3018;for(f=0;1024>f;++f)this.arpeggios[f]=c.readByte();g=l();g.pointer=g.loopPtr=this.mixer.memory.length;g.length=g.repeat=2;this.samples[b]=g;this.version=2}}},process:{value:function(){var c;c=0;for(var f,a,b,h=this.voices[0];64>c;)this.noise=this.noise<<7|this.noise>>>25,this.noise+=1858762093,this.noise^=2656676139,a=this.noise>>>24&255,127<a&&(a|=-256),this.mixer.memory[c++]=a,a=this.noise>>>16&255,127<a&&(a|=-256),this.mixer.memory[c++]=
a,a=this.noise>>>8&255,127<a&&(a|=-256),this.mixer.memory[c++]=a,a=this.noise&255,127<a&&(a|=-256),this.mixer.memory[c++]=a;0>--this.tick&&(this.tick=this.speed);for(;h;){if(!(1>h.trackLen)){c=h.channel;b=h.sample;b.synth&&(c.pointer=b.loopPtr,c.length=b.repeat);if(0==this.tick){0==h.patternPos&&(h.step=this.tracks[h.trackPtr+h.trackPos],++h.trackPos==h.trackLen&&(h.trackPos=h.restart));a=h.row=this.patterns[h.step.pattern+h.patternPos];a.note&&(c.enabled=0,h.note=a.note,h.period=e[a.note+h.step.transpose],
b=h.sample=this.samples[a.sample],0>b.synth&&(c.pointer=b.pointer,c.length=b.length),h.arpeggioPos=0,h.tableCtr=0,h.tablePos=0,h.vibratoCtr=b.vibratos[1],h.vibratoPos=0,h.vibratoDir=0,h.vibratoPeriod=0,h.vibratoSustain=b.vibratos[2],h.volume=0,h.volumePos=0,h.volumeSustain=0);switch(a.effect){case 0:this.speed=a.param&15;break;case 1:this.mixer.filter.active=a.param;break;case 2:h.pitchBend=~(a.param&255)+1;break;case 3:h.pitchBend=a.param&255;break;case 4:h.portamento=a.param;break;case 5:h.volumeMax=
a.param&63;break;case 6:this.mixer.volume=a.param;break;case 7:h.arpeggioPtr=(a.param&63)<<4}h.patternPos=++h.patternPos&15}b=h.sample;0<=b.synth&&(h.tableCtr?h.tableCtr--:(h.tableCtr=b.index,a=b.table[h.tablePos],255==a&&(a=b.table[++h.tablePos],255!=a&&(h.tablePos=a,a=b.table[h.tablePos])),255!=a&&(c.pointer=a<<8,c.length=b.length,47<++h.tablePos&&(h.tablePos=0))));a=b.vibratos[h.vibratoPos];h.vibratoPeriod=h.vibratoDir?h.vibratoPeriod-a:h.vibratoPeriod+a;0==--h.vibratoCtr&&(h.vibratoCtr=b.vibratos[h.vibratoPos+
1],h.vibratoDir=~h.vibratoDir);h.vibratoSustain?h.vibratoSustain--:(h.vibratoPos+=3,15==h.vibratoPos&&(h.vibratoPos=12),h.vibratoSustain=b.vibratos[h.vibratoPos+2]);h.volumeSustain?h.volumeSustain--:(a=b.volumes[h.volumePos],f=b.volumes[h.volumePos+1],f<h.volume?(h.volume-=a,h.volume<f&&(h.volume=f,h.volumePos+=3,h.volumeSustain=b.volumes[h.volumePos-1])):(h.volume+=a,h.volume>f&&(h.volume=f,h.volumePos+=3,15==h.volumePos&&(h.volumePos=12),h.volumeSustain=b.volumes[h.volumePos-1])));h.portamento&&
(h.period<h.finalPeriod?(h.finalPeriod-=h.portamento,h.finalPeriod<h.period&&(h.finalPeriod=h.period)):(h.finalPeriod+=h.portamento,h.finalPeriod>h.period&&(h.finalPeriod=h.period)));a=this.arpeggios[h.arpeggioPtr+h.arpeggioPos];-128==a&&(h.arpeggioPos=0,a=this.arpeggios[h.arpeggioPtr]);h.arpeggioPos=++h.arpeggioPos&15;0==h.portamento&&(a=h.note+h.step.transpose+a,0>a&&(a=0),h.finalPeriod=e[a]);h.vibratoPeriod-=b.pitchBend-h.pitchBend;c.period=h.finalPeriod+h.vibratoPeriod;a=h.volume>>2&63;a>h.volumeMax&&
(a=h.volumeMax);c.volume=a;c.enabled=1}h=h.next}}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);j.arpeggios=new Int8Array(1024);return Object.seal(j)}})();
(function(){function n(){return Object.create(null,{channel:{value:null,writable:!0},sample:{value:null,writable:!0},step:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},val1:{value:0,writable:!0},val2:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioStep:{value:0,writable:!0},effectCtr:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchStep:{value:0,writable:!0},portamento:{value:0,writable:!0},volume:{value:0,writable:!0},
volumeCtr:{value:0,writable:!0},volumeStep:{value:0,writable:!0},mixMute:{value:0,writable:!0},mixPtr:{value:0,writable:!0},mixEnd:{value:0,writable:!0},mixSpeed:{value:0,writable:!0},mixStep:{value:0,writable:!0},mixVolume:{value:0,writable:!0},initialize:{value:function(){this.step=this.sample=null;this.volumeStep=this.volumeCtr=this.volume=this.portamento=this.pitchStep=this.pitchCtr=this.pitch=this.effectCtr=this.arpeggioStep=this.finalPeriod=this.val2=this.val1=this.period=this.note=0;this.mixMute=
1;this.mixVolume=this.mixStep=this.mixSpeed=this.mixEnd=this.mixPtr=0}}})}var l=[3220,3040,2869,2708,2556,2412,2277,2149,2029,1915,1807,1706,1610,1520,1434,1354,1278,1206,1139,1075,1014,957,904,853,805,760,717,677,639,603,569,537,507,479,452,426,403,380,359,338,319,302,285,269,254,239,226,213,201,190,179,169,160,151,142,134,127,4842,4571,4314,4072,3843,3628,3424,3232,3051,2879,2718,2565,2421,2285,2157,2036,1922,1814,1712,1616,1525,1440,1359,1283,1211,1143,1079,1018,961,907,856,808,763,720,679,641,
605,571,539,509,480,453,428,404,381,360,340,321,303,286,270,254,240,227,214,202,191,180,170,160,151,143,135,127,4860,4587,4330,4087,3857,3641,3437,3244,3062,2890,2728,2574,2430,2294,2165,2043,1929,1820,1718,1622,1531,1445,1364,1287,1215,1147,1082,1022,964,910,859,811,765,722,682,644,607,573,541,511,482,455,430,405,383,361,341,322,304,287,271,255,241,228,215,203,191,181,170,161,152,143,135,128,4878,4604,4345,4102,3871,3654,3449,3255,3073,2900,2737,2584,2439,2302,2173,2051,1936,1827,1724,1628,1536,
1450,1369,1292,1219,1151,1086,1025,968,914,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,4895,4620,4361,4116,3885,3667,3461,3267,3084,2911,2747,2593,2448,2310,2181,2058,1943,1834,1731,1634,1542,1455,1374,1297,1224,1155,1090,1029,971,917,865,817,771,728,687,648,612,578,545,515,486,458,433,408,385,364,343,324,306,289,273,257,243,229,216,204,193,182,172,162,153,144,136,129,4913,4637,4377,4131,3899,3681,3474,3279,
3095,2921,2757,2603,2456,2319,2188,2066,1950,1840,1737,1639,1547,1461,1379,1301,1228,1159,1094,1033,975,920,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,4931,4654,4393,4146,3913,3694,3486,3291,3106,2932,2767,2612,2465,2327,2196,2073,1957,1847,1743,1645,1553,1466,1384,1306,1233,1163,1098,1037,978,923,872,823,777,733,692,653,616,582,549,518,489,462,436,411,388,366,346,326,308,291,275,259,245,231,218,206,194,183,
173,163,154,145,137,130,4948,4671,4409,4161,3928,3707,3499,3303,3117,2942,2777,2621,2474,2335,2204,2081,1964,1854,1750,1651,1559,1471,1389,1311,1237,1168,1102,1040,982,927,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,4966,4688,4425,4176,3942,3721,3512,3315,3129,2953,2787,2631,2483,2344,2212,2088,1971,1860,1756,1657,1564,1477,1394,1315,1242,1172,1106,1044,985,930,878,829,782,738,697,658,621,586,553,522,493,465,
439,414,391,369,348,329,310,293,277,261,246,233,219,207,196,185,174,164,155,146,138,131,4984,4705,4441,4191,3956,3734,3524,3327,3140,2964,2797,2640,2492,2352,2220,2096,1978,1867,1762,1663,1570,1482,1399,1320,1246,1176,1110,1048,989,934,881,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,5002,4722,4457,4206,3970,3748,3537,3339,3151,2974,2807,2650,2501,2361,2228,2103,1985,1874,1769,1669,1576,1487,1404,1325,1251,1180,
1114,1052,993,937,884,835,788,744,702,662,625,590,557,526,496,468,442,417,394,372,351,331,313,295,279,263,248,234,221,209,197,186,175,166,156,148,139,131,5020,4739,4473,4222,3985,3761,3550,3351,3163,2985,2818,2659,2510,2369,2236,2111,1992,1881,1775,1675,1581,1493,1409,1330,1255,1185,1118,1055,996,940,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,5039,4756,4489,4237,3999,3775,3563,3363,3174,2996,2828,2669,2519,
2378,2244,2118,2E3,1887,1781,1681,1587,1498,1414,1335,1260,1189,1122,1059,1E3,944,891,841,794,749,707,667,630,594,561,530,500,472,445,420,397,374,353,334,315,297,281,265,250,236,223,210,198,187,177,167,157,149,140,132,5057,4773,4505,4252,4014,3788,3576,3375,3186,3007,2838,2679,2528,2387,2253,2126,2007,1894,1788,1688,1593,1503,1419,1339,1264,1193,1126,1063,1003,947,894,844,796,752,710,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,
5075,4790,4521,4268,4028,3802,3589,3387,3197,3018,2848,2688,2538,2395,2261,2134,2014,1901,1794,1694,1599,1509,1424,1344,1269,1198,1130,1067,1007,951,897,847,799,754,712,672,634,599,565,533,504,475,449,423,400,377,356,336,317,299,283,267,252,238,224,212,200,189,178,168,159,150,141,133,5093,4808,4538,4283,4043,3816,3602,3399,3209,3029,2859,2698,2547,2404,2269,2142,2021,1908,1801,1700,1604,1514,1429,1349,1273,1202,1134,1071,1011,954,900,850,802,757,715,675,637,601,567,535,505,477,450,425,401,379,357,
337,318,300,284,268,253,238,225,212,201,189,179,169,159,150,142,134];window.neoart.DMPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"DMPlayer"},songs:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},buffer1:{value:0,writable:!0},buffer2:{value:0,writable:!0},song1:{value:0,writable:!0},song2:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},
patternEnd:{value:0,writable:!0},stepEnd:{value:0,writable:!0},numChannels:{value:0,writable:!0},arpeggios:{value:null,writable:!0},averages:{value:null,writable:!0},volumes:{value:null,writable:!0},mixChannel:{value:null,writable:!0},mixPeriod:{value:0,writable:!0},initialize:{value:function(){var j,c=0,f;this.reset();7<this.playSong&&(this.playSong=0);this.song1=this.songs[this.playSong];this.speed=this.song1.speed&15;this.speed|=this.speed<<4;this.tick=this.song1.speed;this.patternPos=this.trackPos=
0;this.patternLen=64;this.stepEnd=this.patternEnd=1;for(this.numChannels=4;7>c;++c)f=this.voices[c],f.initialize(),f.sample=this.samples[0],4>c&&(j=this.mixer.channels[c],j.enabled=0,j.pointer=this.mixer.loopPtr,j.length=2,j.period=124,j.volume=0,f.channel=j);if(2==this.version){0!=(this.playSong&1)&&this.playSong--;this.song2=this.songs[this.playSong+1];this.mixChannel=AmigaChannel(7);this.numChannels=7;j=this.mixer.channels[3];j.mute=0;j.pointer=this.buffer1;j.length=350;j.period=this.mixPeriod;
j.volume=64;j=this.buffer1+700;for(c=this.buffer1;c<j;++c)this.mixer.memory[c]=0}}},loader:{value:function(j){var c,f=0,a,b,h,d;a=j.readString(24);if(" MUGICIAN/SOFTEYES 1990 "==a)this.version=1;else if(" MUGICIAN2/SOFTEYES 1990"==a)this.version=2;else return;j.position=28;for(b=new Uint32Array(8);8>f;++f)b[f]=j.readUint();j.position=76;for(f=0;8>f;++f)h=Object.create(null,{title:{value:"",writable:!0},speed:{value:0,writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},loopStep:{value:0,
writable:!0},tracks:{value:[],writable:!0}}),h.loop=j.readUbyte(),h.loopStep=j.readUbyte()<<2,h.speed=j.readUbyte(),h.length=j.readUbyte()<<2,h.title=j.readString(12),this.songs[f]=h;j.position=204;this.lastSong=this.songs.length-1;for(f=0;8>f;++f){h=this.songs[f];a=b[f]<<2;for(c=0;c<a;++c)d=AmigaStep(),d.pattern=j.readUbyte()<<6,d.transpose=j.readByte(),h.tracks[c]=d}h=j.position;j.position=60;a=j.readUint();this.samples.length=++a;j.position=h;for(f=1;f<a;++f)b=AmigaSample(),Object.defineProperties(b,
{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},finetune:{value:0,writable:!0},arpeggio:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchDelay:{value:0,writable:!0},pitchLoop:{value:0,writable:!0},pitchSpeed:{value:0,writable:!0},effect:{value:0,writable:!0},effectDone:{value:0,writable:!0},effectStep:{value:0,writable:!0},effectSpeed:{value:0,writable:!0},source1:{value:0,writable:!0},source2:{value:0,writable:!0},volumeLoop:{value:0,writable:!0},volumeSpeed:{value:0,writable:!0}}),
d=Object.seal(b),d.wave=j.readUbyte(),d.waveLen=j.readUbyte()<<1,d.volume=j.readUbyte(),d.volumeSpeed=j.readUbyte(),d.arpeggio=j.readUbyte(),d.pitch=j.readUbyte(),d.effectStep=j.readUbyte(),d.pitchDelay=j.readUbyte(),d.finetune=j.readUbyte()<<6,d.pitchLoop=j.readUbyte(),d.pitchSpeed=j.readUbyte(),d.effect=j.readUbyte(),d.source1=j.readUbyte(),d.source2=j.readUbyte(),d.effectSpeed=j.readUbyte(),d.volumeLoop=j.readUbyte(),this.samples[f]=d;this.samples[0]=this.samples[1];h=j.position;j.position=64;
a=j.readUint()<<7;j.position=h;this.mixer.store(j,a);h=j.position;j.position=68;b=j.readUint();j.position=26;a=j.readUshort()<<6;this.patterns.length=a;j.position=h+(b<<5);b&&(b=h);for(f=0;f<a;++f)c=AmigaRow(),c.note=j.readUbyte(),c.sample=j.readUbyte()&63,c.effect=j.readUbyte(),c.param=j.readByte(),this.patterns[f]=c;h=j.position;j.position=72;if(b){a=j.readUint();j.position=h;c=this.mixer.store(j,a);h=j.position;this.mixer.memory.length+=350;this.buffer1=this.mixer.memory.length;this.mixer.memory.length+=
350;this.buffer2=this.mixer.memory.length;this.mixer.memory.length+=350;this.mixer.loopLen=8;a=this.samples.length;for(f=1;f<a;++f)d=this.samples[f],32>d.wave||(j.position=b+(d.wave-32<<5),d.pointer=j.readUint(),d.length=j.readUint()-d.pointer,d.loop=j.readUint(),d.name=j.readString(12),d.loop?(d.loop-=d.pointer,d.repeat=d.length-d.loop):(d.loopPtr=this.mixer.memory.length,d.repeat=8),0!=(d.pointer&1)&&d.pointer--,0!=(d.length&1)&&d.length--,d.pointer+=c,d.loop&&(d.loopPtr=d.pointer+d.loop),this.mixer.memory[d.pointer]=
0,this.mixer.memory[d.pointer+1]=0)}else h+=j.readUint();j.position=24;if(1==j.readUshort()){j.position=h;a=j.length-j.position;256<a&&(a=256);for(f=0;f<a;++f)this.arpeggios[f]=j.readUbyte()}}},process:{value:function(){for(var j,c,f=0,a,b,h,d=this.mixer.memory,g,i,e,m,p,o;f<this.numChannels;++f){o=this.voices[f];m=o.sample;3>f||4==this.numChannels?(j=o.channel,this.stepEnd&&(o.step=this.song1.tracks[this.trackPos+f]),31<m.wave&&(j.pointer=m.loopPtr,j.length=m.repeat)):(j=this.mixChannel,this.stepEnd&&
(o.step=this.song2.tracks[this.trackPos+(f-3)]));if(this.patternEnd&&(c=this.patterns[o.step.pattern+this.patternPos],c.note)){74!=c.effect&&(o.note=c.note,c.sample&&(m=o.sample=this.samples[c.sample]));o.val1=64>c.effect?1:c.effect-62;o.val2=c.param;a=o.step.transpose+m.finetune;12!=o.val1?(o.pitch=c.effect,1==o.val1&&(a+=o.pitch,o.period=0>a?0:l[a])):(o.pitch=c.note,a+=o.pitch,o.period=0>a?0:l[a]);11==o.val1&&(m.arpeggio=o.val2&7);if(12!=o.val1)if(31<m.wave)j.pointer=m.pointer,j.length=m.length,
j.enabled=0,o.mixPtr=m.pointer,o.mixEnd=m.pointer+m.length,o.mixMute=0;else if(c=m.wave<<7,j.pointer=c,j.length=m.waveLen,10!=o.val1&&(j.enabled=0),4==this.numChannels&&0!=m.effect&&2!=o.val1&&4!=o.val1){h=c+128;i=m.source1<<7;for(b=c;b<h;++b)d[b]=d[i++];m.effectStep=0;o.effectCtr=m.effectSpeed}3!=o.val1&&4!=o.val1&&12!=o.val1&&(o.volumeCtr=1,o.volumeStep=0);o.arpeggioStep=0;o.pitchCtr=m.pitchDelay;o.pitchStep=0;o.portamento=0}switch(o.val1){case 5:p=o.val2;0<p&&65>p&&(this.patternLen=p);break;case 6:p=
o.val2&15;p|=p<<4;if(0==o.val2||15<o.val2)break;this.speed=p;break;case 7:this.mixer.filter.active=1;break;case 8:this.mixer.filter.active=0;break;case 13:o.val1=0;p=o.val2&15;if(0==p)break;p=o.val2&240;if(0==p)break;this.speed=o.val2}}for(f=0;f<this.numChannels;++f){o=this.voices[f];m=o.sample;if(4==this.numChannels){if(j=o.channel,32>m.wave&&m.effect&&!m.effectDone)if(m.effectDone=1,o.effectCtr)o.effectCtr--;else switch(o.effectCtr=m.effectSpeed,c=m.wave<<7,m.effect){case 1:for(b=0;127>b;++b)p=
d[c],p+=d[c+1],d[c++]=p>>1;break;case 2:i=m.source1<<7;e=m.source2<<7;a=m.effectStep;h=m.waveLen;m.effectStep=++m.effectStep&127;for(b=0;b<h;++b)p=d[i++],p+=d[e+a],d[c++]=p>>1,a=++a&127;break;case 3:p=d[c];for(b=0;127>b;++b)d[c]=d[++c];d[c]=p;break;case 4:c+=127;p=d[c];for(b=0;127>b;++b)d[c]=d[--c];d[c]=p;break;case 5:a=p=c;for(b=0;64>b;++b)d[a++]=d[c++],c++;a=c=p;a+=64;for(b=0;64>b;++b)d[a++]=d[c++];break;case 6:i=c+64;c+=128;for(b=0;64>b;++b)d[--c]=d[--i],d[--c]=d[i];break;case 7:c+=m.effectStep;
d[c]=~d[c]+1;++m.effectStep>=m.waveLen&&(m.effectStep=0);break;case 8:m.effectStep=++m.effectStep&127;e=(m.source2<<7)+m.effectStep;a=d[e];h=m.waveLen;p=3;for(b=0;b<h;++b)i=d[c]+p,-128>i?i+=256:127<i&&(i-=256),d[c++]=i,p+=a,-128>p?p+=256:127<p&&(p-=256);break;case 9:e=m.source2<<7;h=m.waveLen;for(b=0;b<h;++b)p=d[e++],p+=d[c],127<p&&(p-=256),d[c++]=p;break;case 10:for(b=0;126>b;++b)p=3*d[c++],p+=d[c+1],d[c]=p>>2;break;case 11:i=m.source1<<7;e=m.source2<<7;h=m.waveLen;m.effectStep=++m.effectStep&127;
p=m.effectStep;64<=p&&(p=127-p);a=(p^255)&63;for(b=0;b<h;++b)g=d[i++]*p,g+=d[e++]*a,d[c++]=g>>6;break;case 12:i=m.source1<<7;e=m.source2<<7;h=m.waveLen;m.effectStep=++m.effectStep&31;p=m.effectStep;16<=p&&(p=31-p);a=(p^255)&15;for(b=0;b<h;++b)g=d[i++]*p,g+=d[e++]*a,d[c++]=g>>4;break;case 13:for(b=0;126>b;++b)p=d[c++],p+=d[c+1],d[c]=p>>1;break;case 14:a=c+m.effectStep;d[a]=~d[a]+1;a=m.effectStep+m.source2&m.waveLen-1;a+=c;d[a]=~d[a]+1;++m.effectStep>=m.waveLen&&(m.effectStep=0);break;case 15:a=c;for(b=
0;127>b;++b)p=d[c],p+=d[c+1],d[c++]=p>>1;c=a;m.effectStep++;if(m.effectStep==m.source2){m.effectStep=0;a=p=c;for(b=0;64>b;++b)d[a++]=d[c++],c++;a=c=p;a+=64;for(b=0;64>b;++b)d[a++]=d[c++]}}}else j=3>f?o.channel:this.mixChannel;o.volumeCtr&&(o.volumeCtr--,0==o.volumeCtr&&(o.volumeCtr=m.volumeSpeed,o.volumeStep=++o.volumeStep&127,o.volumeStep||m.volumeLoop?(a=o.volumeStep+(m.volume<<7),p=~(d[a]+129)+1,o.volume=(p&255)>>2,j.volume=o.volume):o.volumeCtr=0));p=o.note;m.arpeggio&&(a=o.arpeggioStep+(m.arpeggio<<
5),p+=this.arpeggios[a],o.arpeggioStep=++o.arpeggioStep&31);a=p+o.step.transpose+m.finetune;o.finalPeriod=l[a];c=o.finalPeriod;if(1==o.val1||12==o.val1)if(p=~o.val2+1,o.portamento+=p,o.finalPeriod+=o.portamento,o.val2&&(0>p&&o.finalPeriod<=o.period||0<=p&&o.finalPeriod>=o.period))o.portamento=o.period-c,o.val2=0;m.pitch&&(o.pitchCtr?o.pitchCtr--:(a=o.pitchStep,o.pitchStep=++o.pitchStep&127,0==o.pitchStep&&(o.pitchStep=m.pitchLoop),a+=m.pitch<<7,p=d[a],o.finalPeriod+=~p+1));j.period=o.finalPeriod}if(4<
this.numChannels){i=this.buffer1;this.buffer1=this.buffer2;this.buffer2=i;j=this.mixer.channels[3];j.pointer=i;for(f=3;7>f;++f)o=this.voices[f],o.mixStep=0,125>o.finalPeriod?(o.mixMute=1,o.mixSpeed=0):(b=(o.finalPeriod<<8)/this.mixPeriod&65535,e=(256/b&255)<<8,c=256%b<<8&16777215,o.mixSpeed=(e|c/b&255)<<8),o.mixVolume=o.mixMute?0:o.volume<<8;for(f=0;350>f;++f){c=0;for(b=3;7>b;++b)o=this.voices[b],e=(d[o.mixPtr+(o.mixStep>>16)]&255)+o.mixVolume,c+=this.volumes[e],o.mixStep+=o.mixSpeed;d[i++]=this.averages[c]}j.length=
350;j.period=this.mixPeriod;j.volume=64}if(0==--this.tick){if(this.tick=this.speed&15,this.speed=(this.speed&240)>>4,this.speed|=this.tick<<4,this.patternEnd=1,this.patternPos++,64==this.patternPos||this.patternPos==this.patternLen)this.patternPos=0,this.stepEnd=1,this.trackPos+=4,this.trackPos==this.song1.length&&(this.trackPos=this.song1.loopStep,this.mixer.complete=1)}else this.stepEnd=this.patternEnd=0;for(f=0;f<this.numChannels;++f)o=this.voices[f],o.mixPtr+=o.mixStep>>16,m=o.sample,m.effectDone=
0,o.mixPtr>=o.mixEnd&&(m.loop?o.mixPtr-=m.repeat:(o.mixPtr=0,o.mixMute=1)),4>f&&(j=o.channel,j.enabled=1)}},tables:{value:function(){var e=0,c,f,a=0,b=0,h,d,g=128;this.averages=new Int32Array(1024);this.volumes=new Int32Array(16384);for(this.mixPeriod=203;1024>e;++e)127<g&&(g-=256),this.averages[e]=g,383<e&&639>e&&(g=++g&255);for(e=0;64>e;++e){h=-128;d=128;for(f=0;256>f;++f)g=h*b/63+128,c=a+d,this.volumes[c]=g&255,0!=e&&63!=e&&128<=d&&--this.volumes[c],h++,d=++d&255;a+=256;b++}}}});e.voices[0]=n();
e.voices[1]=n();e.voices[2]=n();e.voices[3]=n();e.voices[4]=n();e.voices[5]=n();e.voices[6]=n();e.arpeggios=new Uint8Array(256);e.tables();return Object.seal(e)}})();
(function(){function n(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},soundTranspose:{value:0,writable:!0},transpose:{value:0,writable:!0},patStep:{value:0,writable:!0},frqStep:{value:0,writable:!0},frqPos:{value:0,writable:!0},frqSustain:{value:0,writable:!0},frqTranspose:{value:0,writable:!0},volStep:{value:0,writable:!0},volPos:{value:0,
writable:!0},volCtr:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},note:{value:0,writable:!0},pitch:{value:0,writable:!0},volume:{value:0,writable:!0},pitchBendFlag:{value:0,writable:!0},pitchBendSpeed:{value:0,writable:!0},pitchBendTime:{value:0,writable:!0},portamentoFlag:{value:0,writable:!0},portamento:{value:0,writable:!0},volBendFlag:{value:0,writable:!0},volBendSpeed:{value:0,writable:!0},volBendTime:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibrato:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.volPos=this.volStep=this.frqTranspose=this.frqSustain=this.frqPos=this.frqStep=this.patStep=this.transpose=this.soundTranspose=this.pattern=this.enabled=0;this.volSpeed=this.volCtr=1;this.vibrato=this.vibratoDelay=this.vibratoDepth=this.vibratoSpeed=this.vibratoFlag=this.volBendTime=this.volBendSpeed=this.volBendFlag=
this.portamento=this.portamentoFlag=this.pitchBendTime=this.pitchBendSpeed=this.pitchBendFlag=this.volume=this.pitch=this.note=this.volSustain=0}},volumeBend:{value:function(){if(this.volBendFlag^=1)if(this.volBendTime--,this.volume+=this.volBendSpeed,0>this.volume||64<this.volume)this.volBendTime=0}}})}var l=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,
127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113],e=[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,8,8,8,8,8,8,8,8,16,8,16,16,8,8,
24,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,63,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,
-80,-88,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-1,7,15,23,31,39,47,55,-64,
-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,31,39,47,55,-64,-64,-48,
-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,-80,55,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,
127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,-128,-128,-128,-128,-128,-128,
-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,127,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,-128,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,-128,
-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,0,16,32,48,64,80,96,
112,69,69,121,125,122,119,112,102,97,88,83,77,44,32,24,18,4,-37,-45,-51,-58,-68,-75,-82,-88,-93,-99,-103,-109,-114,-117,-118,69,69,121,125,122,119,112,102,91,75,67,55,44,32,24,18,4,-8,-24,-37,-49,-58,-66,-80,-88,-92,-98,-102,-107,-108,-115,-125,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,
0,16,32,48,64,80,96,112];window.neoart.FCPlayer=function(j){j=AmigaPlayer(j);Object.defineProperties(j,{id:{value:"FCPlayer"},seqs:{value:null,writable:!0},pats:{value:null,writable:!0},vols:{value:null,writable:!0},frqs:{value:null,writable:!0},length:{value:0,writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();this.seqs.position=0;this.pats.position=0;this.vols.position=0;for(this.frqs.position=0;c;)c.initialize(),
c.channel=this.mixer.channels[c.index],c.pattern=this.seqs.readUbyte()<<6,c.transpose=this.seqs.readByte(),c.soundTranspose=this.seqs.readByte(),c=c.next;this.speed=this.seqs.readUbyte();this.speed||(this.speed=3);this.tick=this.speed}},loader:{value:function(c){var f,a,b,h,d,g,i,j,l;a=c.readString(4);if("SMOD"==a)this.version=1;else if("FC14"==a)this.version=2;else return;c.position=4;this.length=c.readUint();c.position=1==this.version?100:180;this.seqs=ByteArray(new ArrayBuffer(this.length));c.readBytes(this.seqs,
0,this.length);this.length=this.length/13>>0;c.position=12;b=c.readUint();c.position=8;c.position=c.readUint();this.pats=ByteArray(new ArrayBuffer(b+1));c.readBytes(this.pats,0,b);c.position=20;b=c.readUint();c.position=16;c.position=c.readUint();this.frqs=ByteArray(new ArrayBuffer(b+9));this.frqs.writeInt(16777216);this.frqs.writeInt(225);c.readBytes(this.frqs,8,b);this.frqs.position=this.frqs.length-1;this.frqs.writeByte(225);this.frqs.position=0;c.position=28;b=c.readUint();c.position=24;c.position=
c.readUint();this.vols=ByteArray(new ArrayBuffer(b+8));this.vols.writeInt(16777216);this.vols.writeInt(225);c.readBytes(this.vols,8,b);c.position=32;i=c.readUint();c.position=40;1==this.version?(this.samples.length=57,h=0):(this.samples.length=200,h=2);for(f=0;10>f;++f)if(b=c.readUshort()<<1,0<b)if(d=c.position,c.position=i,a=c.readString(4),"SSMP"==a){j=b;for(a=0;10>a;++a)c.readInt(),b=c.readUshort()<<1,0<b?(g=AmigaSample(),g.length=b+2,g.loop=c.readUshort(),g.repeat=c.readUshort()<<1,g.loop+g.repeat>
g.length&&(g.repeat=g.length-g.loop),i+g.length>c.length&&(g.length=c.length-i),g.pointer=this.mixer.store(c,g.length,i+l),g.loopPtr=g.pointer+g.loop,this.samples[100+10*f+a]=g,l+=g.length,c.position+=6):c.position+=10;i+=j+2;c.position=d+4}else c.position=d,g=AmigaSample(),g.length=b+h,g.loop=c.readUshort(),g.repeat=c.readUshort()<<1,g.loop+g.repeat>g.length&&(g.repeat=g.length-g.loop),i+g.length>c.length&&(g.length=c.length-i),g.pointer=this.mixer.store(c,g.length,i),g.loopPtr=g.pointer+g.loop,
this.samples[f]=g,i+=g.length;else c.position+=4;if(1==this.version){h=0;j=47;for(f=10;57>f;++f){g=AmigaSample();g.length=e[h++]<<1;g.loop=0;g.repeat=g.length;d=this.mixer.memory.length;g.pointer=d;g.loopPtr=d;this.samples[f]=g;b=d+g.length;for(a=d;a<b;++a)this.mixer.memory[a]=e[j++]}}else{c.position=36;i=c.readUint();c.position=100;for(f=10;90>f;++f)b=c.readUbyte()<<1,2>b||(g=AmigaSample(),g.length=b,g.loop=0,g.repeat=g.length,i+g.length>c.length&&(g.length=c.length-i),g.pointer=this.mixer.store(c,
g.length,i),g.loopPtr=g.pointer,this.samples[f]=g,i+=g.length)}this.length*=13}},process:{value:function(){var c,f,a,b,h,d=this.voices[0];if(0==--this.tick){for(c=this.seqs.position;d;){f=d.channel;this.pats.position=d.pattern+d.patStep;h=this.pats.readUbyte();if(64<=d.patStep||73==h)this.seqs.position==this.length&&(this.seqs.position=0,this.mixer.complete=1),d.patStep=0,d.pattern=this.seqs.readUbyte()<<6,d.transpose=this.seqs.readByte(),d.soundTranspose=this.seqs.readByte(),this.pats.position=d.pattern,
h=this.pats.readUbyte();a=this.pats.readUbyte();this.frqs.position=0;this.vols.position=0;0!=h&&(d.note=h&127,d.pitch=0,d.portamento=0,d.enabled=f.enabled=0,h=8+((a&63)+d.soundTranspose<<6),h<this.vols.length&&(this.vols.position=h),d.volStep=0,d.volSpeed=d.volCtr=this.vols.readUbyte(),d.volSustain=0,d.frqPos=8+(this.vols.readUbyte()<<6),d.frqStep=0,d.frqSustain=0,d.vibratoFlag=0,d.vibratoSpeed=this.vols.readUbyte(),d.vibratoDepth=d.vibrato=this.vols.readUbyte(),d.vibratoDelay=this.vols.readUbyte(),
d.volPos=this.vols.position);a&64?d.portamento=0:a&128&&(d.portamento=this.pats[this.pats.position+1],1==this.version&&(d.portamento<<=1));d.patStep+=2;d=d.next}if(this.seqs.position!=c&&(h=this.seqs.readUbyte()))this.speed=h;this.tick=this.speed}for(d=this.voices[0];d;){f=d.channel;do{c=0;if(d.frqSustain){d.frqSustain--;break}this.frqs.position=d.frqPos+d.frqStep;do{b=0;if(!this.frqs.bytesAvailable)break;a=this.frqs.readUbyte();if(225==a)break;224==a&&(d.frqStep=this.frqs.readUbyte()&63,this.frqs.position=
d.frqPos+d.frqStep,a=this.frqs.readUbyte());switch(a){case 226:f.enabled=0,d.enabled=1,d.volCtr=1,d.volStep=0;case 228:(a=this.samples[this.frqs.readUbyte()])?(f.pointer=a.pointer,f.length=a.length):d.enabled=0;d.sample=a;d.frqStep+=2;break;case 233:h=100+10*this.frqs.readUbyte();if(a=this.samples[h+this.frqs.readUbyte()])f.enabled=0,f.pointer=a.pointer,f.length=a.length,d.enabled=1;d.sample=a;d.volCtr=1;d.volStep=0;d.frqStep+=3;break;case 231:b=1;d.frqPos=8+(this.frqs.readUbyte()<<6);d.frqPos>=this.frqs.length&&
(d.frqPos=0);d.frqStep=0;this.frqs.position=d.frqPos;break;case 234:d.pitchBendSpeed=this.frqs.readByte();d.pitchBendTime=this.frqs.readUbyte();d.frqStep+=3;break;case 232:c=1;d.frqSustain=this.frqs.readUbyte();d.frqStep+=2;break;case 227:d.vibratoSpeed=this.frqs.readUbyte(),d.vibratoDepth=this.frqs.readUbyte(),d.frqStep+=3}!c&&!b&&(this.frqs.position=d.frqPos+d.frqStep,d.frqTranspose=this.frqs.readByte(),d.frqStep++)}while(b)}while(c);if(d.volSustain)d.volSustain--;else if(d.volBendTime)d.volumeBend();
else if(0==--d.volCtr){d.volCtr=d.volSpeed;do{b=0;this.vols.position=d.volPos+d.volStep;if(!this.vols.bytesAvailable)break;a=this.vols.readUbyte();if(225==a)break;switch(a){case 234:d.volBendSpeed=this.vols.readByte();d.volBendTime=this.vols.readUbyte();d.volStep+=3;d.volumeBend();break;case 232:d.volSustain=this.vols.readUbyte();d.volStep+=2;break;case 224:b=1;h=this.vols.readUbyte()&63;d.volStep=h-5;break;default:d.volume=a,d.volStep++}}while(b)}a=d.frqTranspose;0<=a&&(a+=d.note+d.transpose);a&=
127;b=l[a];if(d.vibratoDelay)d.vibratoDelay--;else{h=d.vibrato;d.vibratoFlag?(c=d.vibratoDepth<<1,h+=d.vibratoSpeed,h>c&&(h=c,d.vibratoFlag=0)):(h-=d.vibratoSpeed,0>h&&(h=0,d.vibratoFlag=1));d.vibrato=h;h-=d.vibratoDepth;for(c=(a<<1)+160;256>c;)h<<=1,c+=24;b+=h}d.portamentoFlag^=1;d.portamentoFlag&&d.portamento&&(d.pitch=31<d.portamento?d.pitch+(d.portamento&31):d.pitch-d.portamento);d.pitchBendFlag^=1;d.pitchBendFlag&&d.pitchBendTime&&(d.pitchBendTime--,d.pitch-=d.pitchBendSpeed);b+=d.pitch;113>
b?b=113:3424<b&&(b=3424);f.period=b;f.volume=d.volume;d.sample&&(a=d.sample,f.enabled=d.enabled,f.pointer=a.loopPtr,f.length=a.repeat);d=d.next}}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);return Object.seal(j)}})();
(function(){function n(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},last:{value:0,writable:!0},slideCtr:{value:0,writable:!0},slideDir:{value:0,writable:!0},slideParam:{value:0,writable:!0},slidePeriod:{value:0,writable:!0},slideSpeed:{value:0,writable:!0},
stepPeriod:{value:0,writable:!0},stepSpeed:{value:0,writable:!0},stepWanted:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.stepWanted=this.stepSpeed=this.stepPeriod=this.slideSpeed=this.slidePeriod=this.slideParam=this.slideDir=this.slideCtr=this.last=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var l=[1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,
151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,-1];window.neoart.FXPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"FXPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},
force:{set:function(e){1>e?e=1:4<e&&(e=4);this.version=e}},ntsc:{set:function(e){this.standard=e;this.frequency(e);e=(e?20.44952532:20.637767904)*(this.sampleRate/1E3)/120;this.mixer.samplesTick=this.tempo/122*e>>0}},initialize:{value:function(){var e=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;e;)e.initialize(),e.channel=this.mixer.channels[e.index],e.sample=this.samples[0],e=e.next}},loader:{value:function(e){var c=0,f,a,b,h,
d=0,g;if(!(1686>e.length)){e.position=60;f=e.readString(4);if("SONG"!=f){e.position=124;f=e.readString(4);if("SO31"!=f||2350>e.length)return;b=544;this.samples.length=a=32;this.version=4}else b=0,this.samples.length=a=16,this.version=1;this.tempo=e.readUshort();e.position=0;for(f=1;f<a;++f)(g=e.readUint())?(h=AmigaSample(),h.pointer=d,d+=g,this.samples[f]=h):this.samples[f]=null;e.position+=20;for(f=1;f<a;++f)(h=this.samples[f])?(h.name=e.readString(22),h.length=e.readUshort()<<1,h.volume=e.readUshort(),
h.loop=e.readUshort(),h.repeat=e.readUshort()<<1):e.position+=30;e.position=530+b;this.length=a=e.readUbyte();e.position++;for(f=0;f<a;++f)g=e.readUbyte()<<8,this.track[f]=g,g>c&&(c=g);b&&(b+=4);e.position=660+b;c+=256;this.patterns.length=c;a=this.samples.length;for(f=0;f<c;++f){b=AmigaRow();b.note=e.readShort();g=e.readUbyte();b.param=e.readUbyte();b.effect=g&15;b.sample=g>>4;this.patterns[f]=b;if(4==this.version)b.note&4096&&(b.sample+=16,0<b.note&&(b.note&=61439));else{if(9==b.effect||856<b.note)this.version=
2;-3>b.note&&(this.version=3)}if(b.sample>=a||null==this.samples[b.sample])b.sample=0}this.mixer.store(e,d);for(f=1;f<a;++f)if(h=this.samples[f]){h.loop?h.loopPtr=h.pointer+h.loop:(h.loopPtr=this.mixer.memory.length,h.repeat=2);d=h.pointer+4;for(e=h.pointer;e<d;++e)this.mixer.memory[e]=0}h=AmigaSample();h.pointer=h.loopPtr=this.mixer.memory.length;h.length=h.repeat=2;this.samples[0]=h}}},process:{value:function(){var e,c,f,a,b=this.voices[0];if(this.tick)for(;b;){e=b.channel;if(!(2==this.version&&
-3==b.period))if(b.stepSpeed)b.stepPeriod+=b.stepSpeed,0>b.stepSpeed?b.stepPeriod<b.stepWanted&&(b.stepPeriod=b.stepWanted,2<this.version&&(b.stepSpeed=0)):b.stepPeriod>b.stepWanted&&(b.stepPeriod=b.stepWanted,2<this.version&&(b.stepSpeed=0)),2<this.version&&(b.last=b.stepPeriod),e.period=b.stepPeriod;else{if(b.slideSpeed&&(a=b.slideParam&15))if(++b.slideCtr==a)b.slideCtr=0,a=b.slideParam>>4<<3,b.slideDir?(b.slidePeriod-=8,e.period=b.slidePeriod,a-=b.slideSpeed,a==b.slidePeriod&&(b.slideDir=0)):(b.slidePeriod+=
8,e.period=b.slidePeriod,a+=b.slideSpeed,a==b.slidePeriod&&(b.slideDir=1));else{b=b.next;continue}a=0;switch(b.effect){case 1:a=this.tick%3;c=0;if(2==a){e.period=b.last;b=b.next;continue}for(a=1==a?b.param&15:b.param>>4;b.last!=l[c];)c++;e.period=l[c+a];break;case 2:a=b.param>>4;b.period=a?b.period+a:b.period-(b.param&15);e.period=b.period;break;case 3:this.mixer.filter.active=1;break;case 4:this.mixer.filter.active=0;break;case 8:a=-1;case 7:b.stepSpeed=b.param&15;f=2<this.version?b.last:b.period;
0>a&&(b.stepSpeed=-b.stepSpeed);for(c=0;;){e=l[c];if(e==f)break;if(0>e){c=-1;break}else c++}-1<c?(e=b.param>>4,-1<a&&(e=-e),c+=e,0>c&&(c=0),b.stepWanted=l[c]):b.stepWanted=b.period;break;case 9:b.slideSpeed=b.slidePeriod=b.period,b.slideParam=b.param,b.slideDir=0,b.slideCtr=0}}b=b.next}else for(a=this.track[this.trackPos]+this.patternPos;b;){e=b.channel;b.enabled=0;c=this.patterns[a+b.index];b.period=c.note;b.effect=c.effect;b.param=c.param;if(-3==c.note)b.effect=0;else if(c.sample?(c=b.sample=this.samples[c.sample],
b.volume=c.volume,5==b.effect?b.volume+=b.param:6==b.effect&&(b.volume-=b.param),e.volume=b.volume):c=b.sample,b.period){b.last=b.period;b.slideSpeed=0;b.stepSpeed=0;b.enabled=1;e.enabled=0;switch(b.period){case -2:e.volume=0;break;case -4:this.jumpFlag=1;break;case -5:break;default:e.pointer=c.pointer,e.length=c.length,e.period=b.period}b.enabled&&(e.enabled=1);e.pointer=c.loopPtr;e.length=c.repeat}b=b.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=
this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}}});e.voices[0]=n(0);e.voices[0].next=e.voices[1]=n(1);e.voices[1].next=e.voices[2]=n(2);e.voices[2].next=e.voices[3]=n(3);e.track=new Uint16Array(128);return Object.seal(e)}})();
(function(){function n(c){return Object.create(null,{index:{value:c,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume1:{value:0,writable:!0},volume2:{value:0,writable:!0},handler:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.wavePos=this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.handler=this.volume2=this.volume1=this.param=this.effect=this.period=this.enabled=0}}})}function l(){var c=AmigaSample();Object.defineProperties(c,{finetune:{value:0,writable:!0},restart:{value:0,writable:!0},waveLen:{value:0,writable:!0},waves:{value:null,writable:!0},volumes:{value:null,
writable:!0}});return Object.seal(c)}var e=[0,3,7,12,15,12,7,3,0,3,7,12,15,12,7,3,0,4,7,12,16,12,7,4,0,4,7,12,16,12,7,4,0,3,8,12,15,12,8,3,0,3,8,12,15,12,8,3,0,4,8,12,16,12,8,4,0,4,8,12,16,12,8,4,0,5,8,12,17,12,8,5,0,5,8,12,17,12,8,5,0,5,9,12,17,12,9,5,0,5,9,12,17,12,9,5,12,0,7,0,3,0,7,0,12,0,7,0,3,0,7,0,12,0,7,0,4,0,7,0,12,0,7,0,4,0,7,0,0,3,7,3,7,12,7,12,15,12,7,12,7,3,7,3,0,4,7,4,7,12,7,12,16,12,7,12,7,4,7,4,31,27,24,19,15,12,7,3,0,3,7,12,15,19,24,27,31,28,24,19,16,12,7,4,0,4,7,12,16,19,24,28,0,
12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,24,12,0,12,24,12,0,12,24,12,0,12,24,12,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,4,0,4,0,4,0,4,0,4,0,4,0,4,0,4],j=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],c=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.HMPlayer=function(f){f=AmigaPlayer(f);Object.defineProperties(f,{id:{value:"HMPlayer"},
track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.speed=6;this.jumpFlag=this.patternPos=this.trackPos=0;for(this.mixer.samplesTick=884;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],
a=a.next}},loader:{value:function(a){var b=0,c=0,d,g,e=0,f,j=0,p;if(!(2150>a.length)&&(a.position=1080,d=a.readString(4),"FEST"==d)){a.position=950;this.length=a.readUbyte();for(this.restart=a.readUbyte();128>c;++c)this.track[c]=a.readUbyte();a.position=0;this.title=a.readString(20);for(c=this.version=1;32>c;++c){this.samples[c]=null;d=a.readString(4);if("Mupp"==d){p=a.readUbyte();for(g=0;128>g;++g)this.track[g]&&this.track[g]>=p&&this.track[g]--;f=l();f.name=d;f.length=f.repeat=32;f.restart=a.readUbyte();
f.waveLen=a.readUbyte();a.position+=17;f.finetune=a.readByte();f.volume=a.readUbyte();d=a.position+4;p=1084+(p<<10);a.position=p;f.pointer=this.mixer.memory.length;f.waves=new Uint16Array(64);f.volumes=new Uint8Array(64);this.mixer.store(a,896);for(g=0;64>g;++g)f.waves[g]=a.readUbyte()<<5;for(g=0;64>g;++g)f.volumes[g]=a.readUbyte()&127;a.position=p;a.writeInt(1718382436);a.position=d;e+=896}else{d=d.substr(0,2);"El"==d?a.position+=18:(a.position-=4,d=a.readString(22));p=a.readUshort();if(!p){a.position+=
6;continue}f=l();f.name=d;f.pointer=j;f.length=p<<1;f.finetune=a.readByte();f.volume=a.readUbyte();f.loop=a.readUshort()<<1;f.repeat=a.readUshort()<<1;j+=f.length}this.samples[c]=f}for(c=0;128>c;++c)p=this.track[c]<<8,this.track[c]=p,p>b&&(b=p);a.position=1084;b+=256;this.patterns.length=b;for(c=0;c<b;++c){for(p=a.readUint();1718382436==p;)a.position+=1020,p=a.readUint();g=AmigaRow();g.note=p>>16&4095;g.sample=p>>24&240|p>>12&15;g.effect=p>>8&15;g.param=p&255;this.patterns[c]=g}this.mixer.store(a,
j);for(c=1;32>c;++c)if(f=this.samples[c],!(null==f||"Mupp"==f.name)){f.pointer+=e;f.loop?(f.loopPtr=f.pointer+f.loop,f.length=f.loop+f.repeat):(f.loopPtr=this.mixer.memory.length,f.repeat=2);j=f.pointer+4;for(g=f.pointer;g<j;++g)this.mixer.memory[g]=0}f=l();f.pointer=f.loopPtr=this.mixer.memory.length;f.length=f.repeat=2;this.samples[0]=f}}},process:{value:function(){var a,b,c,d,g,f=this.voices[0];if(this.tick)for(;f;)this.effects(f),this.handler(f),d=f.sample,f.channel.pointer=d.loopPtr,f.channel.length=
d.repeat,f=f.next;else for(b=this.track[this.trackPos]+this.patternPos;f;){a=f.channel;f.enabled=0;c=this.patterns[b+f.index];f.effect=c.effect;f.param=c.param;c.sample?(d=f.sample=this.samples[c.sample],f.volume2=d.volume,"Mupp"==d.name?(d.loopPtr=d.pointer+d.waves[0],f.handler=1,f.volume1=d.volumes[0]):(f.handler=0,f.volume1=64)):d=f.sample;c.note&&(3==f.effect||5==f.effect?c.note<f.period?(f.portaDir=1,f.portaPeriod=c.note):c.note>f.period?(f.portaDir=0,f.portaPeriod=c.note):f.portaPeriod=0:(f.period=
c.note,f.vibratoPos=0,f.wavePos=0,f.enabled=1,a.enabled=0,g=f.period*d.finetune>>8,a.period=f.period+g,f.handler?(a.pointer=d.loopPtr,a.length=d.repeat):(a.pointer=d.pointer,a.length=d.length)));switch(f.effect){case 11:this.trackPos=f.param-1;this.jumpFlag=1;break;case 12:f.volume2=f.param;64<f.volume2&&(f.volume2=64);break;case 13:this.jumpFlag=1;break;case 14:this.mixer.filter.active=f.param^1;break;case 15:g=f.param,1>g?g=1:31<g&&(g=31),this.speed=g,this.tick=0}c.note||this.effects(f);this.handler(f);
f.enabled&&(a.enabled=1);a.pointer=d.loopPtr;a.length=d.repeat;f=f.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}},effects:{value:function(a){var b=a.channel,f,d,g=a.period&4095,i,l;if(a.effect||a.param)switch(a.effect){case 0:l=this.tick%3;if(!l)break;l=1==l?a.param>>4:a.param&15;d=37-l;for(f=0;f<d;++f)if(g>=
j[f]){g=j[f+l];break}break;case 1:a.period-=a.param;113>a.period&&(a.period=113);g=a.period;break;case 2:a.period+=a.param;856<a.period&&(a.period=856);g=a.period;break;case 3:case 5:5==a.effect?i=1:a.param&&(a.portaSpeed=a.param,a.param=0);a.portaPeriod&&(a.portaDir?(a.period-=a.portaSpeed,a.period<a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)):(a.period+=a.portaSpeed,a.period>a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)));g=a.period;break;case 4:case 6:6==a.effect?i=1:a.param&&
(a.vibratoSpeed=a.param);l=c[a.vibratoPos>>2&31];l=(a.vibratoSpeed&15)*l>>7;g=127<a.vibratoPos?g-l:g+l;l=a.vibratoSpeed>>2&60;a.vibratoPos=a.vibratoPos+l&255;break;case 7:l=e[(a.vibratoPos&15)+((a.param&15)<<4)];a.vibratoPos++;for(f=0;37>f&&!(g>=j[f]);++f);l+=f;35<l&&(l-=12);g=j[l];break;case 10:i=1}b.period=g+(g*a.sample.finetune>>8);i&&(l=a.param>>4,a.volume2=l?a.volume2+l:a.volume2-(a.param&15),64<a.volume2?a.volume2=64:0>a.volume2&&(a.volume2=0))}},handler:{value:function(a){var b;a.handler&&
(b=a.sample,b.loopPtr=b.pointer+b.waves[a.wavePos],a.volume1=b.volumes[a.wavePos],++a.wavePos>b.waveLen&&(a.wavePos=b.restart));a.channel.volume=a.volume1*a.volume2>>6}}});f.voices[0]=n(0);f.voices[0].next=f.voices[1]=n(1);f.voices[1].next=f.voices[2]=n(2);f.voices[2].next=f.voices[3]=n(3);f.track=new Uint16Array(128);return Object.seal(f)}})();
(function(){function n(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var l=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],e=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.MKPlayer=function(j){j=AmigaPlayer(j);Object.defineProperties(j,
{id:{value:"MKPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},restartSave:{value:0,writable:!0},force:{set:function(c){1>c?c=1:5<c&&(c=5);this.version=c;this.vibratoDepth=5==c?6:7;3==c?(this.restartSave=this.restart,this.restart=
0):(this.restart=this.restartSave,this.restartSave=0)}},initialize:{value:function(){var c=this.voices[0];this.reset();this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[0],c=c.next}},loader:{value:function(c){var f=0,a,b,h=0,d;if(!(2150>c.length)&&(c.position=1080,a=c.readString(4),!("M.K."!=a&&"FLT4"!=a))){c.position=0;this.title=c.readString(20);this.version=1;c.position+=22;for(a=1;32>a;++a)(d=c.readUshort())?
(b=AmigaSample(),c.position-=24,b.name=c.readString(22),b.length=d<<1,c.position+=3,b.volume=c.readUbyte(),b.loop=c.readUshort()<<1,b.repeat=c.readUshort()<<1,c.position+=22,b.pointer=h,h+=b.length,this.samples[a]=b,32768<b.length&&(this.version=2)):(this.samples[a]=null,c.position+=28);c.position=950;this.length=c.readUbyte();d=c.readUbyte();this.restart=d<length?d:0;for(a=0;128>a;++a)d=c.readUbyte()<<8,this.track[a]=d,d>f&&(f=d);c.position=1084;f+=256;this.patterns.length=f;for(a=0;a<f;++a){b=AmigaRow();
d=c.readUint();b.note=d>>16&4095;b.effect=d>>8&15;b.sample=d>>24&240|d>>12&15;b.param=d&255;this.patterns[a]=b;if(31<b.sample||!this.samples[b.sample])b.sample=0;if(3==b.effect||4==b.effect)this.version=3;if(5==b.effect||6==b.effect)this.version=5;if(6<b.effect&&10>b.effect){this.version=0;return}}this.mixer.store(c,h);for(a=1;32>a;++a)if(b=this.samples[a]){-1<b.name.indexOf("2.0")&&(this.version=5);b.loop?(b.loopPtr=b.pointer+b.loop,b.length=b.loop+b.repeat):(b.loopPtr=this.mixer.memory.length,b.repeat=
2);h=b.pointer+4;for(c=b.pointer;c<h;++c)this.mixer.memory[c]=0}b=AmigaSample();b.pointer=b.loopPtr=this.mixer.memory.length;b.length=b.repeat=2;this.samples[0]=b;5>this.version&&this.restart&&(this.version=4)}}},process:{value:function(){var c,f,a,b,h,d,g=this.voices[0];if(this.tick)for(;g;){c=g.channel;if(!g.effect&&!g.param)c.period=g.period;else{switch(g.effect){case 0:h=this.tick%3;if(!h){c.period=g.period;g=g.next;continue}h=1==h?g.param>>4:g.param&15;b=g.period&4095;a=37-h;for(f=0;f<a;++f)if(b>=
l[f]){c.period=l[f+h];break}break;case 1:g.period-=g.param;113>g.period&&(g.period=113);c.period=g.period;break;case 2:g.period+=g.param;856<g.period&&(g.period=856);c.period=g.period;break;case 3:case 5:5==g.effect?d=1:g.param&&(g.portaSpeed=g.param,g.param=0);g.portaPeriod&&(g.portaDir?(g.period-=g.portaSpeed,g.period<=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)):(g.period+=g.portaSpeed,g.period>=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)));c.period=g.period;break;case 4:case 6:6==
g.effect?d=1:g.param&&(g.vibratoSpeed=g.param);h=g.vibratoPos>>2&31;h=(g.vibratoSpeed&15)*e[h]>>this.vibratoDepth;c.period=127<g.vibratoPos?g.period-h:g.period+h;h=g.vibratoSpeed>>2&60;g.vibratoPos=g.vibratoPos+h&255;break;case 10:d=1}d&&(h=g.param>>4,d=0,g.volume=h?g.volume+h:g.volume-(g.param&15),0>g.volume?g.volume=0:64<g.volume&&(g.volume=64),c.volume=g.volume)}g=g.next}else for(f=this.track[this.trackPos]+this.patternPos;g;){c=g.channel;g.enabled=0;h=this.patterns[f+g.index];g.effect=h.effect;
g.param=h.param;h.sample?(a=g.sample=this.samples[h.sample],c.volume=g.volume=a.volume):a=g.sample;h.note&&(3==g.effect||5==g.effect?h.note<g.period?(g.portaDir=1,g.portaPeriod=h.note):h.note>g.period?(g.portaDir=0,g.portaPeriod=h.note):g.portaPeriod=0:(g.enabled=1,g.vibratoPos=0,c.enabled=0,c.pointer=a.pointer,c.length=a.length,c.period=g.period=h.note));switch(g.effect){case 11:this.trackPos=g.param-1;this.jumpFlag^=1;break;case 12:c.volume=g.param;5==this.version&&(g.volume=g.param);break;case 13:this.jumpFlag^=
1;break;case 14:this.mixer.filter.active=g.param^1;break;case 15:h=g.param,1>h?h=1:31<h&&(h=31),this.speed=h,this.tick=0}g.enabled&&(c.enabled=1);c.pointer=a.loopPtr;c.length=a.repeat;g=g.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=
j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);j.track=new Uint16Array(128);return Object.seal(j)}})();
(function(){function n(c){return Object.create(null,{index:{value:c,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},loopCtr:{value:0,writable:!0},loopPos:{value:0,writable:!0},step:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,
writable:!0},finetune:{value:0,writable:!0},offset:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},tremoloParam:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloWave:{value:0,writable:!0},vibratoParam:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoWave:{value:0,writable:!0},funkPos:{value:0,writable:!0},funkSpeed:{value:0,writable:!0},funkWave:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.funkWave=this.funkSpeed=this.funkPos=this.vibratoWave=this.vibratoPos=this.vibratoParam=this.tremoloWave=this.tremoloPos=this.tremoloParam=this.glissando=this.portaSpeed=this.portaPeriod=this.portaDir=this.offset=this.finetune=this.repeat=this.loopPtr=this.length=this.pointer=this.volume=this.param=this.effect=this.period=this.step=this.loopPos=this.loopCtr=this.enabled=0}}})}function l(){var c=AmigaSample();Object.defineProperties(c,{finetune:{value:0,writable:!0},realLen:{value:0,
writable:!0}});return Object.seal(c)}var e=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,850,802,757,715,674,637,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,239,225,213,201,189,179,169,159,150,142,134,126,119,113,0,844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,224,211,199,188,177,167,158,149,141,133,125,118,112,0,838,791,746,704,665,
628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,111,0,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,124,117,110,0,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,109,0,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,
244,230,217,205,193,183,172,163,154,145,137,129,122,115,109,0,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,204,192,181,171,161,152,144,136,128,121,114,108,0,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,0,900,850,802,757,715,675,636,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,238,225,212,200,189,179,169,159,150,142,134,126,119,0,894,
844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,125,118,0,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,0,881,832,785,741,699,660,623,588,555,524,494,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,123,117,0,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,
328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,0,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,122,115,0,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,121,114,0],j=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24],c=[0,5,6,
7,8,10,11,13,16,19,22,26,32,43,64,128];window.neoart.PTPlayer=function(f){f=AmigaPlayer(f);Object.defineProperties(f,{id:{value:"PTPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternBreak:{value:0,writable:!0},patternDelay:{value:0,writable:!0},breakPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,
writable:!0},force:{set:function(a){1>a?a=1:3<a&&(a=3);this.version=a;this.vibratoDepth=2>a?6:7}},initialize:{value:function(){var a=this.voices[0];this.tempo=125;this.speed=6;this.jumpFlag=this.breakPos=this.patternDelay=this.patternBreak=this.patternPos=this.trackPos=0;for(this.reset();a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var b=0,c,d,f=0,e;if(!(2150>a.length)&&(a.position=1080,c=a.readString(4),!("M.K."!=c&&"M!K!"!=
c))){a.position=0;this.title=a.readString(20);this.version=1;a.position+=22;for(c=1;32>c;++c)(e=a.readUshort())?(d=l(),a.position-=24,d.name=a.readString(22),d.length=d.realLen=e<<1,a.position+=2,d.finetune=37*a.readUbyte(),d.volume=a.readUbyte(),d.loop=a.readUshort()<<1,d.repeat=a.readUshort()<<1,a.position+=22,d.pointer=f,f+=d.length,this.samples[c]=d):(this.samples[c]=null,a.position+=28);a.position=950;this.length=a.readUbyte();a.position++;for(c=0;128>c;++c)e=a.readUbyte()<<8,this.track[c]=e,
e>b&&(b=e);a.position=1084;b+=256;this.patterns.length=b;for(c=0;c<b;++c){e=AmigaRow();Object.defineProperties(e,{step:{value:0,writable:!0}});d=Object.seal(e);d.step=e=a.readUint();d.note=e>>16&4095;d.effect=e>>8&15;d.sample=e>>24&240|e>>12&15;d.param=e&255;this.patterns[c]=d;if(31<d.sample||!this.samples[d.sample])d.sample=0;15==d.effect&&31<d.param&&(this.version=2);8==d.effect&&(this.version=3)}this.mixer.store(a,f);for(c=1;32>c;++c)if(d=this.samples[c]){d.loop||4<d.repeat?(d.loopPtr=d.pointer+
d.loop,d.length=d.loop+d.repeat):(d.loopPtr=this.mixer.memory.length,d.repeat=2);f=d.pointer+2;for(a=d.pointer;a<f;++a)this.mixer.memory[a]=0}d=l();d.pointer=d.loopPtr=this.mixer.memory.length;d.length=d.repeat=2;this.samples[0]=d}}},process:{value:function(){var a,b,c,d,f,i=this.voices[0];if(this.tick)this.effects();else if(this.patternDelay)this.effects();else{for(c=this.track[this.trackPos]+this.patternPos;i;){a=i.channel;i.enabled=0;i.step||(a.period=i.period);d=this.patterns[c+i.index];i.step=
d.step;i.effect=d.effect;i.param=d.param;d.sample&&(b=i.sample=this.samples[d.sample],i.pointer=b.pointer,i.length=b.length,i.loopPtr=i.funkWave=b.loopPtr,i.repeat=b.repeat,i.finetune=b.finetune,a.volume=i.volume=b.volume);if(d.note){if(3664==(i.step&4080))i.finetune=37*(i.param&15);else if(3==i.effect||5==i.effect)if(d.note==i.period)i.portaPeriod=0;else{b=i.finetune;for(f=b+37;b<f&&!(d.note>=e[b]);++b);b==f&&f--;0<b&&(f=i.finetune/37>>0&8)&&b--;i.portaPeriod=e[b];i.portaDir=d.note>i.portaPeriod?
0:1}else 9==i.effect&&this.moreEffects(i);for(b=0;37>b&&!(d.note>=e[b]);++b);i.period=e[i.finetune+b];3792==(i.step&4080)?(i.funkSpeed&&this.updateFunk(i),this.extended(i)):(4>i.vibratoWave&&(i.vibratoPos=0),4>i.tremoloWave&&(i.tremoloPos=0),a.enabled=0,a.pointer=i.pointer,a.length=i.length,a.period=i.period,i.enabled=1,this.moreEffects(i))}else this.moreEffects(i);i=i.next}for(i=this.voices[0];i;)a=i.channel,i.enabled&&(a.enabled=1),a.pointer=i.loopPtr,a.length=i.repeat,i=i.next}if(++this.tick==
this.speed&&(this.tick=0,this.patternPos+=4,this.patternDelay&&--this.patternDelay&&(this.patternPos-=4),this.patternBreak&&(this.patternBreak=0,this.patternPos=this.breakPos,this.breakPos=0),256==this.patternPos||this.jumpFlag))this.patternPos=this.breakPos,this.jumpFlag=this.breakPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},effects:{value:function(){for(var a,b,c,d,f,i=this.voices[0];i;){a=i.channel;i.funkSpeed&&this.updateFunk(i);if(0==(i.step&4095))a.period=i.period;
else{switch(i.effect){case 0:f=this.tick%3;if(!f){a.period=i.period;i=i.next;continue}f=1==f?i.param>>4:i.param&15;b=i.finetune;for(c=b+37;b<c;++b)if(i.period>=e[b]){a.period=e[b+f];break}break;case 1:i.period-=i.param;113>i.period&&(i.period=113);a.period=i.period;break;case 2:i.period+=i.param;856<i.period&&(i.period=856);a.period=i.period;break;case 3:case 5:5==i.effect?d=1:(i.portaSpeed=i.param,i.param=0);if(i.portaPeriod)if(i.portaDir?(i.period-=i.portaSpeed,i.period<=i.portaPeriod&&(i.period=
i.portaPeriod,i.portaPeriod=0)):(i.period+=i.portaSpeed,i.period>=i.portaPeriod&&(i.period=i.portaPeriod,i.portaPeriod=0)),i.glissando){b=i.finetune;for(f=b+37;b<f&&!(i.period>=e[b]);++b);b==f&&b--;a.period=e[b]}else a.period=i.period;break;case 4:case 6:if(6==i.effect)d=1;else if(i.param){if(f=i.param&15)i.vibratoParam=i.vibratoParam&240|f;if(f=i.param&240)i.vibratoParam=i.vibratoParam&15|f}c=i.vibratoPos>>2&31;(b=i.vibratoWave&3)?(f=255,c<<=3,1==b&&(f=127<i.vibratoPos?f-c:c)):f=j[c];f=(i.vibratoParam&
15)*f>>this.vibratoDepth;a.period=127<i.vibratoPos?i.period-f:i.period+f;f=i.vibratoParam>>2&60;i.vibratoPos=i.vibratoPos+f&255;break;case 7:a.period=i.period;if(i.param){if(f=i.param&15)i.tremoloParam=i.tremoloParam&240|f;if(f=i.param&240)i.tremoloParam=i.tremoloParam&15|f}c=i.tremoloPos>>2&31;(b=i.tremoloWave&3)?(f=255,c<<=3,1==b&&(f=127<i.tremoloPos?f-c:c)):f=j[c];f=(i.tremoloParam&15)*f>>6;a.volume=127<i.tremoloPos?i.volume-f:i.volume+f;f=i.tremoloParam>>2&60;i.tremoloPos=i.tremoloPos+f&255;break;
case 10:d=1;break;case 14:this.extended(i)}d&&(d=0,f=i.param>>4,i.volume=f?i.volume+f:i.volume-(i.param&15),0>i.volume?i.volume=0:64<i.volume&&(i.volume=64),a.volume=i.volume)}i=i.next}}},moreEffects:{value:function(a){var b=a.channel;a.funkSpeed&&this.updateFunk(a);switch(a.effect){case 9:a.param&&(a.offset=a.param);b=a.offset<<8;b>=a.length?a.length=2:(a.pointer+=b,a.length-=b);break;case 11:this.trackPos=a.param-1;this.breakPos=0;this.jumpFlag=1;break;case 12:a.volume=a.param;64<a.volume&&(a.volume=
64);b.volume=a.volume;break;case 13:this.breakPos=10*(a.param>>4)+(a.param&15);this.breakPos=63<this.breakPos?0:this.breakPos<<2;this.jumpFlag=1;break;case 14:this.extended(a);break;case 15:if(!a.param)break;32>a.param?this.speed=a.param:this.mixer.samplesTick=2.5*this.sampleRate/a.param>>0;this.tick=0}}},extended:{value:function(a){var b=a.channel,c;c=a.param&15;switch(a.param>>4){case 0:this.mixer.filter.active=c;break;case 1:if(this.tick)break;a.period-=c;113>a.period&&(a.period=113);b.period=
a.period;break;case 2:if(this.tick)break;a.period+=c;856<a.period&&(a.period=856);b.period=a.period;break;case 3:a.glissando=c;break;case 4:a.vibratoWave=c;break;case 5:a.finetune=37*c;break;case 6:if(this.tick)break;c?(a.loopCtr?a.loopCtr--:a.loopCtr=c,a.loopCtr&&(this.breakPos=a.loopPos<<2,this.patternBreak=1)):a.loopPos=this.patternPos>>2;break;case 7:a.tremoloWave=c;break;case 8:b=a.length-2;c=this.mixer.memory;for(a=a.loopPtr;a<b;)c[a]=0.5*(c[a]+c[++a]);c[++a]=0.5*(c[a]+c[0]);break;case 9:if(this.tick||
!c||!a.period)break;if(this.tick%c)break;b.enabled=0;b.pointer=a.pointer;b.length=a.length;b.delay=30;b.enabled=1;b.pointer=a.loopPtr;b.length=a.repeat;b.period=a.period;break;case 10:if(this.tick)break;a.volume+=c;64<a.volume&&(a.volume=64);b.volume=a.volume;break;case 11:if(this.tick)break;a.volume-=c;0>a.volume&&(a.volume=0);b.volume=a.volume;break;case 12:this.tick==c&&(b.volume=a.volume=0);break;case 13:if(this.tick!=c||!a.period)break;b.enabled=0;b.pointer=a.pointer;b.length=a.length;b.delay=
30;b.enabled=1;b.pointer=a.loopPtr;b.length=a.repeat;b.period=a.period;break;case 14:if(this.tick||this.patternDelay)break;this.patternDelay=++c;break;case 15:if(this.tick)break;(a.funkSpeed=c)&&this.updateFunk(a)}}},updateFunk:{value:function(a){var b=a.channel,f,d;a.funkPos+=c[a.funkSpeed];128>a.funkPos||(a.funkPos=0,1==this.version?(f=a.pointer+a.sample.realLen-a.repeat,d=a.funkWave+a.repeat,d>f&&(d=a.loopPtr,b.length=a.repeat),b.pointer=a.funkWave=d):(f=a.loopPtr+a.repeat,d=a.funkWave+1,d>=f&&
(d=a.loopPtr),this.mixer.memory[d]=-this.mixer.memory[d]))}}});f.voices[0]=n(0);f.voices[0].next=f.voices[1]=n(1);f.voices[1].next=f.voices[2]=n(2);f.voices[2].next=f.voices[3]=n(3);f.track=new Uint16Array(128);return Object.seal(f)}})();
(function(){function n(c){return Object.create(null,{index:{value:c,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:0,writable:!0},row:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},note:{value:0,writable:!0},noteTimer:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},bendTo:{value:0,writable:!0},bendSpeed:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},
envelopeCtr:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchFallCtr:{value:0,writable:!0},sustainCtr:{value:0,writable:!0},phaseTimer:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveList:{value:0,writable:!0},waveTimer:{value:0,writable:!0},waitCtr:{value:0,writable:!0},initialize:{value:function(){this.sample=this.row=this.step=0;this.samplePtr=-1;this.noteTimer=this.note=this.sampleLen=0;this.period=39321;this.waitCtr=this.waveTimer=this.waveList=
this.wavePos=this.phaseSpeed=this.phaseTimer=this.sustainCtr=this.pitchFallCtr=this.pitchCtr=this.envelopeCtr=this.arpeggioCtr=this.bendSpeed=this.bendTo=this.volume=0}}})}function l(){var c=AmigaSample();Object.defineProperties(c,{waveform:{value:0,writable:!0},arpeggio:{value:null,writable:!0},attackSpeed:{value:0,writable:!0},attackMax:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseMin:{value:0,
writable:!0},phaseShift:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},finetune:{value:0,writable:!0},pitchFall:{value:0,writable:!0}});c.arpeggio=new Uint8Array(16);return Object.seal(c)}var e=[1166,408,908],j=[0,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,
160,151,143,135,127,0,0,0,0,0,0,0,4028,3806,3584,3394,3204,3013,2855,2696,2538,2395,2268,2141,2014,1903,1792,1697,1602,1507,1428,1348,1269,1198,1134,1071,1007,952,896,849,801,754,714,674,635,599,567,536,504,476,448,425,401,377,357,337,310,300,284,268,252,238,224,213,201,189,179,169,159,150,142,134,0,0,0,0,0,0,0,3993,3773,3552,3364,3175,2987,2830,2672,2515,2374,2248,2122,1997,1887,1776,1682,1588,1494,1415,1336,1258,1187,1124,1061,999,944,888,841,794,747,708,668,629,594,562,531,500,472,444,421,397,
374,354,334,315,297,281,266,250,236,222,211,199,187,177,167,158,149,141,133,0,0,0,0,0,0,0,3957,3739,3521,3334,3147,2960,2804,2648,2493,2353,2228,2103,1979,1870,1761,1667,1574,1480,1402,1324,1247,1177,1114,1052,990,935,881,834,787,740,701,662,624,589,557,526,495,468,441,417,394,370,351,331,312,295,279,263,248,234,221,209,197,185,176,166,156,148,140,132,0,0,0,0,0,0,0,3921,3705,3489,3304,3119,2933,2779,2625,2470,2331,2208,2084,1961,1853,1745,1652,1560,1467,1390,1313,1235,1166,1104,1042,981,927,873,826,
780,734,695,657,618,583,552,521,491,464,437,413,390,367,348,329,309,292,276,261,246,232,219,207,195,184,174,165,155,146,138,131,0,0,0,0,0,0,0,3886,3671,3457,3274,3090,2907,2754,2601,2448,2310,2188,2065,1943,1836,1729,1637,1545,1454,1377,1301,1224,1155,1094,1033,972,918,865,819,773,727,689,651,612,578,547,517,486,459,433,410,387,364,345,326,306,289,274,259,243,230,217,205,194,182,173,163,153,145,137,130,0,0,0,0,0,0,0,3851,3638,3426,3244,3062,2880,2729,2577,2426,2289,2168,2047,1926,1819,1713,1622,1531,
1440,1365,1289,1213,1145,1084,1024,963,910,857,811,766,720,683,645,607,573,542,512,482,455,429,406,383,360,342,323,304,287,271,256,241,228,215,203,192,180,171,162,152,144,136,128,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127];window.neoart.S1Player=
function(c){c=AmigaPlayer(c);Object.defineProperties(c,{id:{value:"S1Player"},tracksPtr:{value:null,writable:!0},tracks:{value:[],writable:!0},patternsPtr:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},waveLists:{value:null,writable:!0},speedDef:{value:0,writable:!0},patternDef:{value:0,writable:!0},mix1Speed:{value:0,writable:!0},mix2Speed:{value:0,writable:!0},mix1Dest:{value:0,writable:!0},mix2Dest:{value:0,writable:!0},mix1Source1:{value:0,writable:!0},
mix1Source2:{value:0,writable:!0},mix2Source1:{value:0,writable:!0},mix2Source2:{value:0,writable:!0},doFilter:{value:0,writable:!0},doReset:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},trackEnd:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternEnd:{value:0,writable:!0},patternLen:{value:0,writable:!0},mix1Ctr:{value:0,writable:!0},mix2Ctr:{value:0,writable:!0},mix1Pos:{value:0,writable:!0},mix2Pos:{value:0,writable:!0},
audPtr:{value:0,writable:!0},audLen:{value:0,writable:!0},audPer:{value:0,writable:!0},audVol:{value:0,writable:!0},initialize:{value:function(){var c,a,b=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.trackPos=1;this.trackEnd=0;this.patternPos=-1;this.patternEnd=0;this.patternLen=this.patternDef;for(this.mix2Ctr=this.mix2Pos=this.mix1Ctr=this.mix1Pos=0;b;)b.initialize(),c=this.mixer.channels[b.index],b.channel=c,b.step=this.tracksPtr[b.index],a=this.tracks[b.step],b.row=this.patternsPtr[a.pattern],
b.sample=this.patterns[b.row].sample,c.length=32,c.period=b.period,c.enabled=1,b=b.next}},loader:{value:function(c){for(var a,b,h,d,g,i,j,m,p,o,r,n;8<c.bytesAvailable;)if(m=c.readUshort(),16890==m&&(h=c.readUshort(),m=c.readUshort(),53736==m&&(m=c.readUshort(),65492==m))){n=4076==h?4090:5222==h?5188:h;i=h+c.position-6;break}if(i&&(c.position=i," SID-MON BY R.v.VLIET  (c) 1988 "==c.readString(32))){c.position=i-44;m=c.readUint();for(b=1;4>b;++b)this.tracksPtr[b]=(c.readUint()-m)/6>>0;c.position=i-
8;m=c.readUint();g=c.readUint();g<m&&(g=c.length-i);p=g-m>>2;this.patternsPtr=new Uint32Array(p);c.position=i+m+4;for(b=1;b<p;++b){m=c.readUint()/5>>0;if(0==m){p=b;break}this.patternsPtr[b]=m}this.patternsPtr.length=p;c.position=i-44;m=c.readUint();c.position=i-28;g=(c.readUint()-m)/6>>0;this.tracks.length=g;c.position=i+m;for(b=0;b<g;++b){m=AmigaStep();m.pattern=c.readUint();m.pattern>=p&&(m.pattern=0);c.readByte();m.transpose=c.readByte();if(-99>m.transpose||99<m.transpose)m.transpose=0;this.tracks[b]=
m}c.position=i-24;m=c.readUint();r=c.readUint()-m;for(b=0;32>b;++b)this.mixer.memory[b]=0;this.mixer.store(c,r,i+m);r>>=5;c.position=i-16;m=c.readUint();g=c.readUint()-m+16;h=r+2<<4;this.waveLists=new Uint8Array(g<h?h:g);c.position=i+m;for(b=0;b<h;)this.waveLists[b++]=b>>4,this.waveLists[b++]=255,this.waveLists[b++]=255,this.waveLists[b++]=16,b+=12;for(b=16;b<g;++b)this.waveLists[b]=c.readUbyte();c.position=i-20;c.position=i+c.readUint();this.mix1Source1=c.readUint();this.mix2Source1=c.readUint();
this.mix1Source2=c.readUint();this.mix2Source2=c.readUint();this.mix1Dest=c.readUint();this.mix2Dest=c.readUint();this.patternDef=c.readUint();this.trackLen=c.readUint();this.speedDef=c.readUint();this.mix1Speed=c.readUint();this.mix2Speed=c.readUint();this.mix1Source1>r&&(this.mix1Source1=0);this.mix2Source1>r&&(this.mix2Source1=0);this.mix1Source2>r&&(this.mix1Source2=0);this.mix2Source2>r&&(this.mix2Source2=0);this.mix1Dest>r&&(this.mix1Speed=0);this.mix2Dest>r&&(this.mix2Speed=0);0==this.speedDef&&
(this.speedDef=4);c.position=i-28;h=c.readUint();p=c.readUint()-h>>5;63<p&&(p=63);g=p+1;c.position=i-4;m=c.readUint();if(1==m){c.position=1820;m=c.readUshort();if(19962!=m&&(c.position=1788,m=c.readUshort(),19962!=m)){this.version=0;return}c.position+=c.readUshort();this.samples.length=g+3;for(b=0;3>b;++b)j=l(),j.waveform=16+b,j.length=e[b],j.pointer=this.mixer.store(c,j.length),j.loop=j.loopPtr=0,j.repeat=4,j.volume=64,this.samples[g+b]=j,c.position+=j.length}else this.samples.length=g,c.position=
i+m,a=c.readUint(),o=(a>>5)+15,d=c.position,a+=d;j=l();this.samples[0]=j;c.position=i+h;for(b=1;b<g;++b){j=l();j.waveform=c.readUint();for(h=0;16>h;++h)j.arpeggio[h]=c.readUbyte();j.attackSpeed=c.readUbyte();j.attackMax=c.readUbyte();j.decaySpeed=c.readUbyte();j.decayMin=c.readUbyte();j.sustain=c.readUbyte();c.readByte();j.releaseSpeed=c.readUbyte();j.releaseMin=c.readUbyte();j.phaseShift=c.readUbyte();j.phaseSpeed=c.readUbyte();j.finetune=c.readUbyte();j.pitchFall=c.readByte();5188==n?(j.pitchFall=
j.finetune,j.finetune=0):(15<j.finetune&&(j.finetune=0),j.finetune*=67);j.phaseShift>r&&(j.phaseShift=0,j.phaseSpeed=0);if(15<j.waveform)if(15<o&&j.waveform>o)j.waveform=0;else{m=d+(j.waveform-16<<5);if(m>=c.length)continue;h=c.position;c.position=m;j.pointer=c.readUint();j.loop=c.readUint();j.length=c.readUint();j.name=c.readString(20);0==j.loop||99999==j.loop||199999==j.loop||j.loop>=j.length?(j.loop=0,j.repeat=4090==n?2:4):(j.repeat=j.length-j.loop,j.loop-=j.pointer);j.length-=j.pointer;j.length<
j.loop+j.repeat&&(j.length=j.loop+j.repeat);j.pointer=this.mixer.store(c,j.length,a+j.pointer);j.loopPtr=6>j.repeat||0==j.loop?0:j.pointer+j.loop;c.position=h}else j.waveform>r&&(j.waveform=0);this.samples[b]=j}c.position=i-12;m=c.readUint();g=(c.readUint()-m)/5>>0;this.patterns.length=g;c.position=i+m;for(b=0;b<g;++b)a=AmigaRow(),Object.defineProperties(a,{speed:{value:0,writable:!0}}),a=Object.seal(a),a.note=c.readUbyte(),a.sample=c.readUbyte(),a.effect=c.readUbyte(),a.param=c.readUbyte(),a.speed=
c.readUbyte(),5188==n?(0<a.note&&255>a.note&&(a.note+=469),0<a.effect&&255>a.effect&&(a.effect+=469),59<a.sample&&(a.sample=p+(a.sample-60))):a.sample>p&&(a.sample=0),this.patterns[b]=a;4464==n||4550==n||5188==n?(4464==n&&(this.mix1Speed=this.mix2Speed=0),this.doReset=this.doFilter=0):this.doReset=this.doFilter=1;this.version=1}}},process:{value:function(){var c,a,b,e=this.mixer.memory,d,g;for(g=this.voices[0];g;){c=g.channel;this.audPtr=-1;this.audLen=this.audPer=this.audVol=0;if(0==this.tick)if(this.patternEnd&&
(this.trackEnd?g.step=this.tracksPtr[g.index]:g.step++,b=this.tracks[g.step],g.row=this.patternsPtr[b.pattern],this.doReset&&(g.noteTimer=0)),0==g.noteTimer){d=this.patterns[g.row];0==d.sample?d.note&&(g.noteTimer=d.speed,g.waitCtr&&(a=this.samples[g.sample],this.audPtr=a.pointer,this.audLen=a.length,g.samplePtr=a.loopPtr,g.sampleLen=a.repeat,g.waitCtr=1,c.enabled=0)):(a=this.samples[d.sample],g.waitCtr&&(c.enabled=g.waitCtr=0),15<a.waveform?(this.audPtr=a.pointer,this.audLen=a.length,g.samplePtr=
a.loopPtr,g.sampleLen=a.repeat,g.waitCtr=1):(g.wavePos=0,g.waveList=a.waveform,b=g.waveList<<4,this.audPtr=this.waveLists[b]<<5,this.audLen=32,g.waveTimer=this.waveLists[++b]),g.noteTimer=d.speed,g.sample=d.sample,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=0);if(d.note&&(g.noteTimer=d.speed,255!=d.note))switch(a=this.samples[g.sample],b=this.tracks[g.step],g.note=d.note+b.transpose,g.period=this.audPer=j[1+a.finetune+g.note],g.phaseSpeed=a.phaseSpeed,g.bendSpeed=g.volume=0,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=
0,d.effect){case 0:if(0==d.param)break;a.attackSpeed=d.param;a.attackMax=d.param;g.waveTimer=0;break;case 2:this.speed=d.param;g.waveTimer=0;break;case 3:this.patternLen=d.param;g.waveTimer=0;break;default:g.bendTo=d.effect+b.transpose,g.bendSpeed=d.param}g.row++}else g.noteTimer--;a=this.samples[g.sample];this.audVol=g.volume;switch(g.envelopeCtr){case 0:this.audVol+=a.attackSpeed;this.audVol>a.attackMax&&(this.audVol=a.attackMax,g.envelopeCtr+=2);break;case 2:this.audVol-=a.decaySpeed;if(this.audVol<=
a.decayMin||-256>this.audVol)this.audVol=a.decayMin,g.envelopeCtr+=2,g.sustainCtr=a.sustain;break;case 4:g.sustainCtr--;if(0==g.sustainCtr||-256==g.sustainCtr)g.envelopeCtr+=2;break;case 6:if(this.audVol-=a.releaseSpeed,this.audVol<=a.releaseMin||-256>this.audVol)this.audVol=a.releaseMin,g.envelopeCtr=8}g.volume=this.audVol;g.arpeggioCtr=++g.arpeggioCtr&15;b=a.finetune+a.arpeggio[g.arpeggioCtr]+g.note;g.period=this.audPer=j[b];if(g.bendSpeed&&(d=j[a.finetune+g.bendTo],b=~g.bendSpeed+1,-128>b&&(b&=
255),g.pitchCtr+=b,g.period+=g.pitchCtr,0>b&&g.period<=d||0<b&&g.period>=d))g.note=g.bendTo,g.period=d,g.bendSpeed=0,g.pitchCtr=0;a.phaseShift&&(g.phaseSpeed?g.phaseSpeed--:(g.phaseTimer=++g.phaseTimer&31,b=(a.phaseShift<<5)+g.phaseTimer,g.period+=e[b]>>2));g.pitchFallCtr-=a.pitchFall;-256>g.pitchFallCtr&&(g.pitchFallCtr+=256);g.period+=g.pitchFallCtr;0==g.waitCtr&&(g.waveTimer?g.waveTimer--:16>g.wavePos&&(b=(g.waveList<<4)+g.wavePos,d=this.waveLists[b++],255==d?g.wavePos=this.waveLists[b]&254:(this.audPtr=
d<<5,g.waveTimer=this.waveLists[b],g.wavePos+=2)));-1<this.audPtr&&(c.pointer=this.audPtr);0!=this.audPer&&(c.period=g.period);0!=this.audLen&&(c.length=this.audLen);c.volume=a.volume?a.volume:this.audVol>>2;c.enabled=1;g=g.next}this.trackEnd=this.patternEnd=0;++this.tick>this.speed&&(this.tick=0,++this.patternPos==this.patternLen&&(this.patternPos=0,this.patternEnd=1,++this.trackPos==this.trackLen&&(this.trackPos=this.trackEnd=this.mixer.complete=1)));if(this.mix1Speed){if(0==this.mix1Ctr){this.mix1Ctr=
this.mix1Speed;b=this.mix1Pos=++this.mix1Pos&31;c=(this.mix1Dest<<5)+31;g=(this.mix1Source1<<5)+31;d=this.mix1Source2<<5;for(a=31;-1<a;--a)e[c--]=e[g--]+e[d+b]>>1,b=--b&31}this.mix1Ctr--}if(this.mix2Speed){if(0==this.mix2Ctr){this.mix2Ctr=this.mix2Speed;b=this.mix2Pos=++this.mix2Pos&31;c=(this.mix2Dest<<5)+31;g=(this.mix2Source1<<5)+31;d=this.mix2Source2<<5;for(a=31;-1<a;--a)e[c--]=e[g--]+e[d+b]>>1,b=--b&31}this.mix2Ctr--}this.doFilter&&(b=this.mix1Pos+32,e[b]=~e[b]+1);for(g=this.voices[0];g;)c=g.channel,
1==g.waitCtr?g.waitCtr++:2==g.waitCtr&&(g.waitCtr++,c.pointer=g.samplePtr,c.length=g.sampleLen),g=g.next}}});c.voices[0]=n(0);c.voices[0].next=c.voices[1]=n(1);c.voices[1].next=c.voices[2]=n(2);c.voices[2].next=c.voices[3]=n(3);c.tracksPtr=new Uint32Array(4);return Object.seal(c)}})();
(function(){function n(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},instr:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},instrument:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},original:{value:0,writable:!0},adsrPos:{value:0,writable:!0},
sustainCtr:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendCtr:{value:0,writable:!0},noteSlideTo:{value:0,writable:!0},noteSlideSpeed:{value:0,writable:!0},waveCtr:{value:0,writable:!0},wavePos:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},speed:{value:0,writable:!0},initialize:{value:function(){this.sample=this.instr=this.row=this.step=null;this.speed=this.vibratoPos=this.vibratoCtr=
this.arpeggioPos=this.arpeggioCtr=this.wavePos=this.waveCtr=this.noteSlideSpeed=this.noteSlideTo=this.pitchBendCtr=this.pitchBend=this.sustainCtr=this.adsrPos=this.original=this.volume=this.period=this.note=this.instrument=this.pattern=this.enabled=0}}})}function l(){return Object.create(null,{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},waveDelay:{value:0,writable:!0},waveSpeed:{value:0,writable:!0},arpeggio:{value:0,writable:!0},arpeggioLen:{value:0,writable:!0},arpeggioDelay:{value:0,
writable:!0},arpeggioSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoLen:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendDelay:{value:0,writable:!0},attackMax:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseMin:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0}})}var e=[0,5760,5424,5120,
4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95];window.neoart.S2Player=function(j){j=AmigaPlayer(j);Object.defineProperties(j,{id:{value:"S2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},instruments:{value:[],writable:!0},
samples:{value:[],writable:!0},arpeggios:{value:null,writable:!0},vibratos:{value:null,writable:!0},waves:{value:null,writable:!0},length:{value:0,writable:!0},speedDef:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},arpeggioFx:{value:null,writable:!0},arpeggioPos:{value:0,writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.patternPos=
this.trackPos=0;for(this.patternLen=64;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.instr=this.instruments[0],this.arpeggioFx[c.index]=0,c=c.next}},loader:{value:function(c){var e=0,a=0,b,h,d,g=0,i,j,m;c.position=58;if("SIDMON II - THE MIDI VERSION"==c.readString(28)){c.position=2;this.length=c.readUbyte();this.speedDef=c.readUbyte();this.samples.length=c.readUshort()>>6;c.position=14;d=c.readUint();this.tracks.length=d;for(c.position=90;a<d;++a)b=AmigaStep(),Object.defineProperties(b,
{soundTranspose:{value:0,writable:!0}}),b=Object.seal(b),b.pattern=c.readUbyte(),b.pattern>e&&(e=b.pattern),this.tracks[a]=b;for(a=0;a<d;++a)b=this.tracks[a],b.transpose=c.readByte();for(a=0;a<d;++a)b=this.tracks[a],b.soundTranspose=c.readByte();b=c.position;c.position=26;d=c.readUint()>>5;this.instruments.length=++d;c.position=b;this.instruments[0]=l();for(a=0;++a<d;)b=l(),b.wave=c.readUbyte()<<4,b.waveLen=c.readUbyte(),b.waveSpeed=c.readUbyte(),b.waveDelay=c.readUbyte(),b.arpeggio=c.readUbyte()<<
4,b.arpeggioLen=c.readUbyte(),b.arpeggioSpeed=c.readUbyte(),b.arpeggioDelay=c.readUbyte(),b.vibrato=c.readUbyte(),b.vibratoLen=c.readUbyte(),b.vibratoSpeed=c.readUbyte(),b.vibratoDelay=c.readUbyte(),b.pitchBend=c.readByte(),b.pitchBendDelay=c.readUbyte(),c.readByte(),c.readByte(),b.attackMax=c.readUbyte(),b.attackSpeed=c.readUbyte(),b.decayMin=c.readUbyte(),b.decaySpeed=c.readUbyte(),b.sustain=c.readUbyte(),b.releaseMin=c.readUbyte(),b.releaseSpeed=c.readUbyte(),this.instruments[a]=b,c.position+=
9;b=c.position;c.position=30;d=c.readUint();this.waves=new Uint8Array(d);c.position=b;for(a=0;a<d;++a)this.waves[a]=c.readUbyte();b=c.position;c.position=34;d=c.readUint();this.arpeggios=new Int8Array(d);c.position=b;for(a=0;a<d;++a)this.arpeggios[a]=c.readByte();b=c.position;c.position=38;d=c.readUint();this.vibratos=new Int8Array(d);c.position=b;for(a=0;a<d;++a)this.vibratos[a]=c.readByte();d=this.samples.length;for(a=b=0;a<d;++a)j=AmigaSample(),Object.defineProperties(j,{negStart:{value:0,writable:!0},
negLen:{value:0,writable:!0},negSpeed:{value:0,writable:!0},negDir:{value:0,writable:!0},negOffset:{value:0,writable:!0},negPos:{value:0,writable:!0},negCtr:{value:0,writable:!0},negToggle:{value:0,writable:!0}}),j=Object.seal(j),c.readUint(),j.length=c.readUshort()<<1,j.loop=c.readUshort()<<1,j.repeat=c.readUshort()<<1,j.negStart=b+(c.readUshort()<<1),j.negLen=c.readUshort()<<1,j.negSpeed=c.readUshort(),j.negDir=c.readUshort(),j.negOffset=c.readShort(),j.negPos=c.readUint(),j.negCtr=c.readUshort(),
c.position+=6,j.name=c.readString(32),j.pointer=b,j.loopPtr=b+j.loop,b+=j.length,this.samples[a]=j;j=b;d=++e;e=new Uint16Array(++e);for(a=0;a<d;++a)e[a]=c.readUshort();b=c.position;c.position=50;d=c.readUint();this.patterns=[];c.position=b;h=1;for(a=0;a<d;++a)i=AmigaRow(),Object.defineProperties(i,{speed:{value:0,writable:!0}}),i=Object.seal(i),(m=c.readByte())?0>m?i.speed=~m:112>m?(i.note=m,m=c.readByte(),a++,0>m?i.speed=~m:112>m?(i.sample=m,m=c.readByte(),a++,0>m?i.speed=~m:(i.effect=m,i.param=
c.readUbyte(),a++)):(i.effect=m,i.param=c.readUbyte(),a++)):(i.effect=m,i.param=c.readUbyte(),a++):(i.effect=c.readByte(),i.param=c.readUbyte(),a+=2),this.patterns[g++]=i,b+e[h]==c.position&&(e[h++]=g);e[h]=this.patterns.length;0!=(c.position&1)&&c.position++;this.mixer.store(c,j);d=this.tracks.length;for(a=0;a<d;++a)b=this.tracks[a],b.pattern=e[b.pattern];this.length++;this.version=2}}},process:{value:function(){var c,f,a,b,h,d=this.voices[0];this.arpeggioPos=++this.arpeggioPos&3;if(++this.tick>=
this.speed){for(this.tick=0;d;)c=d.channel,d.enabled=d.note=0,this.patternPos||(d.step=this.tracks[this.trackPos+d.index*this.length],d.pattern=d.step.pattern,d.speed=0),0>--d.speed&&(d.row=a=this.patterns[d.pattern++],d.speed=a.speed,a.note&&(d.enabled=1,d.note=a.note+d.step.transpose,c.enabled=0)),d.pitchBend=0,d.note&&(d.waveCtr=d.sustainCtr=0,d.arpeggioCtr=d.arpeggioPos=0,d.vibratoCtr=d.vibratoPos=0,d.pitchBendCtr=d.noteSlideSpeed=0,d.adsrPos=4,d.volume=0,a.sample&&(d.instrument=a.sample,d.instr=
this.instruments[d.instrument+d.step.soundTranspose],d.sample=this.samples[this.waves[d.instr.wave]]),d.original=d.note+this.arpeggios[d.instr.arpeggio],c.period=d.period=e[d.original],b=d.sample,c.pointer=b.pointer,c.length=b.length,c.enabled=d.enabled,c.pointer=b.loopPtr,c.length=b.repeat),d=d.next;++this.patternPos==this.patternLen&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}for(d=this.voices[0];d;){if(d.sample&&(b=d.sample,!b.negToggle))if(b.negToggle=
1,b.negCtr)b.negCtr=--b.negCtr&31;else{b.negCtr=b.negSpeed;if(!b.negDir){d=d.next;continue}h=b.negStart=b.negPos;this.mixer.memory[h]=~this.mixer.memory[h];b.negPos+=b.negOffset;h=b.negLen-1;0>b.negPos?2==b.negDir?b.negPos=h:(b.negOffset=~b.negOffset+1,b.negPos+=b.negOffset):h<b.negPos&&(1==b.negDir?b.negPos=0:(b.negOffset=~b.negOffset+1,b.negPos+=b.negOffset))}d=d.next}for(d=this.voices[0];d;)d.sample&&(d.sample.negToggle=0),d=d.next;for(d=this.voices[0];d;){c=d.channel;f=d.instr;switch(d.adsrPos){case 4:d.volume+=
f.attackSpeed;f.attackMax<=d.volume&&(d.volume=f.attackMax,d.adsrPos--);break;case 3:f.decaySpeed?(d.volume-=f.decaySpeed,f.decayMin>=d.volume&&(d.volume=f.decayMin,d.adsrPos--)):d.adsrPos--;break;case 2:d.sustainCtr==f.sustain?d.adsrPos--:d.sustainCtr--;break;case 1:d.volume-=f.releaseSpeed,f.releaseMin>=d.volume&&(d.volume=f.releaseMin,d.adsrPos--)}c.volume=d.volume>>2;f.waveLen&&(d.waveCtr==f.waveDelay?(d.waveCtr=f.waveDelay-f.waveSpeed,d.wavePos==f.waveLen?d.wavePos=0:d.wavePos++,d.sample=b=this.samples[this.waves[f.wave+
d.wavePos]],c.pointer=b.pointer,c.length=b.length):d.waveCtr++);f.arpeggioLen&&(d.arpeggioCtr==f.arpeggioDelay?(d.arpeggioCtr=f.arpeggioDelay-f.arpeggioSpeed,d.arpeggioPos==f.arpeggioLen?d.arpeggioPos=0:d.arpeggioPos++,h=d.original+this.arpeggios[f.arpeggio+d.arpeggioPos],d.period=e[h]):d.arpeggioCtr++);a=d.row;if(!this.tick)switch(a.effect){case 112:this.arpeggioFx[0]=a.param>>4;this.arpeggioFx[2]=a.param&15;h=d.original+this.arpeggioFx[this.arpeggioPos];d.period=e[h];break;case 113:d.pitchBend=
~a.param+1;break;case 114:d.pitchBend=a.param;break;case 115:if(0!=d.adsrPos)break;0!=d.instrument&&(d.volume=f.attackMax);d.volume+=a.param<<2;256<=d.volume&&(d.volume=-1);break;case 116:if(0!=d.adsrPos)break;0!=d.instrument&&(d.volume=f.attackMax);d.volume-=a.param<<2;0>d.volume&&(d.volume=0)}switch(a.effect){case 117:f.attackMax=a.param;f.attackSpeed=a.param;break;case 118:this.patternLen=a.param;break;case 119:c.volume=a.param;d.volume=a.param<<2;255<=d.volume&&(d.volume=255);break;case 120:if(h=
a.param&15)this.speed=h}f.vibratoLen&&(d.vibratoCtr==f.vibratoDelay?(d.vibratoCtr=f.vibratoDelay-f.vibratoSpeed,d.vibratoPos==f.vibratoLen?d.vibratoPos=0:d.vibratoPos++,d.period+=this.vibratos[f.vibrato+d.vibratoPos]):d.vibratoCtr++);f.pitchBend&&(d.pitchBendCtr==f.pitchBendDelay?d.pitchBend+=f.pitchBend:d.pitchBendCtr++);a.param&&a.effect&&112>a.effect&&(d.noteSlideTo=e[a.effect+d.step.transpose],h=a.param,0>d.noteSlideTo-d.period&&(h=~h+1),d.noteSlideSpeed=h);if(d.noteSlideTo&&d.noteSlideSpeed&&
(d.period+=d.noteSlideSpeed,0>d.noteSlideSpeed&&d.period<d.noteSlideTo||0<d.noteSlideSpeed&&d.period>d.noteSlideTo))d.noteSlideSpeed=0,d.period=d.noteSlideTo;d.period+=d.pitchBend;95>d.period?d.period=95:5760<d.period&&(d.period=5760);c.period=d.period;d=d.next}}}});j.voices[0]=n(0);j.voices[0].next=j.voices[1]=n(1);j.voices[1].next=j.voices[2]=n(2);j.voices[2].next=j.voices[3]=n(3);j.arpeggioFx=new Uint8Array(4);return Object.seal(j)}})();
(function(){function n(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},last:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.param=this.effect=this.last=this.period=this.enabled=0}}})}var l=[856,808,762,720,678,640,604,570,538,508,480,453,428,
404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0];window.neoart.STPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"STPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},force:{set:function(e){1>e?
e=1:4<e&&(e=4);this.version=e}},ntsc:{set:function(e){this.standard=e;this.frequency(e);3>this.version&&(e=(e?20.44952532:20.637767904)*(this.sampleRate/1E3)/120,this.mixer.samplesTick=(240-this.tempo)*e>>0)}},initialize:{value:function(){var e=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;e;)e.initialize(),e.channel=this.mixer.channels[e.index],e.sample=this.samples[0],e=e.next}},loader:{value:function(e){var c=0,f,a,b=0,h=0,d;
if(!(1626>e.length)){this.title=e.readString(20);b+=this.isLegal(this.title);this.version=1;e.position=42;for(f=1;16>f;++f)(d=e.readUshort())?(a=AmigaSample(),e.position-=24,a.name=e.readString(22),a.length=d<<1,e.position+=3,a.volume=e.readUbyte(),a.loop=e.readUshort(),a.repeat=e.readUshort()<<1,e.position+=22,a.pointer=h,h+=a.length,this.samples[f]=a,b+=this.isLegal(a.name),9999<a.length&&(this.version=3)):(this.samples[f]=null,e.position+=28);e.position=470;this.length=e.readUbyte();this.tempo=
e.readUbyte();for(f=0;128>f;++f)d=e.readUbyte()<<8,16384<d&&b--,this.track[f]=d,d>c&&(c=d);e.position=600;c+=256;this.patterns.length=c;f=e.length-h-600>>2;c>f&&(c=f);for(f=0;f<c;++f){a=AmigaRow();a.note=e.readUshort();d=e.readUbyte();a.param=e.readUbyte();a.effect=d&15;a.sample=d>>4;this.patterns[f]=a;2<a.effect&&11>a.effect&&b--;a.note&&(113>a.note||856<a.note)&&b--;if(a.sample&&(15<a.sample||!this.samples[a.sample]))15<a.sample&&b--,a.sample=0;if(2<a.effect||!a.effect&&0!=a.param)this.version=
2;if(11==a.effect||13==a.effect)this.version=4}this.mixer.store(e,h);for(f=1;16>f;++f)if(a=this.samples[f]){a.loop?(a.loopPtr=a.pointer+a.loop,a.pointer=a.loopPtr,a.length=a.repeat):(a.loopPtr=this.mixer.memory.length,a.repeat=2);h=a.pointer+4;for(e=a.pointer;e<h;++e)this.mixer.memory[e]=0}a=AmigaSample();a.pointer=a.loopPtr=this.mixer.memory.length;a.length=a.repeat=2;this.samples[0]=a;1>b&&(this.version=0)}}},process:{value:function(){var e,c,f,a=this.voices[0];if(this.tick)for(;a;){if(a.param)if(e=
a.channel,1==this.version)1==a.effect?this.arpeggio(a):2==a.effect&&(f=a.param>>4,a.period=f?a.period+f:a.period-(a.param&15),e.period=a.period);else{switch(a.effect){case 0:this.arpeggio(a);break;case 1:a.period-=a.param&15;113>a.period&&(a.period=113);e.period=a.period;break;case 2:a.period+=a.param&15,856<a.period&&(a.period=856),e.period=a.period}if(2!=(this.version&2)){a=a.next;continue}switch(a.effect){case 12:e.volume=a.param;break;case 13:this.mixer.filter.active=0;break;case 14:this.speed=
a.param&15}}a=a.next}else for(f=this.track[this.trackPos]+this.patternPos;a;){e=a.channel;a.enabled=0;c=this.patterns[f+a.index];a.period=c.note;a.effect=c.effect;a.param=c.param;c.sample?(c=a.sample=this.samples[c.sample],e.volume=2==(this.version&2)&&12==a.effect?a.param:c.volume):c=a.sample;a.period&&(a.enabled=1,e.enabled=0,e.pointer=c.pointer,e.length=c.length,e.period=a.last=a.period);a.enabled&&(e.enabled=1);e.pointer=c.loopPtr;e.length=c.repeat;if(!(4>this.version))switch(a.effect){case 11:this.trackPos=
a.param-1;this.jumpFlag^=1;break;case 12:e.volume=a.param;break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=a.param^1;break;case 15:if(!a.param)break;this.speed=a.param&15;this.tick=0}a=a.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},arpeggio:{value:function(e){var c=e.channel,f=0,a=this.tick%3;if(a){for(a=1==a?e.param>>
4:e.param&15;e.last!=l[f];)f++;c.period=l[f+a]}else c.period=e.last}},isLegal:{value:function(e){var c,f=0,a=e.length;if(!a)return 0;for(;f<a;++f)if((c=e.charCodeAt(f))&&(32>c||127<c))return 0;return 1}}});e.voices[0]=n(0);e.voices[0].next=e.voices[1]=n(1);e.voices[1].next=e.voices[2]=n(2);e.voices[2].next=e.voices[3]=n(3);e.track=new Uint16Array(128);return Object.seal(e)}})();
(function(){function n(a){a=Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},flags:{value:0,writable:!0},delay:{value:0,writable:!0},channel:{value:null,writable:!0},patternLoop:{value:0,writable:!0},patternLoopRow:{value:0,writable:!0},playing:{value:null,writable:!0},note:{value:0,writable:!0},keyoff:{value:0,writable:!0},period:{value:0,writable:!0},finetune:{value:0,writable:!0},arpDelta:{value:0,writable:!0},vibDelta:{value:0,writable:!0},instrument:{value:null,writable:!0},
autoVibratoPos:{value:0,writable:!0},autoSweep:{value:0,writable:!0},autoSweepPos:{value:0,writable:!0},sample:{value:null,writable:!0},sampleOffset:{value:0,writable:!0},volume:{value:0,writable:!0},volEnabled:{value:0,writable:!0},volEnvelope:{value:null,writable:!0},volDelta:{value:0,writable:!0},volSlide:{value:0,writable:!0},volSlideMaster:{value:0,writable:!0},fineSlideU:{value:0,writable:!0},fineSlideD:{value:0,writable:!0},fadeEnabled:{value:0,writable:!0},fadeDelta:{value:0,writable:!0},
fadeVolume:{value:0,writable:!0},panning:{value:0,writable:!0},panEnabled:{value:0,writable:!0},panEnvelope:{value:null,writable:!0},panSlide:{value:0,writable:!0},portaU:{value:0,writable:!0},portaD:{value:0,writable:!0},finePortaU:{value:0,writable:!0},finePortaD:{value:0,writable:!0},xtraPortaU:{value:0,writable:!0},xtraPortaD:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},glissPeriod:{value:0,writable:!0},vibratoPos:{value:0,
writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoReset:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloSpeed:{value:0,writable:!0},tremoloDepth:{value:0,writable:!0},waveControl:{value:0,writable:!0},tremorPos:{value:0,writable:!0},tremorOn:{value:0,writable:!0},tremorOff:{value:0,writable:!0},tremorVolume:{value:0,writable:!0},retrigx:{value:0,writable:!0},retrigy:{value:0,writable:!0},reset:{value:function(){this.volume=this.sample.volume;this.panning=
this.sample.panning;this.finetune=this.sample.finetune>>3<<2;this.fadeDelta=this.fadeEnabled=this.volDelta=this.keyoff=0;this.fadeVolume=65536;this.autoVibratoPos=0;this.autoSweep=1;this.vibratoReset=this.vibDelta=this.autoSweepPos=0;4>(this.waveControl&15)&&(this.vibratoPos=0);4>this.waveControl>>4&&(this.tremoloPos=0)}},autoVibrato:{value:function(){var a;this.autoVibratoPos=this.autoVibratoPos+this.playing.vibratoSpeed&255;switch(this.playing.vibratoType){case 0:a=g[this.autoVibratoPos];break;
case 1:a=128>this.autoVibratoPos?-64:64;break;case 2:a=(64+(this.autoVibratoPos>>1)&127)-64;break;case 3:a=(64-(this.autoVibratoPos>>1)&127)-64}a*=this.playing.vibratoDepth;this.autoSweep&&(this.playing.vibratoSweep?this.autoSweepPos>this.playing.vibratoSweep?(this.autoSweepPos&2&&(a*=this.autoSweepPos/this.playing.vibratoSweep),this.autoSweep=0):a*=++this.autoSweepPos/this.playing.vibratoSweep:this.autoSweep=0);this.flags|=h;return a>>6}},tonePortamento:{value:function(){this.glissPeriod||(this.glissPeriod=
this.period);this.period<this.portaPeriod?(this.glissPeriod+=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period>=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0)):this.period>this.portaPeriod&&(this.glissPeriod-=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period<=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0));
this.flags|=h}},tremolo:{value:function(){var a=255,b=this.tremoloPos&31;switch(this.waveControl>>4&3){case 0:a=i[b];break;case 1:a=b<<3}this.volDelta=a*this.tremoloDepth>>6;31<this.tremoloPos&&(this.volDelta=-this.volDelta);this.tremoloPos=this.tremoloPos+this.tremoloSpeed&63;this.flags|=d}},tremor:{value:function(){this.tremorPos==this.tremorOn?(this.tremorVolume=this.volume,this.volume=0):(this.tremorPos=0,this.volume=this.tremorVolume);this.flags|=d;this.tremorPos++}},vibrato:{value:function(){var a=
255,b=this.vibratoPos&31;switch(this.waveControl&3){case 0:a=i[b];break;case 1:a=b<<3,31<this.vibratoPos&&(a=255-a)}this.vibDelta=a*this.vibratoDepth>>7;31<this.vibratoPos&&(this.vibDelta=-this.vibDelta);this.vibratoPos=this.vibratoPos+this.vibratoSpeed&63;this.flags|=h}}});a.volEnvelope=e();a.panEnvelope=e();return Object.seal(a)}function l(){return Object.create(null,{points:{value:[],writable:!0},total:{value:0,writable:!0},sustain:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopEnd:{value:0,
writable:!0},flags:{value:0,writable:!0}})}function e(){return Object.create(null,{value:{value:0,writable:!0},position:{value:0,writable:!0},frame:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},stopped:{value:0,writable:!0},reset:{value:function(){this.stopped=this.fraction=this.delta=this.frame=this.position=this.value=0}}})}function j(){var a=Object.create(null,{name:{value:"",writable:!0},samples:{value:[],writable:!0},noteSamples:{value:null,writable:!0},fadeout:{value:0,
writable:!0},volData:{value:null,writable:!0},volEnabled:{value:0,writable:!0},panData:{value:null,writable:!0},panEnabled:{value:0,writable:!0},vibratoType:{value:0,writable:!0},vibratoSweep:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0}});a.noteSamples=new Uint8Array(96);a.volData=l();a.panData=l();return Object.seal(a)}function c(a,b){var c=Object.create(null,{rows:{value:[],writable:!0},length:{value:0,writable:!0},size:{value:0,writable:!0}});c.rows.length=
c.size=a*b;c.length=a;return Object.seal(c)}function f(a,b){var c=Object.create(null,{frame:{value:0,writable:!0},value:{value:0,writable:!0}});c.frame=a||0;c.value=b||0;return Object.seal(c)}function a(){return Object.create(null,{note:{value:0,writable:!0},instrument:{value:0,writable:!0},volume:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}function b(){var a=SBSample();Object.defineProperties(a,{finetune:{value:0,writable:!0},panning:{value:0,writable:!0},relative:{value:0,
writable:!0}});return Object.seal(a)}var h=1,d=2,g=[0,-2,-3,-5,-6,-8,-9,-11,-12,-14,-16,-17,-19,-20,-22,-23,-24,-26,-27,-29,-30,-32,-33,-34,-36,-37,-38,-39,-41,-42,-43,-44,-45,-46,-47,-48,-49,-50,-51,-52,-53,-54,-55,-56,-56,-57,-58,-59,-59,-60,-60,-61,-61,-62,-62,-62,-63,-63,-63,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-63,-63,-63,-62,-62,-62,-61,-61,-60,-60,-59,-59,-58,-57,-56,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-39,-38,-37,-36,-34,-33,-32,-30,-29,-27,-26,-24,-23,-22,
-20,-19,-17,-16,-14,-12,-11,-9,-8,-6,-5,-3,-2,0,2,3,5,6,8,9,11,12,14,16,17,19,20,22,23,24,26,27,29,30,32,33,34,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,56,57,58,59,59,60,60,61,61,62,62,62,63,63,63,64,64,64,64,64,64,64,64,64,64,64,63,63,63,62,62,62,61,61,60,60,59,59,58,57,56,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,39,38,37,36,34,33,32,30,29,27,26,24,23,22,20,19,17,16,14,12,11,9,8,6,5,3,2],i=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,
212,197,180,161,141,120,97,74,49,24],q=[0,0.04417,0.062489,0.076523,0.088371,0.098821,0.108239,0.116927,0.124977,0.132572,0.139741,0.146576,0.153077,0.159335,0.16535,0.171152,0.176772,0.18221,0.187496,0.19263,0.197643,0.202503,0.207273,0.211951,0.216477,0.220943,0.225348,0.229631,0.233854,0.237985,0.242056,0.246066,0.249985,0.253873,0.25767,0.261437,0.265144,0.268819,0.272404,0.275989,0.279482,0.282976,0.286409,0.289781,0.293153,0.296464,0.299714,0.302965,0.306185,0.309344,0.312473,0.315602,0.318671,
0.321708,0.324746,0.327754,0.3307,0.333647,0.336563,0.339449,0.342305,0.345161,0.347986,0.350781,0.353545,0.356279,0.359013,0.361717,0.364421,0.367094,0.369737,0.37238,0.374992,0.377574,0.380157,0.382708,0.38526,0.387782,0.390303,0.392794,0.395285,0.397746,0.400176,0.402606,0.405037,0.407437,0.409836,0.412206,0.414576,0.416915,0.419254,0.421563,0.423841,0.42618,0.428458,0.430737,0.432985,0.435263,0.437481,0.439729,0.441916,0.444134,0.446321,0.448508,0.450665,0.452852,0.455009,0.457136,0.459262,0.461389,
0.463485,0.465611,0.467708,0.469773,0.471839,0.473935,0.47597,0.478036,0.480072,0.482077,0.484112,0.486117,0.488122,0.490127,0.492101,0.494106,0.496051,0.498025,0.5,0.501944,0.503888,0.505802,0.507746,0.50966,0.511574,0.513488,0.515371,0.517255,0.519138,0.521022,0.522905,0.524758,0.526611,0.528465,0.530318,0.53214,0.533993,0.535816,0.537639,0.539462,0.541254,0.543046,0.544839,0.546631,0.548423,0.550216,0.551978,0.553739,0.555501,0.557263,0.558995,0.560757,0.562489,0.56422,0.565952,0.567683,0.569384,
0.571116,0.572817,0.574518,0.57622,0.57789,0.579592,0.581262,0.582964,0.584634,0.586305,0.587946,0.589617,0.591257,0.592928,0.594568,0.596209,0.597849,0.599459,0.6011,0.60271,0.60435,0.60596,0.60757,0.60915,0.61076,0.61237,0.61395,0.61556,0.617139,0.618719,0.620268,0.621848,0.623428,0.624977,0.626557,0.628106,0.629655,0.631205,0.632754,0.634303,0.635822,0.637372,0.63889,0.64044,0.641959,0.643478,0.644966,0.646485,0.648004,0.649523,0.651012,0.6525,0.653989,0.655477,0.656966,0.658454,0.659943,0.661431,
0.66289,0.664378,0.665836,0.667294,0.668783,0.670241,0.671699,0.673127,0.674585,0.676043,0.677471,0.678929,0.680357,0.681785,0.683213,0.684641,0.686068,0.687496,0.688894,0.690321,0.691749,0.693147,0.694574,0.695972,0.697369,0.698767,0.700164,0.701561,0.702928,0.704326,0.705723,0.70711],m=[0,0.005863,0.013701,0.021569,0.029406,0.037244,0.045082,0.052919,0.060757,0.068625,0.076463,0.0843,0.092138,0.099976,0.107844,0.115681,0.123519,0.131357,0.139194,0.147032,0.1549,0.162738,0.170575,0.178413,0.186251,
0.194119,0.201956,0.209794,0.217632,0.225469,0.233307,0.241175,0.249013,0.25685,0.264688,0.272526,0.280394,0.288231,0.296069,0.303907,0.311744,0.319582,0.32745,0.335288,0.343125,0.350963,0.3588,0.366669,0.374506,0.382344,0.390182,0.398019,0.405857,0.413725,0.421563,0.4294,0.437238,0.445076,0.452944,0.460781,0.468619,0.476457,0.484294,0.492132,0.5],p=[29024,27392,25856,24384,23040,21696,20480,19328,18240,17216,16256,15360,14512,13696,12928,12192,11520,10848,10240,9664,9120,8608,8128,7680,7256,6848,
6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3628,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1814,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,227,214,202,190,180,169,160,151,142,134,127,120,113,107,101,95,90,85,80,75,71,67,63,60,57,53,50,48,45,42,40,38,36,34,32,30,28];window.neoart.F2Player=function(e){e=SBPlayer(e);Object.defineProperties(e,{id:{value:"F2Player"},patterns:{value:[],
writable:!0},instruments:{value:[],writable:!0},voices:{value:[],writable:!0},linear:{value:0,writable:!0},complete:{value:0,writable:!0},order:{value:0,writable:!0},position:{value:0,writable:!0},nextOrder:{value:0,writable:!0},nextPosition:{value:0,writable:!0},pattern:{value:null,writable:!0},patternDelay:{value:0,writable:!0},patternOffset:{value:0,writable:!0},timer:{value:0,writable:!0},initialize:{value:function(){var a=0,b;this.reset();this.timer=this.speed;this.position=this.order=0;this.nextPosition=
this.nextOrder=-1;this.complete=this.patternOffset=this.patternDelay=0;this.master=64;for(this.voices.length=this.channels;a<this.channels;++a)b=n(a),b.channel=this.mixer.channels[a],b.playing=this.instruments[0],b.sample=b.playing.samples[0],this.voices[a]=b,a&&(this.voices[a-1].next=b)}},loader:{value:function(d){var e,g,h,i,m,p,n,k=22,o,q;if(!(360>d.length)){d.position=17;this.title=d.readString(20);d.position++;g=d.readString(20);if("FastTracker v2.00   "==g)this.version=1;else if("Sk@le Tracker"==
g)this.version=k=2;else if("MadTracker 2.0"==g)this.version=3;else if("MilkyTracker        "==g)this.version=4;else if(-1!=g.indexOf("OpenMPT"))this.version=5;else return;d.readUshort();e=d.readUint();this.length=d.readUshort();this.restart=d.readUshort();this.channels=d.readUshort();q=o=d.readUshort();this.instruments=[];this.instruments.length=d.readUshort()+1;this.linear=d.readUshort();this.speed=d.readUshort();this.tempo=d.readUshort();this.track=new Uint8Array(this.length);for(g=0;g<this.length;++g)h=
d.readUbyte(),h>=q&&(o=h+1),this.track[g]=h;this.patterns=[];this.patterns.length=o;if(o!=q){i=c(64,this.channels);h=i.size;for(g=0;g<h;++g)i.rows[g]=a();this.patterns[--o]=i}d.position=n=e+60;p=q;for(g=0;g<p;++g){e=d.readUint();d.position++;i=c(d.readUshort(),this.channels);o=i.size;q=d.readUshort();d.position=n+e;m=d.position+q;if(q)for(h=0;h<o;++h)e=a(),q=d.readUbyte(),q&128?(q&1&&(e.note=d.readUbyte()),q&2&&(e.instrument=d.readUbyte()),q&4&&(e.volume=d.readUbyte()),q&8&&(e.effect=d.readUbyte()),
q&16&&(e.param=d.readUbyte())):(e.note=q,e.instrument=d.readUbyte(),e.volume=d.readUbyte(),e.effect=d.readUbyte(),e.param=d.readUbyte()),97!=e.note&&96<e.note&&(e.note=0),i.rows[h]=e;else for(h=0;h<o;++h)i.rows[h]=a();this.patterns[g]=i;n=d.position;n!=m&&(n=d.position=m)}m=d.position;p=this.instruments.length;for(g=1;g<p;++g){h=d.readUint();if(d.position+h>=d.length)break;i=j();i.name=d.readString(22);d.position++;q=d.readUshort();16<q&&(q=16);e=d.readUint();2==k&&64!=e&&(e=64);if(q){i.samples=[];
i.samples.length=q;for(h=0;96>h;++h)i.noteSamples[h]=d.readUbyte();for(h=0;12>h;++h)i.volData.points[h]=f(d.readUshort(),d.readUshort());for(h=0;12>h;++h)i.panData.points[h]=f(d.readUshort(),d.readUshort());i.volData.total=d.readUbyte();i.panData.total=d.readUbyte();i.volData.sustain=d.readUbyte();i.volData.loopStart=d.readUbyte();i.volData.loopEnd=d.readUbyte();i.panData.sustain=d.readUbyte();i.panData.loopStart=d.readUbyte();i.panData.loopEnd=d.readUbyte();i.volData.flags=d.readUbyte();i.panData.flags=
d.readUbyte();i.volData.flags&1&&(i.volEnabled=1);i.panData.flags&1&&(i.panEnabled=1);i.vibratoType=d.readUbyte();i.vibratoSweep=d.readUbyte();i.vibratoDepth=d.readUbyte();i.vibratoSpeed=d.readUbyte();i.fadeout=d.readUshort()<<1;d.position+=k;n=d.position;this.instruments[g]=i;for(h=0;h<q;++h)m=b(),m.length=d.readUint(),m.loopStart=d.readUint(),m.loopLen=d.readUint(),m.volume=d.readUbyte(),m.finetune=d.readByte(),m.loopMode=d.readUbyte(),m.panning=d.readUbyte(),m.relative=d.readByte(),d.position++,
m.name=d.readString(22),i.samples[h]=m,d.position=n+=e;for(h=0;h<q;++h)m=i.samples[h],m.length&&(n=d.position+m.length,m.loopMode&16&&(m.bits=16,m.loopMode^=16,m.length>>=1,m.loopStart>>=1,m.loopLen>>=1),m.loopLen||(m.loopMode=0),m.store(d),m.loopMode&&(m.length=m.loopStart+m.loopLen),d.position=n)}else d.position=m+h;m=d.position;if(m>=d.length)break}i=j();i.volData=l();i.panData=l();i.samples=[];for(g=0;12>g;++g)i.volData.points[g]=f(),i.panData.points[g]=f();m=b();m.length=220;m.data=new Float32Array(220);
for(g=0;220>g;++g)m.data[g]=0;i.samples[0]=m;this.instruments[0]=i}}},process:{value:function(){var a,b,c,e,g,f,i,j,k=this.voices[0];if(this.tick)for(;k;){f=this.pattern.rows[this.position+k.index];if(k.delay)if((f.param&15)==this.tick)k.flags=k.delay,k.delay=0;else{k=k.next;continue}if(f.volume)switch(b=f.volume>>4,c=f.volume&15,b){case 6:k.volume-=c;0>k.volume&&(k.volume=0);k.flags|=d;break;case 7:k.volume+=c;64<k.volume&&(k.volume=64);k.flags|=d;break;case 11:k.vibrato();break;case 13:k.panning-=
c;0>k.panning&&(k.panning=0);k.flags|=4;break;case 14:k.panning+=c;255<k.panning&&(k.panning=255);k.flags|=4;break;case 15:k.portaPeriod&&k.tonePortamento()}b=f.param>>4;c=f.param&15;switch(f.effect){case 0:if(!f.param)break;j=(this.tick-this.timer)%3;0>j&&(j+=3);2==this.tick&&18==this.timer&&(j=0);j?1==j?this.linear?k.arpDelta=-(c<<6):(j=this.amiga(k.note+c,k.finetune),k.arpDelta=j-k.period):this.linear?k.arpDelta=-(b<<6):(j=this.amiga(k.note+b,k.finetune),k.arpDelta=j-k.period):k.arpDelta=0;k.flags|=
h;break;case 1:k.period-=k.portaU;0>k.period&&(k.period=0);k.flags|=h;break;case 2:k.period+=k.portaD;9212<k.period&&(k.period=9212);k.flags|=h;break;case 3:k.portaPeriod&&k.tonePortamento();break;case 4:b&&(k.vibratoSpeed=b);c&&(k.vibratoDepth=c<<2);k.vibrato();break;case 5:g=1;k.portaPeriod&&k.tonePortamento();break;case 6:g=1;k.vibrato();break;case 7:k.tremolo();break;case 10:g=1;break;case 14:switch(b){case 9:0==this.tick%c&&(k.volEnvelope.reset(),k.panEnvelope.reset(),k.flags|=d|12);break;case 12:this.tick==
c&&(k.volume=0,k.flags|=d)}break;case 17:b=k.volSlideMaster>>4;c=k.volSlideMaster&15;b?(this.master+=b,64<this.master&&(this.master=64),k.flags|=d):c&&(this.master-=c,0>this.master&&(this.master=0),k.flags|=d);break;case 20:this.tick==f.param&&(k.fadeEnabled=1,k.keyoff=1);break;case 24:b=k.panSlide>>4;c=k.panSlide&15;b?(k.panning+=b,255<k.panning&&(k.panning=255),k.flags|=4):c&&(k.panning-=c,0>k.panning&&(k.panning=0),k.flags|=4);break;case 27:a=this.tick;f.volume||a++;if(a%k.retrigy)break;(!f.volume||
80<f.volume)&&k.retrigx&&this.retrig(k);k.flags|=8;break;case 29:k.tremor()}g&&(b=k.volSlide>>4,c=k.volSlide&15,g=0,b?(k.volume+=b,k.flags|=d):c&&(k.volume-=c,k.flags|=d));k=k.next}else{0<=this.nextOrder&&(this.order=this.nextOrder);0<=this.nextPosition&&(this.position=this.nextPosition);this.nextOrder=this.nextPosition=-1;for(this.pattern=this.patterns[this.track[this.order]];k;){f=this.pattern.rows[this.position+k.index];a=f.volume>>4;g=3==f.effect||5==f.effect||15==a;b=f.param>>4;k.keyoff=0;k.arpDelta&&
(k.arpDelta=0,k.flags|=h);if(f.instrument)k.instrument=f.instrument<this.instruments.length?this.instruments[f.instrument]:null,k.volEnvelope.reset(),k.panEnvelope.reset(),k.flags|=d|36;else if(97==f.note||20==f.effect&&!f.param)k.fadeEnabled=1,k.keyoff=1;f.note&&97!=f.note?k.instrument?(c=k.instrument,j=f.note-1,i=c.samples[c.noteSamples[j]],j+=i.relative,0<=j&&118>=j&&(g||(k.note=j,k.sample=i,f.instrument?(k.volEnabled=c.volEnabled,k.panEnabled=c.panEnabled,k.flags|=15):k.flags|=h|8),f.instrument?
(k.reset(),k.fadeDelta=c.fadeout):k.finetune=i.finetune>>3<<2,14==f.effect&&5==b&&(k.finetune=(f.param&15)-8<<3),j=this.linear?(120-j<<6)-k.finetune:this.amiga(j,k.finetune),g?k.portaPeriod=j:(k.period=j,k.glissPeriod=0))):(k.volume=0,k.flags=d|32):k.vibratoReset&&4!=f.effect&&6!=f.effect&&(k.vibDelta=0,k.vibratoReset=0,k.flags|=h);if(f.volume)if(16<=f.volume&&80>=f.volume)k.volume=f.volume-16,k.flags|=d|32;else switch(c=f.volume&15,a){case 6:k.volume-=c;0>k.volume&&(k.volume=0);k.flags|=d;break;
case 7:k.volume+=c;64<k.volume&&(k.volume=64);k.flags|=d;break;case 10:c&&(k.vibratoSpeed=c);break;case 11:c&&(k.vibratoDepth=c<<2);break;case 12:k.panning=c<<4;k.flags|=4;break;case 15:c&&(k.portaSpeed=c<<4)}if(f.effect)switch(c=f.param&15,f.effect){case 1:f.param&&(k.portaU=f.param<<2);break;case 2:f.param&&(k.portaD=f.param<<2);break;case 3:f.param&&15!=a&&(k.portaSpeed=f.param);break;case 4:k.vibratoReset=1;break;case 5:f.param&&(k.volSlide=f.param);break;case 6:f.param&&(k.volSlide=f.param);
k.vibratoReset=1;break;case 7:b&&(k.tremoloSpeed=b);c&&(k.tremoloDepth=c);break;case 8:k.panning=f.param;k.flags|=4;break;case 9:f.param&&(k.sampleOffset=f.param<<8);k.sampleOffset>=k.sample.length&&(k.volume=0,k.sampleOffset=0,k.flags&=~(h|8),k.flags|=d|32);break;case 10:f.param&&(k.volSlide=f.param);break;case 11:this.nextOrder=f.param;this.nextOrder>=this.length?this.complete=1:this.nextPosition=0;e=1;this.patternOffset=0;break;case 12:k.volume=f.param;k.flags|=d|32;break;case 13:this.nextPosition=
(10*b+c)*this.channels;this.patternOffset=0;e||(this.nextOrder=this.order+1,this.nextOrder>=this.length&&(this.complete=1,this.nextPosition=-1));break;case 14:switch(b){case 1:c&&(k.finePortaU=c<<2);k.period-=k.finePortaU;k.flags|=h;break;case 2:c&&(k.finePortaD=c<<2);k.period+=k.finePortaD;k.flags|=h;break;case 3:k.glissando=c;break;case 4:k.waveControl=k.waveControl&240|c;break;case 6:c?(k.patternLoop?k.patternLoop--:k.patternLoop=c,k.patternLoop&&(this.nextPosition=k.patternLoopRow)):k.patternLoopRow=
this.patternOffset=this.position;break;case 7:k.waveControl=k.waveControl&15|c<<4;break;case 10:c&&(k.fineSlideU=c);k.volume+=k.fineSlideU;k.flags|=d;break;case 11:c&&(k.fineSlideD=c);k.volume-=k.fineSlideD;k.flags|=d;break;case 13:k.delay=k.flags;k.flags=0;break;case 14:this.patternDelay=c*this.timer}break;case 15:if(!f.param)break;32>f.param?this.timer=f.param:this.mixer.samplesTick=2.5*this.sampleRate/f.param>>0;break;case 16:this.master=f.param;64<this.master&&(this.master=64);k.flags|=d;break;
case 17:f.param&&(k.volSlideMaster=f.param);break;case 21:if(!k.instrument||!k.instrument.volEnabled)break;c=k.instrument;j=f.param;b=c.volData.total;for(a=0;a<b&&!(j<c.volData.points[a].frame);a++);k.volEnvelope.position=--a;b--;c.volData.flags&4&&a==c.volData.loopEnd&&(a=k.volEnvelope.position=c.volData.loopStart,j=c.volData.points[a].frame,k.volEnvelope.frame=j);a>=b?(k.volEnvelope.value=c.volData.points[b].value,k.volEnvelope.stopped=1):(k.volEnvelope.stopped=0,k.volEnvelope.frame=j,j>c.volData.points[a].frame&&
k.volEnvelope.position++,b=c.volData.points[a],a=c.volData.points[++a],j=a.frame-b.frame,k.volEnvelope.delta=(j?(a.value-b.value<<8)/j>>0:0)||0,k.volEnvelope.fraction=b.value<<8);break;case 24:f.param&&(k.panSlide=f.param);break;case 27:b&&(k.retrigx=b);c&&(k.retrigy=c);if(!f.volume&&k.retrigy){a=this.tick+1;if(a%k.retrigy)break;80<f.volume&&k.retrigx&&this.retrig(k)}break;case 29:f.param&&(k.tremorOn=++b,k.tremorOff=++c+b);break;case 33:1==b?(c&&(k.xtraPortaU=c),k.period-=k.xtraPortaU,k.flags|=h):
2==b&&(c&&(k.xtraPortaD=c),k.period+=k.xtraPortaD,k.flags|=h)}k=k.next}}if(++this.tick>=this.timer+this.patternDelay&&(this.patternDelay=this.tick=0,0>this.nextPosition&&(this.nextPosition=this.position+this.channels,this.nextPosition>=this.pattern.size||this.complete)))this.nextOrder=this.order+1,this.nextPosition=this.patternOffset,this.nextOrder>=this.length&&(this.nextOrder=this.restart,this.mixer.complete=1)}},fast:{value:function(){for(var a,c,b,e,f,g=this.voices[0],i;g;)a=g.channel,b=g.flags,
g.flags=0,b&8&&(a.index=g.sampleOffset,a.pointer=-1,a.dir=0,a.fraction=0,a.sample=g.sample,a.length=g.sample.length,a.enabled=a.sample.data?1:0,g.playing=g.instrument,g.sampleOffset=0),e=g.playing,c=e.vibratoSpeed?g.autoVibrato():0,i=g.volume+g.volDelta,e.volEnabled?(g.volEnabled&&!g.volEnvelope.stopped&&this.envelope(g,g.volEnvelope,e.volData),i=i*g.volEnvelope.value>>6,b|=d,g.fadeEnabled&&(g.fadeVolume-=g.fadeDelta,0>g.fadeVolume?(i=0,g.fadeVolume=0,g.fadeEnabled=0,g.volEnvelope.value=0,g.volEnvelope.stopped=
1,g.panEnvelope.stopped=1):i=i*g.fadeVolume>>16)):g.keyoff&&(i=0,b|=d),f=g.panning,e.panEnabled&&(g.panEnabled&&!g.panEnvelope.stopped&&this.envelope(g,g.panEnvelope,e.panData),f=g.panEnvelope.value<<2,b|=4,0>f?f=0:255<f&&(f=255)),b&d&&(0>i?i=0:64<i&&(i=64),a.volume=m[i*this.master>>6],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),b&4&&(a.panning=f,a.lpan=q[256-f],a.rpan=q[f],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),b&h&&(c+=g.period+g.arpDelta+g.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,
(4608-c)/768)/this.sampleRate>>0)/65536:(65536*(14317456/c)/this.sampleRate>>0)/65536,a.delta=a.speed>>0,a.speed-=a.delta),g=g.next}},accurate:{value:function(){for(var a,c,b,e,f,g,i,j=this.voices[0];j;)a=j.channel,b=j.flags,j.flags=0,b&8&&(a.sample&&(b|=32,a.mixCounter=220,a.oldSample=null,a.oldPointer=-1,a.enabled&&(a.oldDir=a.dir,a.oldFraction=a.fraction,a.oldSpeed=a.speed,a.oldSample=a.sample,a.oldPointer=a.pointer,a.oldLength=a.length,a.lmixRampD=a.lvol,a.lmixDeltaD=a.lvol/220,a.rmixRampD=a.rvol,
a.rmixDeltaD=a.rvol/220)),a.dir=1,a.fraction=0,a.sample=j.sample,a.pointer=j.sampleOffset,a.length=j.sample.length,a.enabled=a.sample.data?1:0,j.playing=j.instrument,j.sampleOffset=0),e=j.playing,c=e.vibratoSpeed?j.autoVibrato():0,f=j.volume+j.volDelta,e.volEnabled?(j.volEnabled&&!j.volEnvelope.stopped&&this.envelope(j,j.volEnvelope,e.volData),f=f*j.volEnvelope.value>>6,b|=d,j.fadeEnabled&&(j.fadeVolume-=j.fadeDelta,0>j.fadeVolume?(f=0,j.fadeVolume=0,j.fadeEnabled=0,j.volEnvelope.value=0,j.volEnvelope.stopped=
1,j.panEnvelope.stopped=1):f=f*j.fadeVolume>>16)):j.keyoff&&(f=0,b|=d),g=j.panning,e.panEnabled&&(j.panEnabled&&!j.panEnvelope.stopped&&this.envelope(j,j.panEnvelope,e.panData),g=j.panEnvelope.value<<2,b|=4,0>g?g=0:255<g&&(g=255)),a.enabled?(b&d&&(0>f?f=0:64<f&&(f=64),f=m[f*this.master>>6],e=f*q[256-g],i=f*q[g],f!=a.volume&&!a.mixCounter?(a.volCounter=b&32?220:this.mixer.samplesTick,a.lvolDelta=(e-a.lvol)/a.volCounter,a.rvolDelta=(i-a.rvol)/a.volCounter):(a.lvol=e,a.rvol=i),a.volume=f),b&4&&(f=q[256-
g],e=q[g],g!=a.panning&&!a.mixCounter&&!a.volCounter?(a.panCounter=this.mixer.samplesTick,a.lpanDelta=(f-a.lpan)/a.panCounter,a.rpanDelta=(e-a.rpan)/a.panCounter):(a.lpan=f,a.rpan=e),a.panning=g),b&h&&(c+=j.period+j.arpDelta+j.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-c)/768)/this.sampleRate>>0)/65536:(65536*(14317456/c)/this.sampleRate>>0)/65536),a.mixCounter&&(a.lmixRampU=0,a.lmixDeltaU=a.lvol/220,a.rmixRampU=0,a.rmixDeltaU=a.rvol/220)):(a.volCounter=0,a.panCounter=0),j=j.next}},
envelope:{value:function(a,b,c){var d=b.position,e=c.points[d];if(b.frame==e.frame){c.flags&4&&d==c.loopEnd&&(d=b.position=c.loopStart,e=c.points[d],b.frame=e.frame);if(d==c.total-1){b.value=e.value;b.stopped=1;return}if(c.flags&2&&d==c.sustain&&!a.fadeEnabled){b.value=e.value;return}b.position++;a=c.points[b.position];b.delta=(a.value-e.value<<8)/(a.frame-e.frame)>>0||0;b.fraction=e.value<<8}else b.fraction+=b.delta;b.value=b.fraction>>8;b.frame++}},amiga:{value:function(a,b){var c=0,d=p[++a];0>
b?c=(p[--a]-d)/64:0<b&&(c=(d-p[++a])/64);return d-c*b>>0}},retrig:{value:function(a){switch(a.retrigx){case 1:a.volume--;break;case 2:a.volume++;break;case 3:a.volume-=4;break;case 4:a.volume-=8;break;case 5:a.volume-=16;break;case 6:a.volume=(a.volume<<1)/3;break;case 7:a.volume>>=1;break;case 8:a.volume=a.sample.volume;break;case 9:a.volume++;break;case 10:a.volume+=2;break;case 11:a.volume+=4;break;case 12:a.volume+=8;break;case 13:a.volume+=16;break;case 14:a.volume=3*a.volume>>1;break;case 15:a.volume<<=
1}0>a.volume?a.volume=0:64<a.volume&&(a.volume=64);a.flags|=d}}});return Object.seal(e)}})();
