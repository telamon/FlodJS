function ZipFile(p){function m(a){var c=Object.create(null,{count:{value:null,writable:!0},symbol:{value:null,writable:!0}});c.count=new Uint16Array(a);c.symbol=new Uint16Array(a);return Object.seal(c)}function i(){var e=Object.create(null,{output:{value:null,writable:!0},inpbuf:{value:null,writable:!0},inpcnt:{value:0,writable:!0},outcnt:{value:0,writable:!0},bitbuf:{value:0,writable:!0},bitcnt:{value:0,writable:!0},flencode:{value:null,writable:!0},fdiscode:{value:null,writable:!0},dlencode:{value:null,
writable:!0},ddiscode:{value:null,writable:!0},input:{set:function(a){this.inpbuf=a[0];this.inpbuf.endian=a[2];this.inpcnt=this.inpbuf.position=0;this.output=ByteArray(new ArrayBuffer(a[1]));this.output.endian=a[2];this.outcnt=this.output.position=0}},inflate:{value:function(){var a,c;do if(c=this.bits(1),a=this.bits(2),a=0==a?this.stored():1==a?this.codes(this.flencode,this.fdiscode):2==a?this.dynamic():1)throw b;while(!c)}},initialize:{value:function(){var a=new Uint8Array(288),c=0;this.flencode=
m(288);for(this.fdiscode=m(30);144>c;++c)a[c]=8;for(;256>c;++c)a[c]=9;for(;280>c;++c)a[c]=7;for(;288>c;++c)a[c]=8;this.construct(this.fdiscode,a,288);for(c=0;30>c;++c)a[c]=5;this.construct(this.fdiscode,a,30);this.dlencode=m(286);this.ddiscode=m(30)}},construct:{value:function(a,c,d){for(var b=0,j=1,g=new Uint16Array(16),h=0;16>b;++b)a.count[b]=0;for(;h<d;++h)a.count[c[h]]++;if(a.count[0]==d)return 0;for(b=1;16>b;++b)if(j<<=1,j-=a.count[b],0>j)return j;for(b=1;15>b;++b)g[b+1]=g[b]+a.count[b];for(h=
0;h<d;++h)0!=c[h]&&(a.symbol[g[c[h]]++]=h);return j}},bits:{value:function(a){for(var c=this.bitbuf,d=this.inpbuf.length;this.bitcnt<a;){if(this.inpcnt==d)throw f;c|=this.inpbuf.readAt(this.inpcnt++)<<this.bitcnt;this.bitcnt+=8}this.bitbuf=c>>a;this.bitcnt-=a;return c&(1<<a)-1}},codes:{value:function(c,d){var b,j,g;do{g=this.decode(c);if(0>g)return g;if(256>g)this.output.writeAt(this.outcnt++,g);else if(256<g){g-=257;if(29<=g)throw ERRRO7;j=o[g]+this.bits(n[g]);g=this.decode(d);if(0>g)return g;b=
r[g]+this.bits(s[g]);if(b>this.outcnt)throw a;for(b=this.outcnt-b;j--;)this.output.writeAt(this.outcnt++,this.output.readAt(b++))}}while(256!=g);return 0}},decode:{value:function(a){for(var c=this.bitbuf,d=0,b,j=0,g=0,h=this.inpbuf.length,e=this.bitcnt,i=1;;){for(;e--;){d|=c&1;c>>=1;b=a.count[i];if(d<j+b)return this.bitbuf=c,this.bitcnt=this.bitcnt-i&7,a.symbol[g+(d-j)];g+=b;j+=b;j<<=1;d<<=1;++i}e=16-i;if(!e)break;if(this.inpcnt==h)throw f;c=this.inpbuf.readAt(this.inpcnt++);8<e&&(e=8)}return-9}},
stored:{value:function(){var a=this.inpbuf.length,d;this.bitbuf=this.bitcnt=0;if(this.inpcnt+4>a)throw f;d=this.inpbuf.readAt(this.inpcnt++);d|=this.inpbuf.readAt(this.inpcnt++)<<8;if(this.inpbuf.readAt(this.inpcnt++)!=(~d&255)||this.inpbuf.readAt(this.inpcnt++)!=(~d>>8&255))throw c;if(this.inpcnt+d>a)throw f;for(;d--;)this.output.writeAt(this.outcnt++,this.inpbuf.readAt(this.inpcnt++));return 0}},dynamic:{value:function(){var a=new Uint8Array(316),c;c=0;var b,f=this.bits(5)+257,e=this.bits(5)+1;
b=this.bits(4)+4;var i=f+e,r;if(286<f||30<e)throw j;for(;c<b;++c)a[u[c]]=this.bits(3);for(;19>c;++c)a[u[c]]=0;if(c=this.construct(this.dlencode,a,19))throw d;for(c=0;c<i;)if(r=this.decode(this.dlencode),16>r)a[c++]=r;else{b=0;if(16==r){if(0==c)throw g;b=a[c-1];r=3+this.bits(2)}else r=17==r?3+this.bits(3):11+this.bits(7);if(c+r>i)throw h;for(;r--;)a[c++]=b}c=this.construct(this.dlencode,a,f);if(0>c||0<c&&1!=f-this.dlencode.count[0])throw q;c=this.construct(this.ddiscode,a.subarray(f),e);if(0>c||0<
c&&1!=e-this.ddiscode.count[0])throw l;return this.codes(this.dlencode,this.ddiscode)}}});e.initialize();return Object.seal(e)}function e(){return Object.create(null,{name:{value:"",writable:!0},extra:{value:null,writable:!0},version:{value:0,writable:!0},flag:{value:0,writable:!0},method:{value:0,writable:!0},time:{value:0,writable:!0},crc:{value:0,writable:!0},compressed:{value:0,writable:!0},size:{value:0,writable:!0},offset:{value:0,writable:!0},date:{get:function(){return new Date((this.time>>
25&127)+1980,(this.time>>21&15)-1,this.time>>16&31,this.time>>11&31,this.time>>5&63,(this.time&31)<<1)}},isDirectory:{get:function(){return"/"==this.name.charAt(this.name.length-1)}}})}if(!p)return null;var b="Invalid block type.",f="Available inflate data did not terminate.",a="Distance is too far back.",c="Stored block length did not match one's complement.",j="Too many length or distance codes.",d="Code lengths codes incomplete.",g="Repeat lengths with no first length.",h="Repeat more than specified lengths.",
q="Invalid literal/length code lengths.",l="Invalid distance code lengths.",o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],n=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],t=Object.create(null,{endian:{value:1,
writable:!0},entries:{value:null,writable:!0},stream:{value:null,writable:!0},uncompress:{value:function(a){var c=this.stream,d;if(!a)return null;c.position=a.offset+28;d=c.readUshort();c.position=30+a.name.length+d;if(a.compressed)switch(d=ByteArray(new ArrayBuffer(a.compressed),this.endian),c.readBytes(d,0,a.compressed),a.method){case 0:return d;case 8:return c=i(),c.input=[d,a.size,this.endian],c.inflate(),c.output;default:throw"Compression method not supported.";}}},parseCentral:{value:function(){for(var a=
this.stream,c,d=ByteArray(new ArrayBuffer(46),this.endian),b=0,j=this.entries.length,g;b<j;++b){a.readBytes(d,0,46);if(33639248!=d.readUint())throw"Unexpected end of archive.";d.position+=24;g=d.readUshort();if(!g)throw"Unexpected end of archive.";c=e();c.name=a.readString(g);if(g=d.readUshort())c.extra=ByteArray(new ArrayBuffer(g),this.endian),a.readBytes(c.extra,0,g);a.position+=d.readUshort();d.position=6;c.version=d.readUshort();c.flag=d.readUshort();if(1==(c.flag&1))throw"Encrypted archive not supported.";
c.method=d.readUshort();c.time=d.readUint();c.crc=d.readUint();c.compressed=d.readUint();c.size=d.readUint();d.position=42;c.offset=d.readUint();Object.freeze(c);this.entries[b]=c}}},parseEnd:{value:function(){var a=this.stream,c=a.length-22,d=c-65536;0>d&&(d=0);do if(80==a.readAt(c)&&(a.position=c,101010256==a.readUint()))break;while(--c>d);if(c==d)throw"The archive is either in unknown format or damaged.";a.position=c+10;this.entries=[];this.entries.length=a.readUshort();a.position=c+16;a.position=
a.readUint();this.parseCentral()}}});p.view||(p=ByteArray(p));p.endian=1;p.position=0;t.stream=p;t.parseEnd();return Object.seal(t)}window.neoart.Unzip=1;
function AmigaChannel(p){var m=Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},panning:{value:0,writable:!0},delay:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},audena:{value:0,writable:!0},audcnt:{value:0,writable:!0},audloc:{value:0,writable:!0},audper:{value:0,writable:!0},audvol:{value:0,writable:!0},timer:{value:0,writable:!0},level:{value:0,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},enabled:{get:function(){return this.audena},
set:function(i){i!=this.audena&&(this.audena=i,this.audloc=this.pointer,this.audcnt=this.pointer+this.length,this.timer=1,i&&(this.delay+=2))}},period:{set:function(i){if(1>i||65535<i)i=65535;this.audper=i}},volume:{set:function(i){0>i?i=0:64<i&&(i=64);this.audvol=i}},initialize:{value:function(){this.audloc=this.audcnt=this.audena=0;this.audper=50;this.length=this.pointer=this.delay=this.rdata=this.ldata=this.timer=this.audvol=0}},resetData:{value:function(){this.rdata=this.ldata=0}}});m.panning=
m.level=0==(++p&2)?-1:1;return Object.seal(m)}
function AmigaFilter(){return Object.create(null,{active:{value:0,writable:!0},forced:{value:-1,writable:!0},l0:{value:0,writable:!0},l1:{value:0,writable:!0},l2:{value:0,writable:!0},l3:{value:0,writable:!0},l4:{value:0,writable:!0},r0:{value:0,writable:!0},r1:{value:0,writable:!0},r2:{value:0,writable:!0},r3:{value:0,writable:!0},r4:{value:0,writable:!0},initialize:{value:function(){this.r0=this.r1=this.r2=this.r3=this.r4=this.l0=this.l1=this.l2=this.l3=this.l4=0}},process:{value:function(p,m){var i=
0.5139651662784244;0==p&&(this.l0=0.4860348337215757*m.l+i*this.l0,this.r0=0.4860348337215757*m.r+i*this.r0,i=0.06850445132502514,m.l=this.l1=0.9314955486749749*this.l0+i*this.l1,m.r=this.r1=0.9314955486749749*this.r0+i*this.r1);0<(this.active|this.forced)&&(i=0.47866541564678,this.l2=0.52133458435322*m.l+i*this.l2,this.r2=0.52133458435322*m.r+i*this.r2,this.l3=0.52133458435322*this.l2+i*this.l3,this.r3=0.52133458435322*this.r2+i*this.r3,m.l=this.l4=0.52133458435322*this.l3+i*this.l4,m.r=this.r4=
0.52133458435322*this.r3+i*this.r4);1<m.l?m.l=1:-1>m.l&&(m.l=-1);1<m.r?m.r=1:-1>m.r&&(m.r=-1)}}})}function AmigaRow(){return Object.create(null,{note:{value:0,writable:!0},sample:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}
function AmigaSample(){return Object.create(null,{name:{value:"",writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},repeat:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0}})}function AmigaStep(){return Object.create(null,{pattern:{value:0,writable:!0},transpose:{value:0,writable:!0}})}
function Amiga(){var p=CoreMixer();Object.defineProperties(p,{filter:{value:null,writable:!0},model:{value:1,writable:!0},memory:{value:[],writable:!0},loopPtr:{value:0,writable:!0},loopLen:{value:4,writable:!0},clock:{value:0,writable:!0},master:{value:0,writable:!0},ready:{value:0,writable:!0},volume:{set:function(m){0<m?(64<m&&(m=64),this.master=0.00390625*(m/64)):this.master=0}},initialize:{value:function(){var m=this.memory.length,i=m+this.loopLen;this.reset();this.filter.initialize();if(!this.ready){this.ready=
1;for(this.loopPtr=m;m<i;++m)this.memory[m]=0}}},restore:{value:function(){this.ready=0;this.memory.length=0}},store:{value:function(m,i,e){var b,f,a=m.position,c=this.memory.length;e&&(m.position=e);f=m.position+i;f>=m.length&&(b=f-m.length,i=m.length-m.position);for(f=c,i+=c;f<i;++f)this.memory[f]=m.readByte();for(i+=b;f<i;++f)this.memory[f]=0;e&&(m.position=a);return c}},fast:{value:function(m){var i,e,b=this.memory,f,a=0,c,j=0,d,g,h=this.bufferSize,q,l,o;if(this.completed){if(!this.remains){this.player.stop();
return}h=this.remains}for(;a<h;){this.samplesLeft||(this.player.process(),this.samplesLeft=this.samplesTick,this.completed&&(h=a+this.samplesTick,h>this.bufferSize&&(this.remains=h-this.bufferSize,h=this.bufferSize)));l=this.samplesLeft;a+l>=h&&(l=h-a);c=j+l;for(i=this.channels[0];i;){g=this.buffer[j];if(i.audena){q=i.audper/this.clock;o=i.audvol*this.master;f=o*(1-i.level);d=o*(1+i.level);for(e=j;e<c;++e)i.delay?i.delay--:1>--i.timer&&(i.mute||(o=0.0078125*b[i.audloc],i.ldata=o*f,i.rdata=o*d),i.audloc++,
i.timer+=q,i.audloc>=i.audcnt&&(i.audloc=i.pointer,i.audcnt=i.pointer+i.length)),g.l+=i.ldata,g.r+=i.rdata,g=g.next}else for(e=j;e<c;++e)g.l+=i.ldata,g.r+=i.rdata,g=g.next;i=i.next}j=c;a+=l;this.samplesLeft-=l}o=this.model;b=this.filter;g=this.buffer[0];i=m.outputBuffer.getChannelData(0);m=m.outputBuffer.getChannelData(1);for(e=0;e<h;++e)b.process(o,g),i[e]=g.l,m[e]=g.r,g.l=g.r=0,g=g.next}}});p.channels[0]=AmigaChannel(0);p.channels[0].next=p.channels[1]=AmigaChannel(1);p.channels[1].next=p.channels[2]=
AmigaChannel(2);p.channels[2].next=p.channels[3]=AmigaChannel(3);p.bufferSize=8192;p.filter=AmigaFilter();p.master=0.00390625;return Object.seal(p)}
function AmigaPlayer(p){var m=CorePlayer();Object.defineProperties(m,{quality:{set:function(){this.callback=this.mixer.fast.bind(this.mixer)}},stereo:{set:function(i){var e=this.mixer.channels[0];for(0>i?i=0:1<i&&(i=1);e;)e.level=i*e.panning,e=e.next}},volume:{set:function(i){0>i?i=0:1<i&&(i=1);this.mixer.master=0.00390625*i}},frequency:{value:function(i){i?(this.mixer.clock=3579545/this.sampleRate,this.mixer.samplesTick=735):(this.mixer.clock=3546895/this.sampleRate,this.mixer.samplesTick=882)}}});
m.mixer=p||Amiga();m.mixer.player=m;m.frequency(0);m.channels=4;m.endian=0;m.quality=0;m.speed=6;m.tempo=125;return m}
function SBChannel(){return Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},enabled:{value:0,writable:!0},sample:{value:null,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},pointer:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},speed:{value:0,writable:!0},dir:{value:0,writable:!0},oldSample:{value:null,writable:!0},oldLength:{value:0,writable:!0},oldPointer:{value:0,writable:!0},oldFraction:{value:0,writable:!0},
oldSpeed:{value:0,writable:!0},oldDir:{value:0,writable:!0},volume:{value:0,writable:!0},lvol:{value:0,writable:!0},rvol:{value:0,writable:!0},panning:{value:128,writable:!0},lpan:{value:0.5,writable:!0},rpan:{value:0.5,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},mixCounter:{value:0,writable:!0},lmixRampU:{value:0,writable:!0},lmixDeltaU:{value:0,writable:!0},rmixRampU:{value:0,writable:!0},rmixDeltaU:{value:0,writable:!0},lmixRampD:{value:0,writable:!0},lmixDeltaD:{value:0,
writable:!0},rmixRampD:{value:0,writable:!0},rmixDeltaD:{value:0,writable:!0},volCounter:{value:0,writable:!0},lvolDelta:{value:0,writable:!0},rvolDelta:{value:0,writable:!0},panCounter:{value:0,writable:!0},lpanDelta:{value:0,writable:!0},rpanDelta:{value:0,writable:!0},initialize:{value:function(){this.enabled=0;this.sample=null;this.dir=this.speed=this.fraction=this.delta=this.pointer=this.index=this.length=0;this.oldSample=null;this.rvol=this.lvol=this.volume=this.oldDir=this.oldSpeed=this.oldFraction=
this.oldPointer=this.oldLength=0;this.panning=128;this.rpan=this.lpan=0.5;this.rpanDelta=this.lpanDelta=this.panCounter=this.rvolDelta=this.lvolDelta=this.volCounter=this.rmixDeltaD=this.rmixRampD=this.lmixDeltaD=this.lmixRampD=this.rmixDeltaU=this.rmixRampU=this.lmixDeltaU=this.lmixRampU=this.mixCounter=this.rdata=this.ldata=0}}})}
function SBSample(){return Object.create(null,{name:{value:"",writable:!0},bits:{value:8,writable:!0},volume:{value:0,writable:!0},length:{value:0,writable:!0},data:{value:[],writable:!0},loopMode:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopLen:{value:0,writable:!0},store:{value:function(p){var m=0,i,e=this.length,b;this.loopLen||(this.loopMode=0);b=p.position;this.loopMode?(e=this.loopStart+this.loopLen,this.data=new Float32Array(e+1)):this.data=new Float32Array(this.length+1);if(8==
this.bits){b+e>p.length&&(e=p.length-b);for(i=0;i<e;i++)m=p.readByte()+m,-128>m?m+=256:127<m&&(m-=256),this.data[i]=0.0078125*m}else{b+(e<<1)>p.length&&(e=p.length-b>>1);for(i=0;i<e;i++)m=p.readShort()+m,-32768>m?m+=65536:32767<m&&(m-=65536),this.data[i]=3.051758E-5*m}m=b+length;this.loopMode?(this.length=this.loopStart+this.loopLen,this.data[e]=1==this.loopMode?this.data[this.loopStart]:this.data[e-1]):this.data[this.length]=0;if(e!=this.length){b=this.data[e-1];for(i=e;i<this.length;i++)this.data[i]=
b}p.position=m<p.length?m:p.length-1}}})}
function Soundblaster(){var p=CoreMixer();Object.defineProperties(p,{setup:{value:function(m){var i=1;this.channels.length=m;for(this.channels[0]=SBChannel();i<m;++i)this.channels[i]=this.channels[i-1].next=SBChannel()}},initialize:{value:function(){this.reset()}},fast:{value:function(m){var i,e,b,f=0,a,c=0,j,d,g=this.bufferSize,h,q;if(this.completed){if(!this.remains){this.player.stop();return}g=this.remains}for(;f<g;){this.samplesLeft||(this.player.process(),this.player.fast(),this.samplesLeft=
this.samplesTick,this.completed&&(g=f+this.samplesTick,g>this.bufferSize&&(this.remains=g-this.bufferSize,g=this.bufferSize)));h=this.samplesLeft;f+h>=g&&(h=g-f);a=c+h;for(i=this.channels[0];i;){if(i.enabled){j=i.sample;e=j.data;d=this.buffer[c];for(b=c;b<a;++b){if(i.index!=i.pointer){if(i.index>=i.length)if(j.loopMode)i.pointer=j.loopStart+(i.index-i.length),i.length=j.length,2==j.loopMode&&(i.dir=i.dir?0:j.length+j.loopStart-1);else{i.enabled=0;break}else i.pointer=i.index;i.mute?(i.ldata=0,i.rdata=
0):(q=i.dir?e[i.dir-i.pointer]:e[i.pointer],i.ldata=q*i.lvol,i.rdata=q*i.rvol)}i.index=i.pointer+i.delta;if(1<=(i.fraction+=i.speed))i.index++,i.fraction--;d.l+=i.ldata;d.r+=i.rdata;d=d.next}}i=i.next}c=a;f+=h;this.samplesLeft-=h}d=this.buffer[0];i=m.outputBuffer.getChannelData(0);m=m.outputBuffer.getChannelData(1);for(b=0;b<g;++b)1<d.l?d.l=1:-1>d.l&&(d.l=-1),1<d.r?d.r=1:-1>d.r&&(d.r=-1),i[b]=d.l,m[b]=d.r,d.l=d.r=0,d=d.next}},accurate:{value:function(m){var i,e,b,f,a,c=0,j,d=0,g,h,q,l,o=this.bufferSize,
n,r;if(this.completed){if(!this.remains){this.player.stop();return}o=this.remains}for(;c<o;){this.samplesLeft||(this.player.process(),this.player.accurate(),this.samplesLeft=this.samplesTick,this.completed&&(o=c+this.samplesTick,o>this.bufferSize&&(this.remains=o-this.bufferSize,o=this.bufferSize)));n=this.samplesLeft;c+n>=o&&(n=o-c);j=d+n;for(i=this.channels[0];i;){if(i.enabled){h=i.sample;e=h.data;if(q=i.oldSample)b=q.data;l=this.buffer[d];for(a=d;a<j;++a){r=i.mute?0:e[i.pointer];r+=(e[i.pointer+
i.dir]-r)*i.fraction;if(1<=(i.fraction+=i.speed))f=i.fraction>>0,i.fraction-=f,0<i.dir?(i.pointer+=f,i.pointer>i.length&&(i.fraction+=i.pointer-i.length,i.pointer=i.length)):(i.pointer-=f,i.pointer<i.length&&(i.fraction+=i.length-i.pointer,i.pointer=i.length));if(i.mixCounter){if(q){g=i.mute?0:b[i.oldPointer];g+=(b[i.oldPointer+i.oldDir]-g)*i.oldFraction;if(1<(i.oldFraction+=i.oldSpeed))f=i.oldFraction>>0,i.oldFraction-=f,0<i.oldDir?(i.oldPointer+=f,i.oldPointer>i.oldLength&&(i.oldFraction+=i.oldPointer-
i.oldLength,i.oldPointer=i.oldLength)):(i.oldPointer-=f,i.oldPointer<i.oldLength&&(i.oldFraction+=i.oldLength-i.oldPointer,i.oldPointer=i.oldLength));l.l+=r*i.lmixRampU+g*i.lmixRampD;l.r+=r*i.rmixRampU+g*i.rmixRampD;i.lmixRampD-=i.lmixDeltaD;i.rmixRampD-=i.rmixDeltaD}else l.l+=r*i.lmixRampU,l.r+=r*i.rmixRampU;i.lmixRampU+=i.lmixDeltaU;i.rmixRampU+=i.rmixDeltaU;i.mixCounter--;i.oldPointer==i.oldLength&&(q.loopMode?1==q.loopMode?(i.oldPointer=q.loopStart,i.oldLength=q.length):0<i.oldDir?(i.oldPointer=
q.length-1,i.oldLength=q.loopStart,i.oldDir=-1):(i.oldFraction-=1,i.oldPointer=q.loopStart,i.oldLength=q.length,i.oldDir=1):(q=null,i.oldPointer=0))}else l.l+=r*i.lvol,l.r+=r*i.rvol,i.volCounter?(i.lvol+=i.lvolDelta,i.rvol+=i.rvolDelta,i.volCounter--):i.panCounter&&(i.lpan+=i.lpanDelta,i.rpan+=i.rpanDelta,i.panCounter--,i.lvol=i.volume*i.lpan,i.rvol=i.volume*i.rpan);if(i.pointer==i.length)if(h.loopMode)1==h.loopMode?(i.pointer=h.loopStart,i.length=h.length):0<i.dir?(i.pointer=h.length-1,i.length=
h.loopStart,i.dir=-1):(i.fraction-=1,i.pointer=h.loopStart,i.length=h.length,i.dir=1);else{i.enabled=0;break}l=l.next}}i=i.next}d=j;c+=n;this.samplesLeft-=n}l=this.buffer[0];i=m.outputBuffer.getChannelData(0);m=m.outputBuffer.getChannelData(1);for(a=0;a<o;++a)1<l.l?l.l=1:-1>l.l&&(l.l=-1),1<l.r?l.r=1:-1>l.r&&(l.r=-1),i[a]=l.l,m[a]=l.r,l.l=l.r=0,l=l.next}}});p.bufferSize=8192;return Object.seal(p)}
function SBPlayer(p){var m=CorePlayer();Object.defineProperties(m,{track:{value:null,writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},timer:{value:0,writable:!0},master:{value:0,writable:!0},setup:{configurable:!1,value:function(){this.mixer.setup(this.channels)}}});m.mixer=p||Soundblaster();m.mixer.player=m;m.endian=1;m.quality=1;return m}
(function(){var p="Unknown Format,Ultimate SoundTracker,D.O.C. SoundTracker 9,Master SoundTracker,D.O.C. SoundTracker 2.0/2.2,SoundTracker 2.3,SoundTracker 2.4,NoiseTracker 1.0,NoiseTracker 1.1,NoiseTracker 2.0,ProTracker 1.0,ProTracker 1.1/2.1,ProTracker 1.2/2.0,His Master's NoiseTracker,SoundFX 1.0/1.7,SoundFX 1.8,SoundFX 1.945,SoundFX 1.994/2.0,BP SoundMon V1,BP SoundMon V2,BP SoundMon V3,Delta Music 1.0,Delta Music 2.0,Digital Mugician,Digital Mugician 7 Voices,Future Composer 1.0/1.3,Future Composer 1.4,SidMon 1.0,SidMon 2.0,FastTracker II,Sk@leTracker,MadTracker 2.0,MilkyTracker,OpenMPT".split(",");window.neoart.FileLoader=
function(){var m=Object.create(null,{player:{value:null,writable:!0},index:{value:0,writable:!0},amiga:{value:null,writable:!0},mixer:{value:null,writable:!0},tracker:{get:function(){return this.player?p[this.index+this.player.version]:""}},load:{value:function(i){var e;i.view||(i=ByteArray(i));i.endian=1;i.position=0;if(67324752==i.readUint())if(window.neoart.Unzip)i=ZipFile(i),i=i.uncompress(i.entries[0]);else throw"Unzip support is not available.";if(this.player&&"STPlayer"!=this.player.id&&(this.player.load(i),
this.player.version))return player;if(336<i.length&&(i.position=38,e=i.readString(20),"FastTracker v2.00   "==e||"Sk@le Tracker"==e||"MadTracker 2.0"==e||"MilkyTracker        "==e||-1!=e.indexOf("OpenMPT")))if(this.player=window.neoart.F2Player(this.mixer),this.player.load(i),this.player.version)return this.index=28,this.player;if(2149<i.length)if(i.position=1080,e=i.readString(4),"M.K."==e||"FLT4"==e){if(this.player=window.neoart.MKPlayer(this.amiga),this.player.load(i),this.player.version)return this.index=
4,this.player}else if("FEST"==e&&(this.player=window.neoart.HMPlayer(this.amiga),this.player.load(i),this.player.version))return this.index=12,this.player;if(2149<i.length&&(i.position=1080,e=i.readString(4),"M.K."==e||"M!K!"==e))if(this.player=window.neoart.PTPlayer(this.amiga),this.player.load(i),this.player.version)return this.index=9,this.player;if(1685<i.length&&(i.position=60,e=i.readString(4),"SONG"!=e&&(i.position=124,e=i.readString(4)),"SONG"==e||"SO31"==e))if(this.player=window.neoart.FXPlayer(this.amiga),
this.player.load(i),this.player.version)return this.index=13,this.player;if(4<i.length&&(i.position=0,e=i.readString(4),"ALL "==e&&(this.player=window.neoart.D1Player(this.amiga),this.player.load(i),this.player.version))||3018<i.length&&(i.position=3014,e=i.readString(4),".FNL"==e&&(this.player=window.neoart.D2Player(this.amiga),this.player.load(i),this.player.version)))return this.index=20,this.player;if(30<i.length&&(i.position=26,e=i.readString(3),"BPS"==e||"V.2"==e||"V.3"==e))if(this.player=window.neoart.BPPlayer(this.amiga),
this.player.load(i),this.player.version)return this.index=17,this.player;if(4<i.length&&(i.position=0,e=i.readString(4),"SMOD"==e||"FC14"==e))if(this.player=window.neoart.FCPlayer(this.amiga),this.player.load(i),this.player.version)return this.index=24,this.player;if(10<i.length&&(i.position=0,e=i.readString(9)," MUGICIAN"==e&&(this.player=window.neoart.DMPlayer(this.amiga),this.player.load(i),this.player.version)))return this.index=22,this.player;if(86<i.length&&(i.position=58,e=i.readString(28),
"SIDMON II - THE MIDI VERSION"==e&&(this.player=window.neoart.S2Player(this.amiga),this.player.load(i),this.player.version)))return this.index=26,this.player;if(5220<i.length&&(this.player=window.neoart.S1Player(this.amiga),this.player.load(i),this.player.version))return this.index=26,this.player;if(1625<i.length&&(this.player=window.neoart.STPlayer(this.amiga),this.player.load(i),this.player.version))return this.index=0,this.player;this.player=window.neoart.DWPlayer(this.amiga);this.player.load(i);
if(this.player.version)return this.index=WHITTAKER,this.player;i.clear();this.index=0;return this.player=null}}});m.amiga=Amiga();return Object.seal(m)}()})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,writable:!0},restart:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},synth:{value:0,writable:!0},synthPtr:{value:0,writable:!0},arpeggio:{value:0,writable:!0},autoArpeggio:{value:0,writable:!0},autoSlide:{value:0,writable:!0},
vibrato:{value:0,writable:!0},volume:{value:0,writable:!0},volumeDef:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrPtr:{value:0,writable:!0},adsrCtr:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoPtr:{value:0,writable:!0},lfoCtr:{value:0,writable:!0},egControl:{value:0,writable:!0},egPtr:{value:0,writable:!0},egCtr:{value:0,writable:!0},egValue:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxCtr:{value:0,writable:!0},modControl:{value:0,writable:!0},modPtr:{value:0,
writable:!0},modCtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.enabled=0;this.samplePtr=this.sample=this.period=this.note=this.restart=0;this.sampleLen=2;this.synth=0;this.synthPtr=-1;this.modCtr=this.modPtr=this.modControl=this.fxCtr=this.fxControl=this.egValue=this.egCtr=this.egPtr=this.egControl=this.lfoCtr=this.lfoPtr=this.lfoControl=this.adsrCtr=this.adsrPtr=this.adsrControl=this.volumeDef=this.volume=this.vibrato=this.autoSlide=this.autoArpeggio=this.arpeggio=
0}}})}var m=[6848,6464,6080,5760,5440,5120,4832,4576,4320,4064,3840,3616,3424,3232,3040,2880,2720,2560,2416,2288,2160,2032,1920,1808,1712,1616,1520,1440,1360,1280,1208,1144,1080,1016,960,904,856,808,760,720,680,640,604,572,540,508,480,452,428,404,380,360,340,320,302,286,270,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95,90,85,80,76,72,68,64,60,57],i=[0,64,128,64,0,-64,-128,-64];window.neoart.BPPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"BPPlayer"},
tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},buffer:{value:null,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},nextPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},repeatCtr:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},initialize:{value:function(){var b,f,a,c=this.voices[0];this.reset();this.speed=6;this.tick=1;
this.repeatCtr=this.jumpFlag=this.nextPos=this.patternPos=this.trackPos=0;this.arpeggioCtr=1;for(this.vibratoPos=0;c;){if(-1<c.synthPtr){a=c.index<<5;f=c.synthPtr+32;for(b=c.synthPtr;b<f;++b)this.mixer.memory[b]=this.buffer[a++]}c.initialize();c.channel=this.mixer.channels[c.index];c.samplePtr=this.mixer.loopPtr;c=c.next}for(b=0;128>b;++b)this.buffer[b]=0}},loader:{value:function(b){var f=0,a=0,c,j,d;this.title=b.readString(26);c=b.readString(4);if("BPSM"==c)this.version=1;else{c=c.substr(0,3);if("V.2"==
c)this.version=2;else if("V.3"==c)this.version=3;else return;b.position=29;d=b.readUbyte()}for(this.length=b.readUshort();16>++a;)c=AmigaSample(),Object.defineProperties(c,{synth:{value:0,writable:!0},table:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrTable:{value:0,writable:!0},adsrLen:{value:0,writable:!0},adsrSpeed:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoTable:{value:0,writable:!0},lfoDepth:{value:0,writable:!0},lfoLen:{value:0,writable:!0},lfoDelay:{value:0,writable:!0},
lfoSpeed:{value:0,writable:!0},egControl:{value:0,writable:!0},egTable:{value:0,writable:!0},egLen:{value:0,writable:!0},egDelay:{value:0,writable:!0},egSpeed:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxDelay:{value:0,writable:!0},fxSpeed:{value:0,writable:!0},modControl:{value:0,writable:!0},modTable:{value:0,writable:!0},modLen:{value:0,writable:!0},modDelay:{value:0,writable:!0},modSpeed:{value:0,writable:!0}}),c=Object.seal(c),255==b.readUbyte()?(c.synth=1,c.table=b.readUbyte(),c.pointer=
c.table<<6,c.length=b.readUshort()<<1,c.adsrControl=b.readUbyte(),c.adsrTable=b.readUbyte()<<6,c.adsrLen=b.readUshort(),c.adsrSpeed=b.readUbyte(),c.lfoControl=b.readUbyte(),c.lfoTable=b.readUbyte()<<6,c.lfoDepth=b.readUbyte(),c.lfoLen=b.readUshort(),3>this.version?(b.readByte(),c.lfoDelay=b.readUbyte(),c.lfoSpeed=b.readUbyte(),c.egControl=b.readUbyte(),c.egTable=b.readUbyte()<<6,b.readByte(),c.egLen=b.readUshort(),b.readByte(),c.egDelay=b.readUbyte(),c.egSpeed=b.readUbyte(),c.fxSpeed=1,c.modSpeed=
1,c.volume=b.readUbyte(),b.position+=6):(c.lfoDelay=b.readUbyte(),c.lfoSpeed=b.readUbyte(),c.egControl=b.readUbyte(),c.egTable=b.readUbyte()<<6,c.egLen=b.readUshort(),c.egDelay=b.readUbyte(),c.egSpeed=b.readUbyte(),c.fxControl=b.readUbyte(),c.fxSpeed=b.readUbyte(),c.fxDelay=b.readUbyte(),c.modControl=b.readUbyte(),c.modTable=b.readUbyte()<<6,c.modSpeed=b.readUbyte(),c.modDelay=b.readUbyte(),c.volume=b.readUbyte(),c.modLen=b.readUshort())):(b.position--,c.synth=0,c.name=b.readString(24),c.length=b.readUshort()<<
1,c.length?(c.loop=b.readUshort(),c.repeat=b.readUshort()<<1,c.volume=b.readUshort(),c.loop+c.repeat>=c.length&&(c.repeat=c.length-c.loop)):(c.pointer--,c.repeat=2,b.position+=6)),this.samples[a]=c;c=this.length<<2;this.tracks.length=c;for(a=0;a<c;++a)j=AmigaStep(),Object.defineProperties(j,{soundTranspose:{value:0,writable:!0}}),j=Object.seal(j),j.pattern=b.readUshort(),j.soundTranspose=b.readByte(),j.transpose=b.readByte(),j.pattern>f&&(f=j.pattern),this.tracks[a]=j;c=f<<4;this.patterns.length=
c;for(a=0;a<c;++a)f=AmigaRow(),f.note=b.readByte(),f.sample=b.readUbyte(),f.effect=f.sample&15,f.sample=(f.sample&240)>>4,f.param=b.readByte(),this.patterns[a]=f;this.mixer.store(b,d<<6);for(a=0;16>++a;)c=this.samples[a],!c.synth&&c.length&&(c.pointer=this.mixer.store(b,c.length),c.loopPtr=c.pointer+c.loop)}},process:{value:function(){var b,f,a,c,j,d=this.mixer.memory,g,h=this.voices[0];this.arpeggioCtr=--this.arpeggioCtr&3;for(this.vibratoPos=++this.vibratoPos&7;h;){b=h.channel;h.period+=h.autoSlide;
b.period=h.vibrato?h.period+(i[this.vibratoPos]/h.vibrato>>0):h.period;b.pointer=h.samplePtr;b.length=h.sampleLen;if(h.arpeggio||h.autoArpeggio)c=h.note,this.arpeggioCtr?1==this.arpeggioCtr&&(c+=(h.arpeggio&15)+(h.autoArpeggio&15)):c+=((h.arpeggio&240)>>4)+((h.autoArpeggio&240)>>4),b.period=h.period=m[c+35],h.restart=0;if(h.synth&&(c=this.samples[h.sample],h.adsrControl&&0==--h.adsrCtr&&(h.adsrCtr=c.adsrSpeed,f=128+d[c.adsrTable+h.adsrPtr]>>2,b.volume=f*h.volume>>6,++h.adsrPtr==c.adsrLen&&(h.adsrPtr=
0,1==h.adsrControl&&(h.adsrControl=0))),h.lfoControl&&0==--h.lfoCtr&&(h.lfoCtr=c.lfoSpeed,f=d[c.lfoTable+h.lfoPtr],c.lfoDepth&&(f=f/c.lfoDepth>>0),b.period=h.period+f,++h.lfoPtr==c.lfoLen&&(h.lfoPtr=0,1==h.lfoControl&&(h.lfoControl=0))),!(0>h.synthPtr))){if(h.egControl&&0==--h.egCtr){h.egCtr=c.egSpeed;f=h.egValue;h.egValue=128+d[c.egTable+h.egPtr]>>3;if(h.egValue!=f)if(g=(h.index<<5)+f,a=h.synthPtr+f,h.egValue<f){f-=h.egValue;for(j=a-f;a>j;)d[--a]=this.buffer[--g]}else{f=h.egValue-f;for(j=a+f;a<j;)d[a++]=
~this.buffer[g++]+1}++h.egPtr==c.egLen&&(h.egPtr=0,1==h.egControl&&(h.egControl=0))}switch(h.fxControl){case 1:if(0==--h.fxCtr){h.fxCtr=c.fxSpeed;a=h.synthPtr;j=h.synthPtr+32;for(f=0<a?d[a-1]:0;a<j;)f=f+d[a+1]>>1,d[a++]=f}break;case 2:g=(h.index<<5)+31;j=h.synthPtr+32;f=c.fxSpeed;for(a=h.synthPtr;a<j;++a)this.buffer[g]<d[a]?d[a]-=f:this.buffer[g]>d[a]&&(d[a]+=f),g--;break;case 3:case 5:g=h.index<<5;j=h.synthPtr+32;f=c.fxSpeed;for(a=h.synthPtr;a<j;++a)this.buffer[g]<d[a]?d[a]-=f:this.buffer[g]>d[a]&&
(d[a]+=f),g++;break;case 4:g=h.synthPtr+64;j=h.synthPtr+32;f=c.fxSpeed;for(a=h.synthPtr;a<j;++a)d[g]<d[a]?d[a]-=f:d[g]>d[a]&&(d[a]+=f),g++;break;case 6:if(0==--h.fxCtr){h.fxControl=0;h.fxCtr=1;g=h.synthPtr+64;j=h.synthPtr+32;for(a=h.synthPtr;a<j;++a)d[a]=d[g++]}}h.modControl&&0==--h.modCtr&&(h.modCtr=c.modSpeed,d[h.synthPtr+32]=d[c.modTable+h.modPtr],++h.modPtr==c.modLen&&(h.modPtr=0,1==h.modControl&&(h.modControl=0)))}h=h.next}if(0==--this.tick){this.tick=this.speed;for(h=this.voices[0];h;){b=h.channel;
h.enabled=0;j=this.tracks[(this.trackPos<<2)+h.index];g=this.patterns[this.patternPos+(j.pattern-1<<4)];c=g.note;a=g.effect;f=g.param;if(c){h.autoArpeggio=h.autoSlide=h.vibrato=0;if(10!=a||0==(f&240))c+=j.transpose;h.note=c;h.period=m[c+35];h.restart=13>a?h.volumeDef=1:0;c=g.sample;0==c&&(c=h.sample);if(10!=a||0==(f&15))c+=j.soundTranspose;if(13>a&&(!h.synth||h.sample!=c))h.sample=c,h.enabled=1}switch(a){case 0:h.arpeggio=f;break;case 1:h.volume=f;h.volumeDef=0;if(3>this.version||!h.synth)b.volume=
h.volume;break;case 2:this.tick=this.speed=f;break;case 3:this.mixer.filter.active=f;break;case 4:h.period-=f;h.arpeggio=0;break;case 5:h.period+=f;h.arpeggio=0;break;case 6:3==this.version?h.vibrato=f:repeatCtr=f;break;case 7:3==this.version?(this.nextPos=f,this.jumpFlag=1):0==this.repeatCtr&&(this.trackPos=f);break;case 8:h.autoSlide=f;break;case 9:h.autoArpeggio=f;3==this.version&&(h.adsrPtr=0,0==h.adsrControl&&(h.adsrControl=1));break;case 11:h.fxControl=f;break;case 13:h.autoArpeggio=f;h.fxControl^=
1;h.adsrPtr=0;0==h.adsrControl&&(h.adsrControl=1);break;case 14:h.autoArpeggio=f;h.adsrPtr=0;0==h.adsrControl&&(h.adsrControl=1);break;case 15:h.autoArpeggio=f}h=h.next}this.jumpFlag?(this.trackPos=this.nextPos,this.patternPos=this.jumpFlag=0):16==++this.patternPos&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1));for(h=this.voices[0];h;){b=h.channel;h.enabled&&(b.enabled=h.enabled=0);if(0!=h.restart&&-1<h.synthPtr){g=h.index<<5;j=h.synthPtr+32;for(a=h.synthPtr;a<
j;++a)d[a]=this.buffer[g++];h.synthPtr=-1}h=h.next}for(h=this.voices[0];h;){if(0!=h.restart){b=h.channel;b.period=h.period;h.restart=0;c=this.samples[h.sample];if(c.synth){if(h.synth=1,h.egValue=0,h.adsrPtr=h.lfoPtr=h.egPtr=h.modPtr=0,h.adsrCtr=1,h.lfoCtr=c.lfoDelay+1,h.egCtr=c.egDelay+1,h.fxCtr=c.fxDelay+1,h.modCtr=c.modDelay+1,h.adsrControl=c.adsrControl,h.lfoControl=c.lfoControl,h.egControl=c.egControl,h.fxControl=c.fxControl,h.modControl=c.modControl,b.pointer=h.samplePtr=c.pointer,b.length=h.sampleLen=
c.length,h.adsrControl?(f=128+d[c.adsrTable]>>2,h.volumeDef&&(h.volume=c.volume,h.volumeDef=0),b.volume=f*h.volume>>6):b.volume=h.volumeDef?c.volume:h.volume,h.egControl||h.fxControl||h.modControl){h.synthPtr=c.pointer;a=h.index<<5;j=h.synthPtr+32;for(g=h.synthPtr;g<j;++g)this.buffer[a++]=d[g]}}else h.synth=h.lfoControl=0,0>c.pointer?(h.samplePtr=this.mixer.loopPtr,h.sampleLen=2):(b.pointer=c.pointer,b.volume=h.volumeDef?c.volume:h.volume,2!=c.repeat?(h.samplePtr=c.loopPtr,b.length=h.sampleLen=c.repeat):
(h.samplePtr=this.mixer.loopPtr,h.sampleLen=2,b.length=c.length));b.enabled=h.enabled=1}h=h.next}}}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);e.buffer=new Int8Array(128);return Object.seal(e)}})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},status:{value:0,writable:!0},speed:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},tableCtr:{value:0,writable:!0},
tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},volume:{value:0,writable:!0},attackCtr:{value:0,writable:!0},decayCtr:{value:0,writable:!0},releaseCtr:{value:0,writable:!0},sustain:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.status=this.patternPos=this.trackPos=0;this.speed=1;this.row=this.step=null;this.releaseCtr=this.decayCtr=this.attackCtr=this.volume=
this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.pitchBend=this.arpeggioPos=this.period=this.note=0;this.sustain=1}}})}function m(){var e=AmigaSample();Object.defineProperties(e,{synth:{value:0,writable:!0},attackStep:{value:0,writable:!0},attackDelay:{value:0,writable:!0},decayStep:{value:0,writable:!0},decayDelay:{value:0,writable:!0},releaseStep:{value:0,writable:!0},releaseDelay:{value:0,writable:!0},sustain:{value:0,writable:!0},arpeggio:{value:null,
writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},table:{value:null,writable:!0},tableDelay:{value:0,writable:!0},vibratoWait:{value:0,writable:!0},vibratoStep:{value:0,writable:!0},vibratoLen:{value:0,writable:!0}});e.arpeggio=new Int8Array(8);e.table=new Int8Array(48);return Object.seal(e)}var i=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,960,904,
856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D1Player=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"D1Player"},pointers:{value:null,writable:!0},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var b=this.voices[0];
this.reset();for(this.speed=6;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[20],b=b.next}},loader:{value:function(b){var f,a=0,c,j=0,d,g,h;if("ALL "==b.readString(4)){for(f=new Uint32Array(25);25>a;++a)f[a]=b.readUint();this.pointers=new Uint32Array(4);for(a=1;4>a;++a)this.pointers[a]=this.pointers[j]+(f[j++]>>1)-1;d=this.pointers[3]+(f[3]>>1)-1;this.tracks.length=d;c=104+f[1]-2;b.position=104;j=1;for(a=0;a<d;++a)g=AmigaStep(),h=b.readUshort(),65535==h||b.position==
c?(g.pattern=-1,g.transpose=b.readUshort(),c+=f[j++]):(b.position--,g.pattern=(h>>2&16320)>>2,g.transpose=b.readByte()),this.tracks[a]=g;d=f[4]>>2;this.patterns.length=d;for(a=0;a<d;++a)c=AmigaRow(),c.sample=b.readUbyte(),c.note=b.readUbyte(),c.effect=b.readUbyte()&31,c.param=b.readUbyte(),this.patterns[a]=c;c=5;for(a=0;20>a;++a){this.samples[a]=null;if(0!=f[c]){g=m();g.attackStep=b.readUbyte();g.attackDelay=b.readUbyte();g.decayStep=b.readUbyte();g.decayDelay=b.readUbyte();g.sustain=b.readUshort();
g.releaseStep=b.readUbyte();g.releaseDelay=b.readUbyte();g.volume=b.readUbyte();g.vibratoWait=b.readUbyte();g.vibratoStep=b.readUbyte();g.vibratoLen=b.readUbyte();g.pitchBend=b.readByte();g.portamento=b.readUbyte();g.synth=b.readUbyte();g.tableDelay=b.readUbyte();for(j=0;8>j;++j)g.arpeggio[j]=b.readByte();g.length=b.readUshort();g.loop=b.readUshort();g.repeat=b.readUshort()<<1;g.synth=g.synth?0:1;if(g.synth){for(j=0;48>j;++j)g.table[j]=b.readByte();d=f[c]-78}else d=g.length;g.pointer=this.mixer.store(b,
d);g.loopPtr=g.pointer+g.loop;this.samples[a]=g}c++}g=m();g.pointer=g.loopPtr=this.mixer.memory.length;g.length=g.repeat=2;this.samples[20]=g;this.version=1}}},process:{value:function(){for(var b,f,a,c,j=this.voices[0];j;){f=j.channel;0==--j.speed&&(j.speed=this.speed,0==j.patternPos&&(j.step=this.tracks[this.pointers[j.index]+j.trackPos],0>j.step.pattern&&(j.trackPos=j.step.transpose,j.step=this.tracks[this.pointers[j.index]+j.trackPos]),j.trackPos++),a=this.patterns[j.step.pattern+j.patternPos],
a.effect&&(j.row=a),a.note&&(f.enabled=0,j.row=a,j.note=a.note+j.step.transpose,j.arpeggioPos=j.pitchBend=j.status=0,c=j.sample=this.samples[a.sample],c.synth||(f.pointer=c.pointer),f.length=c.length,j.tableCtr=j.tablePos=0,j.vibratoCtr=c.vibratoWait,j.vibratoPos=c.vibratoLen,j.vibratoDir=c.vibratoLen<<1,j.volume=j.attackCtr=j.decayCtr=j.releaseCtr=0,j.sustain=c.sustain),16==++j.patternPos&&(j.patternPos=0));c=j.sample;if(c.synth)if(0==j.tableCtr){j.tableCtr=c.tableDelay;do b=1,48<=j.tablePos&&(j.tablePos=
0),a=c.table[j.tablePos],j.tablePos++,0<=a?(f.pointer=c.pointer+(a<<5),b=0):-1!=a?c.tableDelay=a&127:j.tablePos=c.table[j.tablePos];while(b)}else j.tableCtr--;c.portamento&&(a=i[j.note]+j.pitchBend,0!=j.period?j.period<a?(j.period+=c.portamento,j.period>a&&(j.period=a)):(j.period-=c.portamento,j.period<a&&(j.period=a)):j.period=a);0==j.vibratoCtr?(j.vibratoPeriod=j.vibratoPos*c.vibratoStep,0==(j.status&1)?(j.vibratoPos++,j.vibratoPos==j.vibratoDir&&(j.status^=1)):(j.vibratoPos--,0==j.vibratoPos&&
(j.status^=1))):j.vibratoCtr--;j.pitchBend=0>c.pitchBend?j.pitchBend+c.pitchBend:j.pitchBend-c.pitchBend;if(j.row)switch(a=j.row,a.effect){case 1:if(a=a.param&15)this.speed=a;break;case 2:j.pitchBend-=a.param;break;case 3:j.pitchBend+=a.param;break;case 4:this.mixer.filter.active=a.param;break;case 5:c.vibratoWait=a.param;break;case 6:c.vibratoStep=a.param;case 7:c.vibratoLen=a.param;break;case 8:c.pitchBend=a.param;break;case 9:c.portamento=a.param;break;case 10:c.volume=64;break;case 11:c.arpeggio[0]=
a.param;break;case 12:c.arpeggio[1]=a.param;break;case 13:c.arpeggio[2]=a.param;break;case 14:c.arpeggio[3]=a.param;break;case 15:c.arpeggio[4]=a.param;break;case 16:c.arpeggio[5]=a.param;break;case 17:c.arpeggio[6]=a.param;break;case 18:c.arpeggio[7]=a.param;break;case 19:c.arpeggio[0]=c.arpeggio[4]=a.param;break;case 20:c.arpeggio[1]=c.arpeggio[5]=a.param;break;case 21:c.arpeggio[2]=c.arpeggio[6]=a.param;break;case 22:c.arpeggio[3]=c.arpeggio[7]=a.param;break;case 23:a=a.param;64<a&&(a=64);c.attackStep=
a;break;case 24:c.attackDelay=a.param;break;case 25:a=a.param;64<a&&(a=64);c.decayStep=a;break;case 26:c.decayDelay=a.param;break;case 27:c.sustain=a.param&c.sustain&255;break;case 28:c.sustain=(c.sustain&65280)+a.param;break;case 29:a=a.param;64<a&&(a=64);c.releaseStep=a;break;case 30:c.releaseDelay=a.param}c.portamento?a=j.period:(a=i[j.note+c.arpeggio[j.arpeggioPos]],j.arpeggioPos=++j.arpeggioPos&7,a-=c.vibratoLen*c.vibratoStep,a+=j.pitchBend,j.period=0);f.period=a+j.vibratoPeriod;b=j.status&14;
a=j.volume;0==b&&(0==j.attackCtr?(j.attackCtr=c.attackDelay,a+=c.attackStep,64<=a&&(b|=2,j.status|=2,a=64)):j.attackCtr--);2==b&&(0==j.decayCtr?(j.decayCtr=c.decayDelay,a-=c.decayStep,a<=c.volume&&(b|=6,j.status|=6,a=c.volume)):j.decayCtr--);6==b&&(0==j.sustain?(b|=14,j.sustain|=14):j.sustain--);14==b&&(0==j.releaseCtr?(j.releaseCtr=c.releaseDelay,a-=c.releaseStep,0>a&&(j.status&=9,a=0)):j.releaseCtr--);f.volume=j.volume=a;f.enabled=1;c.synth||(c.loop?(f.pointer=c.loopPtr,f.length=c.repeat):(f.pointer=
this.mixer.loopPtr,f.length=2));j=j.next}}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);return Object.seal(e)}})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},restart:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioPtr:{value:0,
writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},tableCtr:{value:0,writable:!0},tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},vibratoSustain:{value:0,writable:!0},volume:{value:0,writable:!0},volumeMax:{value:0,writable:!0},volumePos:{value:0,writable:!0},volumeSustain:{value:0,writable:!0},initialize:{value:function(){this.sample=
null;this.restart=this.patternPos=this.trackLen=this.trackPos=this.trackPtr=0;this.row=this.step=null;this.volume=this.vibratoSustain=this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.portamento=this.pitchBend=this.arpeggioPos=this.arpeggioPtr=this.finalPeriod=this.period=this.note=0;this.volumeMax=63;this.volumeSustain=this.volumePos=0}}})}function m(){var e=AmigaSample();Object.defineProperties(e,{index:{value:0,writable:!0},pitchBend:{value:0,writable:!0},
synth:{value:0,writable:!0},table:{value:null,writable:!0},vibratos:{value:null,writable:!0},volumes:{value:null,writable:!0}});e.table=new Uint8Array(48);e.vibratos=new Uint8Array(15);e.volumes=new Uint8Array(15);return Object.seal(e)}var i=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,
269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D2Player=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"D2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},data:{value:null,writable:!0},arpeggios:{value:null,writable:!0},voices:{value:[],writable:!0},noise:{value:0,writable:!0},initialize:{value:function(){var b=this.voices[0];this.reset();this.speed=
5;this.tick=1;for(this.noise=0;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[this.samples.length-1],b.trackPtr=this.data[b.index],b.restart=this.data[b.index+4],b.trackLen=this.data[b.index+8],b=b.next}},loader:{value:function(b){var f=0,a,c=0,j,d,g;b.position=3014;if(".FNL"==b.readString(4)){b.position=4042;for(this.data=new Uint16Array(12);4>f;++f)this.data[f+4]=b.readUshort(),g=b.readUshort()>>1,this.data[f+8]=g,c+=g;g=c;for(f=3;0<f;--f)this.data[f]=g-=this.data[f+
8];this.tracks.length=c;for(f=0;f<c;++f)a=AmigaStep(),a.pattern=b.readUbyte()<<4,a.transpose=b.readByte(),this.tracks[f]=a;c=b.readUint()>>2;this.patterns.length=c;for(f=0;f<c;++f)a=AmigaRow(),a.note=b.readUbyte(),a.sample=b.readUbyte(),a.effect=b.readUbyte()-1,a.param=b.readUbyte(),this.patterns[f]=a;b.position+=254;g=b.readUshort();d=b.position;b.position-=256;c=1;j=new Uint16Array(128);for(f=0;128>f;++f)a=b.readUshort(),a!=g&&(j[c++]=a);this.samples.length=c;for(f=0;f<c;++f){b.position=d+j[f];
g=m();g.length=b.readUshort()<<1;g.loop=b.readUshort();g.repeat=b.readUshort()<<1;for(a=0;15>a;++a)g.volumes[a]=b.readUbyte();for(a=0;15>a;++a)g.vibratos[a]=b.readUbyte();g.pitchBend=b.readUshort();g.synth=b.readByte();g.index=b.readUbyte();for(a=0;48>a;++a)g.table[a]=b.readUbyte();this.samples[f]=g}c=b.readUint();this.mixer.store(b,c);b.position+=64;for(f=0;8>f;++f)j[f]=b.readUint();c=this.samples.length;d=b.position;for(f=0;f<c;++f)g=this.samples[f],0<=g.synth||(b.position=d+j[g.index],g.pointer=
this.mixer.store(b,g.length),g.loopPtr=g.pointer+g.loop);b.position=3018;for(f=0;1024>f;++f)this.arpeggios[f]=b.readByte();g=m();g.pointer=g.loopPtr=this.mixer.memory.length;g.length=g.repeat=2;this.samples[c]=g;this.version=2}}},process:{value:function(){var b;b=0;for(var f,a,c,j=this.voices[0];64>b;)this.noise=this.noise<<7|this.noise>>>25,this.noise+=1858762093,this.noise^=2656676139,a=this.noise>>>24&255,127<a&&(a|=-256),this.mixer.memory[b++]=a,a=this.noise>>>16&255,127<a&&(a|=-256),this.mixer.memory[b++]=
a,a=this.noise>>>8&255,127<a&&(a|=-256),this.mixer.memory[b++]=a,a=this.noise&255,127<a&&(a|=-256),this.mixer.memory[b++]=a;0>--this.tick&&(this.tick=this.speed);for(;j;){if(!(1>j.trackLen)){b=j.channel;c=j.sample;c.synth&&(b.pointer=c.loopPtr,b.length=c.repeat);if(0==this.tick){0==j.patternPos&&(j.step=this.tracks[j.trackPtr+j.trackPos],++j.trackPos==j.trackLen&&(j.trackPos=j.restart));a=j.row=this.patterns[j.step.pattern+j.patternPos];a.note&&(b.enabled=0,j.note=a.note,j.period=i[a.note+j.step.transpose],
c=j.sample=this.samples[a.sample],0>c.synth&&(b.pointer=c.pointer,b.length=c.length),j.arpeggioPos=0,j.tableCtr=0,j.tablePos=0,j.vibratoCtr=c.vibratos[1],j.vibratoPos=0,j.vibratoDir=0,j.vibratoPeriod=0,j.vibratoSustain=c.vibratos[2],j.volume=0,j.volumePos=0,j.volumeSustain=0);switch(a.effect){case 0:this.speed=a.param&15;break;case 1:this.mixer.filter.active=a.param;break;case 2:j.pitchBend=~(a.param&255)+1;break;case 3:j.pitchBend=a.param&255;break;case 4:j.portamento=a.param;break;case 5:j.volumeMax=
a.param&63;break;case 6:this.mixer.volume=a.param;break;case 7:j.arpeggioPtr=(a.param&63)<<4}j.patternPos=++j.patternPos&15}c=j.sample;0<=c.synth&&(j.tableCtr?j.tableCtr--:(j.tableCtr=c.index,a=c.table[j.tablePos],255==a&&(a=c.table[++j.tablePos],255!=a&&(j.tablePos=a,a=c.table[j.tablePos])),255!=a&&(b.pointer=a<<8,b.length=c.length,47<++j.tablePos&&(j.tablePos=0))));a=c.vibratos[j.vibratoPos];j.vibratoPeriod=j.vibratoDir?j.vibratoPeriod-a:j.vibratoPeriod+a;0==--j.vibratoCtr&&(j.vibratoCtr=c.vibratos[j.vibratoPos+
1],j.vibratoDir=~j.vibratoDir);j.vibratoSustain?j.vibratoSustain--:(j.vibratoPos+=3,15==j.vibratoPos&&(j.vibratoPos=12),j.vibratoSustain=c.vibratos[j.vibratoPos+2]);j.volumeSustain?j.volumeSustain--:(a=c.volumes[j.volumePos],f=c.volumes[j.volumePos+1],f<j.volume?(j.volume-=a,j.volume<f&&(j.volume=f,j.volumePos+=3,j.volumeSustain=c.volumes[j.volumePos-1])):(j.volume+=a,j.volume>f&&(j.volume=f,j.volumePos+=3,15==j.volumePos&&(j.volumePos=12),j.volumeSustain=c.volumes[j.volumePos-1])));j.portamento&&
(j.period<j.finalPeriod?(j.finalPeriod-=j.portamento,j.finalPeriod<j.period&&(j.finalPeriod=j.period)):(j.finalPeriod+=j.portamento,j.finalPeriod>j.period&&(j.finalPeriod=j.period)));a=this.arpeggios[j.arpeggioPtr+j.arpeggioPos];-128==a&&(j.arpeggioPos=0,a=this.arpeggios[j.arpeggioPtr]);j.arpeggioPos=++j.arpeggioPos&15;0==j.portamento&&(a=j.note+j.step.transpose+a,0>a&&(a=0),j.finalPeriod=i[a]);j.vibratoPeriod-=c.pitchBend-j.pitchBend;b.period=j.finalPeriod+j.vibratoPeriod;a=j.volume>>2&63;a>j.volumeMax&&
(a=j.volumeMax);b.volume=a;b.enabled=1}j=j.next}}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);e.arpeggios=new Int8Array(1024);return Object.seal(e)}})();
(function(){function p(){return Object.create(null,{channel:{value:null,writable:!0},sample:{value:null,writable:!0},step:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},val1:{value:0,writable:!0},val2:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioStep:{value:0,writable:!0},effectCtr:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchStep:{value:0,writable:!0},portamento:{value:0,writable:!0},volume:{value:0,writable:!0},
volumeCtr:{value:0,writable:!0},volumeStep:{value:0,writable:!0},mixMute:{value:0,writable:!0},mixPtr:{value:0,writable:!0},mixEnd:{value:0,writable:!0},mixSpeed:{value:0,writable:!0},mixStep:{value:0,writable:!0},mixVolume:{value:0,writable:!0},initialize:{value:function(){this.step=this.sample=null;this.volumeStep=this.volumeCtr=this.volume=this.portamento=this.pitchStep=this.pitchCtr=this.pitch=this.effectCtr=this.arpeggioStep=this.finalPeriod=this.val2=this.val1=this.period=this.note=0;this.mixMute=
1;this.mixVolume=this.mixStep=this.mixSpeed=this.mixEnd=this.mixPtr=0}}})}var m=[3220,3040,2869,2708,2556,2412,2277,2149,2029,1915,1807,1706,1610,1520,1434,1354,1278,1206,1139,1075,1014,957,904,853,805,760,717,677,639,603,569,537,507,479,452,426,403,380,359,338,319,302,285,269,254,239,226,213,201,190,179,169,160,151,142,134,127,4842,4571,4314,4072,3843,3628,3424,3232,3051,2879,2718,2565,2421,2285,2157,2036,1922,1814,1712,1616,1525,1440,1359,1283,1211,1143,1079,1018,961,907,856,808,763,720,679,641,
605,571,539,509,480,453,428,404,381,360,340,321,303,286,270,254,240,227,214,202,191,180,170,160,151,143,135,127,4860,4587,4330,4087,3857,3641,3437,3244,3062,2890,2728,2574,2430,2294,2165,2043,1929,1820,1718,1622,1531,1445,1364,1287,1215,1147,1082,1022,964,910,859,811,765,722,682,644,607,573,541,511,482,455,430,405,383,361,341,322,304,287,271,255,241,228,215,203,191,181,170,161,152,143,135,128,4878,4604,4345,4102,3871,3654,3449,3255,3073,2900,2737,2584,2439,2302,2173,2051,1936,1827,1724,1628,1536,
1450,1369,1292,1219,1151,1086,1025,968,914,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,4895,4620,4361,4116,3885,3667,3461,3267,3084,2911,2747,2593,2448,2310,2181,2058,1943,1834,1731,1634,1542,1455,1374,1297,1224,1155,1090,1029,971,917,865,817,771,728,687,648,612,578,545,515,486,458,433,408,385,364,343,324,306,289,273,257,243,229,216,204,193,182,172,162,153,144,136,129,4913,4637,4377,4131,3899,3681,3474,3279,
3095,2921,2757,2603,2456,2319,2188,2066,1950,1840,1737,1639,1547,1461,1379,1301,1228,1159,1094,1033,975,920,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,4931,4654,4393,4146,3913,3694,3486,3291,3106,2932,2767,2612,2465,2327,2196,2073,1957,1847,1743,1645,1553,1466,1384,1306,1233,1163,1098,1037,978,923,872,823,777,733,692,653,616,582,549,518,489,462,436,411,388,366,346,326,308,291,275,259,245,231,218,206,194,183,
173,163,154,145,137,130,4948,4671,4409,4161,3928,3707,3499,3303,3117,2942,2777,2621,2474,2335,2204,2081,1964,1854,1750,1651,1559,1471,1389,1311,1237,1168,1102,1040,982,927,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,4966,4688,4425,4176,3942,3721,3512,3315,3129,2953,2787,2631,2483,2344,2212,2088,1971,1860,1756,1657,1564,1477,1394,1315,1242,1172,1106,1044,985,930,878,829,782,738,697,658,621,586,553,522,493,465,
439,414,391,369,348,329,310,293,277,261,246,233,219,207,196,185,174,164,155,146,138,131,4984,4705,4441,4191,3956,3734,3524,3327,3140,2964,2797,2640,2492,2352,2220,2096,1978,1867,1762,1663,1570,1482,1399,1320,1246,1176,1110,1048,989,934,881,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,5002,4722,4457,4206,3970,3748,3537,3339,3151,2974,2807,2650,2501,2361,2228,2103,1985,1874,1769,1669,1576,1487,1404,1325,1251,1180,
1114,1052,993,937,884,835,788,744,702,662,625,590,557,526,496,468,442,417,394,372,351,331,313,295,279,263,248,234,221,209,197,186,175,166,156,148,139,131,5020,4739,4473,4222,3985,3761,3550,3351,3163,2985,2818,2659,2510,2369,2236,2111,1992,1881,1775,1675,1581,1493,1409,1330,1255,1185,1118,1055,996,940,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,5039,4756,4489,4237,3999,3775,3563,3363,3174,2996,2828,2669,2519,
2378,2244,2118,2E3,1887,1781,1681,1587,1498,1414,1335,1260,1189,1122,1059,1E3,944,891,841,794,749,707,667,630,594,561,530,500,472,445,420,397,374,353,334,315,297,281,265,250,236,223,210,198,187,177,167,157,149,140,132,5057,4773,4505,4252,4014,3788,3576,3375,3186,3007,2838,2679,2528,2387,2253,2126,2007,1894,1788,1688,1593,1503,1419,1339,1264,1193,1126,1063,1003,947,894,844,796,752,710,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,
5075,4790,4521,4268,4028,3802,3589,3387,3197,3018,2848,2688,2538,2395,2261,2134,2014,1901,1794,1694,1599,1509,1424,1344,1269,1198,1130,1067,1007,951,897,847,799,754,712,672,634,599,565,533,504,475,449,423,400,377,356,336,317,299,283,267,252,238,224,212,200,189,178,168,159,150,141,133,5093,4808,4538,4283,4043,3816,3602,3399,3209,3029,2859,2698,2547,2404,2269,2142,2021,1908,1801,1700,1604,1514,1429,1349,1273,1202,1134,1071,1011,954,900,850,802,757,715,675,637,601,567,535,505,477,450,425,401,379,357,
337,318,300,284,268,253,238,225,212,201,189,179,169,159,150,142,134];window.neoart.DMPlayer=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"DMPlayer"},songs:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},buffer1:{value:0,writable:!0},buffer2:{value:0,writable:!0},song1:{value:0,writable:!0},song2:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},
patternEnd:{value:0,writable:!0},stepEnd:{value:0,writable:!0},numChannels:{value:0,writable:!0},arpeggios:{value:null,writable:!0},averages:{value:null,writable:!0},volumes:{value:null,writable:!0},mixChannel:{value:null,writable:!0},mixPeriod:{value:0,writable:!0},initialize:{value:function(){var e,b=0,f;this.reset();7<this.playSong&&(this.playSong=0);this.song1=this.songs[this.playSong];this.speed=this.song1.speed&15;this.speed|=this.speed<<4;this.tick=this.song1.speed;this.patternPos=this.trackPos=
0;this.patternLen=64;this.stepEnd=this.patternEnd=1;for(this.numChannels=4;7>b;++b)f=this.voices[b],f.initialize(),f.sample=this.samples[0],4>b&&(e=this.mixer.channels[b],e.enabled=0,e.pointer=this.mixer.loopPtr,e.length=2,e.period=124,e.volume=0,f.channel=e);if(2==this.version){0!=(this.playSong&1)&&this.playSong--;this.song2=this.songs[this.playSong+1];this.mixChannel=AmigaChannel(7);this.numChannels=7;e=this.mixer.channels[3];e.mute=0;e.pointer=this.buffer1;e.length=350;e.period=this.mixPeriod;
e.volume=64;e=this.buffer1+700;for(b=this.buffer1;b<e;++b)this.mixer.memory[b]=0}}},loader:{value:function(e){var b,f=0,a,c,j,d;a=e.readString(24);if(" MUGICIAN/SOFTEYES 1990 "==a)this.version=1;else if(" MUGICIAN2/SOFTEYES 1990"==a)this.version=2;else return;e.position=28;for(c=new Uint32Array(8);8>f;++f)c[f]=e.readUint();e.position=76;for(f=0;8>f;++f)j=Object.create(null,{title:{value:"",writable:!0},speed:{value:0,writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},loopStep:{value:0,
writable:!0},tracks:{value:[],writable:!0}}),j.loop=e.readUbyte(),j.loopStep=e.readUbyte()<<2,j.speed=e.readUbyte(),j.length=e.readUbyte()<<2,j.title=e.readString(12),this.songs[f]=j;e.position=204;this.lastSong=this.songs.length-1;for(f=0;8>f;++f){j=this.songs[f];a=c[f]<<2;for(b=0;b<a;++b)d=AmigaStep(),d.pattern=e.readUbyte()<<6,d.transpose=e.readByte(),j.tracks[b]=d}j=e.position;e.position=60;a=e.readUint();this.samples.length=++a;e.position=j;for(f=1;f<a;++f)c=AmigaSample(),Object.defineProperties(c,
{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},finetune:{value:0,writable:!0},arpeggio:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchDelay:{value:0,writable:!0},pitchLoop:{value:0,writable:!0},pitchSpeed:{value:0,writable:!0},effect:{value:0,writable:!0},effectDone:{value:0,writable:!0},effectStep:{value:0,writable:!0},effectSpeed:{value:0,writable:!0},source1:{value:0,writable:!0},source2:{value:0,writable:!0},volumeLoop:{value:0,writable:!0},volumeSpeed:{value:0,writable:!0}}),
d=Object.seal(c),d.wave=e.readUbyte(),d.waveLen=e.readUbyte()<<1,d.volume=e.readUbyte(),d.volumeSpeed=e.readUbyte(),d.arpeggio=e.readUbyte(),d.pitch=e.readUbyte(),d.effectStep=e.readUbyte(),d.pitchDelay=e.readUbyte(),d.finetune=e.readUbyte()<<6,d.pitchLoop=e.readUbyte(),d.pitchSpeed=e.readUbyte(),d.effect=e.readUbyte(),d.source1=e.readUbyte(),d.source2=e.readUbyte(),d.effectSpeed=e.readUbyte(),d.volumeLoop=e.readUbyte(),this.samples[f]=d;this.samples[0]=this.samples[1];j=e.position;e.position=64;
a=e.readUint()<<7;e.position=j;this.mixer.store(e,a);j=e.position;e.position=68;c=e.readUint();e.position=26;a=e.readUshort()<<6;this.patterns.length=a;e.position=j+(c<<5);c&&(c=j);for(f=0;f<a;++f)b=AmigaRow(),b.note=e.readUbyte(),b.sample=e.readUbyte()&63,b.effect=e.readUbyte(),b.param=e.readByte(),this.patterns[f]=b;j=e.position;e.position=72;if(c){a=e.readUint();e.position=j;b=this.mixer.store(e,a);j=e.position;this.mixer.memory.length+=350;this.buffer1=this.mixer.memory.length;this.mixer.memory.length+=
350;this.buffer2=this.mixer.memory.length;this.mixer.memory.length+=350;this.mixer.loopLen=8;a=this.samples.length;for(f=1;f<a;++f)d=this.samples[f],32>d.wave||(e.position=c+(d.wave-32<<5),d.pointer=e.readUint(),d.length=e.readUint()-d.pointer,d.loop=e.readUint(),d.name=e.readString(12),d.loop?(d.loop-=d.pointer,d.repeat=d.length-d.loop):(d.loopPtr=this.mixer.memory.length,d.repeat=8),0!=(d.pointer&1)&&d.pointer--,0!=(d.length&1)&&d.length--,d.pointer+=b,d.loop&&(d.loopPtr=d.pointer+d.loop),this.mixer.memory[d.pointer]=
0,this.mixer.memory[d.pointer+1]=0)}else j+=e.readUint();e.position=24;if(1==e.readUshort()){e.position=j;a=e.length-e.position;256<a&&(a=256);for(f=0;f<a;++f)this.arpeggios[f]=e.readUbyte()}}},process:{value:function(){for(var e,b,f=0,a,c,j,d=this.mixer.memory,g,h,i,l,o,n;f<this.numChannels;++f){n=this.voices[f];l=n.sample;3>f||4==this.numChannels?(e=n.channel,this.stepEnd&&(n.step=this.song1.tracks[this.trackPos+f]),31<l.wave&&(e.pointer=l.loopPtr,e.length=l.repeat)):(e=this.mixChannel,this.stepEnd&&
(n.step=this.song2.tracks[this.trackPos+(f-3)]));if(this.patternEnd&&(b=this.patterns[n.step.pattern+this.patternPos],b.note)){74!=b.effect&&(n.note=b.note,b.sample&&(l=n.sample=this.samples[b.sample]));n.val1=64>b.effect?1:b.effect-62;n.val2=b.param;a=n.step.transpose+l.finetune;12!=n.val1?(n.pitch=b.effect,1==n.val1&&(a+=n.pitch,n.period=0>a?0:m[a])):(n.pitch=b.note,a+=n.pitch,n.period=0>a?0:m[a]);11==n.val1&&(l.arpeggio=n.val2&7);if(12!=n.val1)if(31<l.wave)e.pointer=l.pointer,e.length=l.length,
e.enabled=0,n.mixPtr=l.pointer,n.mixEnd=l.pointer+l.length,n.mixMute=0;else if(b=l.wave<<7,e.pointer=b,e.length=l.waveLen,10!=n.val1&&(e.enabled=0),4==this.numChannels&&0!=l.effect&&2!=n.val1&&4!=n.val1){j=b+128;h=l.source1<<7;for(c=b;c<j;++c)d[c]=d[h++];l.effectStep=0;n.effectCtr=l.effectSpeed}3!=n.val1&&4!=n.val1&&12!=n.val1&&(n.volumeCtr=1,n.volumeStep=0);n.arpeggioStep=0;n.pitchCtr=l.pitchDelay;n.pitchStep=0;n.portamento=0}switch(n.val1){case 5:o=n.val2;0<o&&65>o&&(this.patternLen=o);break;case 6:o=
n.val2&15;o|=o<<4;if(0==n.val2||15<n.val2)break;this.speed=o;break;case 7:this.mixer.filter.active=1;break;case 8:this.mixer.filter.active=0;break;case 13:n.val1=0;o=n.val2&15;if(0==o)break;o=n.val2&240;if(0==o)break;this.speed=n.val2}}for(f=0;f<this.numChannels;++f){n=this.voices[f];l=n.sample;if(4==this.numChannels){if(e=n.channel,32>l.wave&&l.effect&&!l.effectDone)if(l.effectDone=1,n.effectCtr)n.effectCtr--;else switch(n.effectCtr=l.effectSpeed,b=l.wave<<7,l.effect){case 1:for(c=0;127>c;++c)o=
d[b],o+=d[b+1],d[b++]=o>>1;break;case 2:h=l.source1<<7;i=l.source2<<7;a=l.effectStep;j=l.waveLen;l.effectStep=++l.effectStep&127;for(c=0;c<j;++c)o=d[h++],o+=d[i+a],d[b++]=o>>1,a=++a&127;break;case 3:o=d[b];for(c=0;127>c;++c)d[b]=d[++b];d[b]=o;break;case 4:b+=127;o=d[b];for(c=0;127>c;++c)d[b]=d[--b];d[b]=o;break;case 5:a=o=b;for(c=0;64>c;++c)d[a++]=d[b++],b++;a=b=o;a+=64;for(c=0;64>c;++c)d[a++]=d[b++];break;case 6:h=b+64;b+=128;for(c=0;64>c;++c)d[--b]=d[--h],d[--b]=d[h];break;case 7:b+=l.effectStep;
d[b]=~d[b]+1;++l.effectStep>=l.waveLen&&(l.effectStep=0);break;case 8:l.effectStep=++l.effectStep&127;i=(l.source2<<7)+l.effectStep;a=d[i];j=l.waveLen;o=3;for(c=0;c<j;++c)h=d[b]+o,-128>h?h+=256:127<h&&(h-=256),d[b++]=h,o+=a,-128>o?o+=256:127<o&&(o-=256);break;case 9:i=l.source2<<7;j=l.waveLen;for(c=0;c<j;++c)o=d[i++],o+=d[b],127<o&&(o-=256),d[b++]=o;break;case 10:for(c=0;126>c;++c)o=3*d[b++],o+=d[b+1],d[b]=o>>2;break;case 11:h=l.source1<<7;i=l.source2<<7;j=l.waveLen;l.effectStep=++l.effectStep&127;
o=l.effectStep;64<=o&&(o=127-o);a=(o^255)&63;for(c=0;c<j;++c)g=d[h++]*o,g+=d[i++]*a,d[b++]=g>>6;break;case 12:h=l.source1<<7;i=l.source2<<7;j=l.waveLen;l.effectStep=++l.effectStep&31;o=l.effectStep;16<=o&&(o=31-o);a=(o^255)&15;for(c=0;c<j;++c)g=d[h++]*o,g+=d[i++]*a,d[b++]=g>>4;break;case 13:for(c=0;126>c;++c)o=d[b++],o+=d[b+1],d[b]=o>>1;break;case 14:a=b+l.effectStep;d[a]=~d[a]+1;a=l.effectStep+l.source2&l.waveLen-1;a+=b;d[a]=~d[a]+1;++l.effectStep>=l.waveLen&&(l.effectStep=0);break;case 15:a=b;for(c=
0;127>c;++c)o=d[b],o+=d[b+1],d[b++]=o>>1;b=a;l.effectStep++;if(l.effectStep==l.source2){l.effectStep=0;a=o=b;for(c=0;64>c;++c)d[a++]=d[b++],b++;a=b=o;a+=64;for(c=0;64>c;++c)d[a++]=d[b++]}}}else e=3>f?n.channel:this.mixChannel;n.volumeCtr&&(n.volumeCtr--,0==n.volumeCtr&&(n.volumeCtr=l.volumeSpeed,n.volumeStep=++n.volumeStep&127,n.volumeStep||l.volumeLoop?(a=n.volumeStep+(l.volume<<7),o=~(d[a]+129)+1,n.volume=(o&255)>>2,e.volume=n.volume):n.volumeCtr=0));o=n.note;l.arpeggio&&(a=n.arpeggioStep+(l.arpeggio<<
5),o+=this.arpeggios[a],n.arpeggioStep=++n.arpeggioStep&31);a=o+n.step.transpose+l.finetune;n.finalPeriod=m[a];b=n.finalPeriod;if(1==n.val1||12==n.val1)if(o=~n.val2+1,n.portamento+=o,n.finalPeriod+=n.portamento,n.val2&&(0>o&&n.finalPeriod<=n.period||0<=o&&n.finalPeriod>=n.period))n.portamento=n.period-b,n.val2=0;l.pitch&&(n.pitchCtr?n.pitchCtr--:(a=n.pitchStep,n.pitchStep=++n.pitchStep&127,0==n.pitchStep&&(n.pitchStep=l.pitchLoop),a+=l.pitch<<7,o=d[a],n.finalPeriod+=~o+1));e.period=n.finalPeriod}if(4<
this.numChannels){h=this.buffer1;this.buffer1=this.buffer2;this.buffer2=h;e=this.mixer.channels[3];e.pointer=h;for(f=3;7>f;++f)n=this.voices[f],n.mixStep=0,125>n.finalPeriod?(n.mixMute=1,n.mixSpeed=0):(c=(n.finalPeriod<<8)/this.mixPeriod&65535,i=(256/c&255)<<8,b=256%c<<8&16777215,n.mixSpeed=(i|b/c&255)<<8),n.mixVolume=n.mixMute?0:n.volume<<8;for(f=0;350>f;++f){b=0;for(c=3;7>c;++c)n=this.voices[c],i=(d[n.mixPtr+(n.mixStep>>16)]&255)+n.mixVolume,b+=this.volumes[i],n.mixStep+=n.mixSpeed;d[h++]=this.averages[b]}e.length=
350;e.period=this.mixPeriod;e.volume=64}if(0==--this.tick){if(this.tick=this.speed&15,this.speed=(this.speed&240)>>4,this.speed|=this.tick<<4,this.patternEnd=1,this.patternPos++,64==this.patternPos||this.patternPos==this.patternLen)this.patternPos=0,this.stepEnd=1,this.trackPos+=4,this.trackPos==this.song1.length&&(this.trackPos=this.song1.loopStep,this.mixer.complete=1)}else this.stepEnd=this.patternEnd=0;for(f=0;f<this.numChannels;++f)n=this.voices[f],n.mixPtr+=n.mixStep>>16,l=n.sample,l.effectDone=
0,n.mixPtr>=n.mixEnd&&(l.loop?n.mixPtr-=l.repeat:(n.mixPtr=0,n.mixMute=1)),4>f&&(e=n.channel,e.enabled=1)}},tables:{value:function(){var e=0,b,f,a=0,c=0,j,d,g=128;this.averages=new Int32Array(1024);this.volumes=new Int32Array(16384);for(this.mixPeriod=203;1024>e;++e)127<g&&(g-=256),this.averages[e]=g,383<e&&639>e&&(g=++g&255);for(e=0;64>e;++e){j=-128;d=128;for(f=0;256>f;++f)g=j*c/63+128,b=a+d,this.volumes[b]=g&255,0!=e&&63!=e&&128<=d&&--this.volumes[b],j++,d=++d&255;a+=256;c++}}}});i.voices[0]=p();
i.voices[1]=p();i.voices[2]=p();i.voices[3]=p();i.voices[4]=p();i.voices[5]=p();i.voices[6]=p();i.arpeggios=new Uint8Array(256);i.tables();return Object.seal(i)}})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},soundTranspose:{value:0,writable:!0},transpose:{value:0,writable:!0},patStep:{value:0,writable:!0},frqStep:{value:0,writable:!0},frqPos:{value:0,writable:!0},frqSustain:{value:0,writable:!0},frqTranspose:{value:0,writable:!0},volStep:{value:0,writable:!0},volPos:{value:0,
writable:!0},volCtr:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},note:{value:0,writable:!0},pitch:{value:0,writable:!0},volume:{value:0,writable:!0},pitchBendFlag:{value:0,writable:!0},pitchBendSpeed:{value:0,writable:!0},pitchBendTime:{value:0,writable:!0},portamentoFlag:{value:0,writable:!0},portamento:{value:0,writable:!0},volBendFlag:{value:0,writable:!0},volBendSpeed:{value:0,writable:!0},volBendTime:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibrato:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.volPos=this.volStep=this.frqTranspose=this.frqSustain=this.frqPos=this.frqStep=this.patStep=this.transpose=this.soundTranspose=this.pattern=this.enabled=0;this.volSpeed=this.volCtr=1;this.vibrato=this.vibratoDelay=this.vibratoDepth=this.vibratoSpeed=this.vibratoFlag=this.volBendTime=this.volBendSpeed=this.volBendFlag=
this.portamento=this.portamentoFlag=this.pitchBendTime=this.pitchBendSpeed=this.pitchBendFlag=this.volume=this.pitch=this.note=this.volSustain=0}},volumeBend:{value:function(){if(this.volBendFlag^=1)if(this.volBendTime--,this.volume+=this.volBendSpeed,0>this.volume||64<this.volume)this.volBendTime=0}}})}var m=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,
127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113],i=[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,8,8,8,8,8,8,8,8,16,8,16,16,8,8,
24,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,63,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,
-80,-88,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-1,7,15,23,31,39,47,55,-64,
-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,31,39,47,55,-64,-64,-48,
-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,-80,55,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,
127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,-128,-128,-128,-128,-128,-128,
-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,127,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,-128,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,-128,
-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,0,16,32,48,64,80,96,
112,69,69,121,125,122,119,112,102,97,88,83,77,44,32,24,18,4,-37,-45,-51,-58,-68,-75,-82,-88,-93,-99,-103,-109,-114,-117,-118,69,69,121,125,122,119,112,102,91,75,67,55,44,32,24,18,4,-8,-24,-37,-49,-58,-66,-80,-88,-92,-98,-102,-107,-108,-115,-125,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,
0,16,32,48,64,80,96,112];window.neoart.FCPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"FCPlayer"},seqs:{value:null,writable:!0},pats:{value:null,writable:!0},vols:{value:null,writable:!0},frqs:{value:null,writable:!0},length:{value:0,writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var b=this.voices[0];this.reset();this.seqs.position=0;this.pats.position=0;this.vols.position=0;for(this.frqs.position=0;b;)b.initialize(),
b.channel=this.mixer.channels[b.index],b.pattern=this.seqs.readUbyte()<<6,b.transpose=this.seqs.readByte(),b.soundTranspose=this.seqs.readByte(),b=b.next;this.speed=this.seqs.readUbyte();this.speed||(this.speed=3);this.tick=this.speed}},loader:{value:function(b){var f,a,c,j,d,g,h,e,l;a=b.readString(4);if("SMOD"==a)this.version=1;else if("FC14"==a)this.version=2;else return;b.position=4;this.length=b.readUint();b.position=1==this.version?100:180;this.seqs=ByteArray(new ArrayBuffer(this.length));b.readBytes(this.seqs,
0,this.length);this.length=this.length/13>>0;b.position=12;c=b.readUint();b.position=8;b.position=b.readUint();this.pats=ByteArray(new ArrayBuffer(c+1));b.readBytes(this.pats,0,c);b.position=20;c=b.readUint();b.position=16;b.position=b.readUint();this.frqs=ByteArray(new ArrayBuffer(c+9));this.frqs.writeInt(16777216);this.frqs.writeInt(225);b.readBytes(this.frqs,8,c);this.frqs.position=this.frqs.length-1;this.frqs.writeByte(225);this.frqs.position=0;b.position=28;c=b.readUint();b.position=24;b.position=
b.readUint();this.vols=ByteArray(new ArrayBuffer(c+8));this.vols.writeInt(16777216);this.vols.writeInt(225);b.readBytes(this.vols,8,c);b.position=32;h=b.readUint();b.position=40;1==this.version?(this.samples.length=57,j=0):(this.samples.length=200,j=2);for(f=0;10>f;++f)if(c=b.readUshort()<<1,0<c)if(d=b.position,b.position=h,a=b.readString(4),"SSMP"==a){e=c;for(a=0;10>a;++a)b.readInt(),c=b.readUshort()<<1,0<c?(g=AmigaSample(),g.length=c+2,g.loop=b.readUshort(),g.repeat=b.readUshort()<<1,g.loop+g.repeat>
g.length&&(g.repeat=g.length-g.loop),h+g.length>b.length&&(g.length=b.length-h),g.pointer=this.mixer.store(b,g.length,h+l),g.loopPtr=g.pointer+g.loop,this.samples[100+10*f+a]=g,l+=g.length,b.position+=6):b.position+=10;h+=e+2;b.position=d+4}else b.position=d,g=AmigaSample(),g.length=c+j,g.loop=b.readUshort(),g.repeat=b.readUshort()<<1,g.loop+g.repeat>g.length&&(g.repeat=g.length-g.loop),h+g.length>b.length&&(g.length=b.length-h),g.pointer=this.mixer.store(b,g.length,h),g.loopPtr=g.pointer+g.loop,
this.samples[f]=g,h+=g.length;else b.position+=4;if(1==this.version){j=0;e=47;for(f=10;57>f;++f){g=AmigaSample();g.length=i[j++]<<1;g.loop=0;g.repeat=g.length;d=this.mixer.memory.length;g.pointer=d;g.loopPtr=d;this.samples[f]=g;c=d+g.length;for(a=d;a<c;++a)this.mixer.memory[a]=i[e++]}}else{b.position=36;h=b.readUint();b.position=100;for(f=10;90>f;++f)c=b.readUbyte()<<1,2>c||(g=AmigaSample(),g.length=c,g.loop=0,g.repeat=g.length,h+g.length>b.length&&(g.length=b.length-h),g.pointer=this.mixer.store(b,
g.length,h),g.loopPtr=g.pointer,this.samples[f]=g,h+=g.length)}this.length*=13}},process:{value:function(){var b,f,a,c,j,d=this.voices[0];if(0==--this.tick){for(b=this.seqs.position;d;){f=d.channel;this.pats.position=d.pattern+d.patStep;j=this.pats.readUbyte();if(64<=d.patStep||73==j)this.seqs.position==this.length&&(this.seqs.position=0,this.mixer.complete=1),d.patStep=0,d.pattern=this.seqs.readUbyte()<<6,d.transpose=this.seqs.readByte(),d.soundTranspose=this.seqs.readByte(),this.pats.position=d.pattern,
j=this.pats.readUbyte();a=this.pats.readUbyte();this.frqs.position=0;this.vols.position=0;0!=j&&(d.note=j&127,d.pitch=0,d.portamento=0,d.enabled=f.enabled=0,j=8+((a&63)+d.soundTranspose<<6),j<this.vols.length&&(this.vols.position=j),d.volStep=0,d.volSpeed=d.volCtr=this.vols.readUbyte(),d.volSustain=0,d.frqPos=8+(this.vols.readUbyte()<<6),d.frqStep=0,d.frqSustain=0,d.vibratoFlag=0,d.vibratoSpeed=this.vols.readUbyte(),d.vibratoDepth=d.vibrato=this.vols.readUbyte(),d.vibratoDelay=this.vols.readUbyte(),
d.volPos=this.vols.position);a&64?d.portamento=0:a&128&&(d.portamento=this.pats[this.pats.position+1],1==this.version&&(d.portamento<<=1));d.patStep+=2;d=d.next}if(this.seqs.position!=b&&(j=this.seqs.readUbyte()))this.speed=j;this.tick=this.speed}for(d=this.voices[0];d;){f=d.channel;do{b=0;if(d.frqSustain){d.frqSustain--;break}this.frqs.position=d.frqPos+d.frqStep;do{c=0;if(!this.frqs.bytesAvailable)break;a=this.frqs.readUbyte();if(225==a)break;224==a&&(d.frqStep=this.frqs.readUbyte()&63,this.frqs.position=
d.frqPos+d.frqStep,a=this.frqs.readUbyte());switch(a){case 226:f.enabled=0,d.enabled=1,d.volCtr=1,d.volStep=0;case 228:(a=this.samples[this.frqs.readUbyte()])?(f.pointer=a.pointer,f.length=a.length):d.enabled=0;d.sample=a;d.frqStep+=2;break;case 233:j=100+10*this.frqs.readUbyte();if(a=this.samples[j+this.frqs.readUbyte()])f.enabled=0,f.pointer=a.pointer,f.length=a.length,d.enabled=1;d.sample=a;d.volCtr=1;d.volStep=0;d.frqStep+=3;break;case 231:c=1;d.frqPos=8+(this.frqs.readUbyte()<<6);d.frqPos>=this.frqs.length&&
(d.frqPos=0);d.frqStep=0;this.frqs.position=d.frqPos;break;case 234:d.pitchBendSpeed=this.frqs.readByte();d.pitchBendTime=this.frqs.readUbyte();d.frqStep+=3;break;case 232:b=1;d.frqSustain=this.frqs.readUbyte();d.frqStep+=2;break;case 227:d.vibratoSpeed=this.frqs.readUbyte(),d.vibratoDepth=this.frqs.readUbyte(),d.frqStep+=3}!b&&!c&&(this.frqs.position=d.frqPos+d.frqStep,d.frqTranspose=this.frqs.readByte(),d.frqStep++)}while(c)}while(b);if(d.volSustain)d.volSustain--;else if(d.volBendTime)d.volumeBend();
else if(0==--d.volCtr){d.volCtr=d.volSpeed;do{c=0;this.vols.position=d.volPos+d.volStep;if(!this.vols.bytesAvailable)break;a=this.vols.readUbyte();if(225==a)break;switch(a){case 234:d.volBendSpeed=this.vols.readByte();d.volBendTime=this.vols.readUbyte();d.volStep+=3;d.volumeBend();break;case 232:d.volSustain=this.vols.readUbyte();d.volStep+=2;break;case 224:c=1;j=this.vols.readUbyte()&63;d.volStep=j-5;break;default:d.volume=a,d.volStep++}}while(c)}a=d.frqTranspose;0<=a&&(a+=d.note+d.transpose);a&=
127;c=m[a];if(d.vibratoDelay)d.vibratoDelay--;else{j=d.vibrato;d.vibratoFlag?(b=d.vibratoDepth<<1,j+=d.vibratoSpeed,j>b&&(j=b,d.vibratoFlag=0)):(j-=d.vibratoSpeed,0>j&&(j=0,d.vibratoFlag=1));d.vibrato=j;j-=d.vibratoDepth;for(b=(a<<1)+160;256>b;)j<<=1,b+=24;c+=j}d.portamentoFlag^=1;d.portamentoFlag&&d.portamento&&(d.pitch=31<d.portamento?d.pitch+(d.portamento&31):d.pitch-d.portamento);d.pitchBendFlag^=1;d.pitchBendFlag&&d.pitchBendTime&&(d.pitchBendTime--,d.pitch-=d.pitchBendSpeed);c+=d.pitch;113>
c?c=113:3424<c&&(c=3424);f.period=c;f.volume=d.volume;d.sample&&(a=d.sample,f.enabled=d.enabled,f.pointer=a.loopPtr,f.length=a.repeat);d=d.next}}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);return Object.seal(e)}})();
(function(){function p(i){return Object.create(null,{index:{value:i,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},last:{value:0,writable:!0},slideCtr:{value:0,writable:!0},slideDir:{value:0,writable:!0},slideParam:{value:0,writable:!0},slidePeriod:{value:0,writable:!0},slideSpeed:{value:0,writable:!0},
stepPeriod:{value:0,writable:!0},stepSpeed:{value:0,writable:!0},stepWanted:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.stepWanted=this.stepSpeed=this.stepPeriod=this.slideSpeed=this.slidePeriod=this.slideParam=this.slideDir=this.slideCtr=this.last=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var m=[1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,
151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,-1];window.neoart.FXPlayer=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"FXPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},
force:{set:function(e){1>e?e=1:4<e&&(e=4);this.version=e}},ntsc:{set:function(e){this.standard=e;this.frequency(e);e=(e?20.44952532:20.637767904)*(this.sampleRate/1E3)/120;this.mixer.samplesTick=this.tempo/122*e>>0}},initialize:{value:function(){var e=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;e;)e.initialize(),e.channel=this.mixer.channels[e.index],e.sample=this.samples[0],e=e.next}},loader:{value:function(e){var b=0,f,a,c,j,
d=0,g;if(!(1686>e.length)){e.position=60;f=e.readString(4);if("SONG"!=f){e.position=124;f=e.readString(4);if("SO31"!=f||2350>e.length)return;c=544;this.samples.length=a=32;this.version=4}else c=0,this.samples.length=a=16,this.version=1;this.tempo=e.readUshort();e.position=0;for(f=1;f<a;++f)(g=e.readUint())?(j=AmigaSample(),j.pointer=d,d+=g,this.samples[f]=j):this.samples[f]=null;e.position+=20;for(f=1;f<a;++f)(j=this.samples[f])?(j.name=e.readString(22),j.length=e.readUshort()<<1,j.volume=e.readUshort(),
j.loop=e.readUshort(),j.repeat=e.readUshort()<<1):e.position+=30;e.position=530+c;this.length=a=e.readUbyte();e.position++;for(f=0;f<a;++f)g=e.readUbyte()<<8,this.track[f]=g,g>b&&(b=g);c&&(c+=4);e.position=660+c;b+=256;this.patterns.length=b;a=this.samples.length;for(f=0;f<b;++f){c=AmigaRow();c.note=e.readShort();g=e.readUbyte();c.param=e.readUbyte();c.effect=g&15;c.sample=g>>4;this.patterns[f]=c;if(4==this.version)c.note&4096&&(c.sample+=16,0<c.note&&(c.note&=61439));else{if(9==c.effect||856<c.note)this.version=
2;-3>c.note&&(this.version=3)}if(c.sample>=a||null==this.samples[c.sample])c.sample=0}this.mixer.store(e,d);for(f=1;f<a;++f)if(j=this.samples[f]){j.loop?j.loopPtr=j.pointer+j.loop:(j.loopPtr=this.mixer.memory.length,j.repeat=2);d=j.pointer+4;for(e=j.pointer;e<d;++e)this.mixer.memory[e]=0}j=AmigaSample();j.pointer=j.loopPtr=this.mixer.memory.length;j.length=j.repeat=2;this.samples[0]=j}}},process:{value:function(){var e,b,f,a,c=this.voices[0];if(this.tick)for(;c;){e=c.channel;if(!(2==this.version&&
-3==c.period))if(c.stepSpeed)c.stepPeriod+=c.stepSpeed,0>c.stepSpeed?c.stepPeriod<c.stepWanted&&(c.stepPeriod=c.stepWanted,2<this.version&&(c.stepSpeed=0)):c.stepPeriod>c.stepWanted&&(c.stepPeriod=c.stepWanted,2<this.version&&(c.stepSpeed=0)),2<this.version&&(c.last=c.stepPeriod),e.period=c.stepPeriod;else{if(c.slideSpeed&&(a=c.slideParam&15))if(++c.slideCtr==a)c.slideCtr=0,a=c.slideParam>>4<<3,c.slideDir?(c.slidePeriod-=8,e.period=c.slidePeriod,a-=c.slideSpeed,a==c.slidePeriod&&(c.slideDir=0)):(c.slidePeriod+=
8,e.period=c.slidePeriod,a+=c.slideSpeed,a==c.slidePeriod&&(c.slideDir=1));else{c=c.next;continue}a=0;switch(c.effect){case 1:a=this.tick%3;b=0;if(2==a){e.period=c.last;c=c.next;continue}for(a=1==a?c.param&15:c.param>>4;c.last!=m[b];)b++;e.period=m[b+a];break;case 2:a=c.param>>4;c.period=a?c.period+a:c.period-(c.param&15);e.period=c.period;break;case 3:this.mixer.filter.active=1;break;case 4:this.mixer.filter.active=0;break;case 8:a=-1;case 7:c.stepSpeed=c.param&15;f=2<this.version?c.last:c.period;
0>a&&(c.stepSpeed=-c.stepSpeed);for(b=0;;){e=m[b];if(e==f)break;if(0>e){b=-1;break}else b++}-1<b?(e=c.param>>4,-1<a&&(e=-e),b+=e,0>b&&(b=0),c.stepWanted=m[b]):c.stepWanted=c.period;break;case 9:c.slideSpeed=c.slidePeriod=c.period,c.slideParam=c.param,c.slideDir=0,c.slideCtr=0}}c=c.next}else for(a=this.track[this.trackPos]+this.patternPos;c;){e=c.channel;c.enabled=0;b=this.patterns[a+c.index];c.period=b.note;c.effect=b.effect;c.param=b.param;if(-3==b.note)c.effect=0;else if(b.sample?(b=c.sample=this.samples[b.sample],
c.volume=b.volume,5==c.effect?c.volume+=c.param:6==c.effect&&(c.volume-=c.param),e.volume=c.volume):b=c.sample,c.period){c.last=c.period;c.slideSpeed=0;c.stepSpeed=0;c.enabled=1;e.enabled=0;switch(c.period){case -2:e.volume=0;break;case -4:this.jumpFlag=1;break;case -5:break;default:e.pointer=b.pointer,e.length=b.length,e.period=c.period}c.enabled&&(e.enabled=1);e.pointer=b.loopPtr;e.length=b.repeat}c=c.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=
this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}}});i.voices[0]=p(0);i.voices[0].next=i.voices[1]=p(1);i.voices[1].next=i.voices[2]=p(2);i.voices[2].next=i.voices[3]=p(3);i.track=new Uint16Array(128);return Object.seal(i)}})();
(function(){function p(b){return Object.create(null,{index:{value:b,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume1:{value:0,writable:!0},volume2:{value:0,writable:!0},handler:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},
vibratoSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.wavePos=this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.handler=this.volume2=this.volume1=this.param=this.effect=this.period=this.enabled=0}}})}function m(){var b=AmigaSample();Object.defineProperties(b,{finetune:{value:0,writable:!0},restart:{value:0,writable:!0},waveLen:{value:0,writable:!0},waves:{value:null,writable:!0},volumes:{value:null,
writable:!0}});return Object.seal(b)}var i=[0,3,7,12,15,12,7,3,0,3,7,12,15,12,7,3,0,4,7,12,16,12,7,4,0,4,7,12,16,12,7,4,0,3,8,12,15,12,8,3,0,3,8,12,15,12,8,3,0,4,8,12,16,12,8,4,0,4,8,12,16,12,8,4,0,5,8,12,17,12,8,5,0,5,8,12,17,12,8,5,0,5,9,12,17,12,9,5,0,5,9,12,17,12,9,5,12,0,7,0,3,0,7,0,12,0,7,0,3,0,7,0,12,0,7,0,4,0,7,0,12,0,7,0,4,0,7,0,0,3,7,3,7,12,7,12,15,12,7,12,7,3,7,3,0,4,7,4,7,12,7,12,16,12,7,12,7,4,7,4,31,27,24,19,15,12,7,3,0,3,7,12,15,19,24,27,31,28,24,19,16,12,7,4,0,4,7,12,16,19,24,28,0,
12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,24,12,0,12,24,12,0,12,24,12,0,12,24,12,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,4,0,4,0,4,0,4,0,4,0,4,0,4,0,4],e=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],b=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.HMPlayer=function(f){f=AmigaPlayer(f);Object.defineProperties(f,{id:{value:"HMPlayer"},
track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.speed=6;this.jumpFlag=this.patternPos=this.trackPos=0;for(this.mixer.samplesTick=884;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],
a=a.next}},loader:{value:function(a){var c=0,b=0,d,g,h=0,f,e=0,i;if(!(2150>a.length)&&(a.position=1080,d=a.readString(4),"FEST"==d)){a.position=950;this.length=a.readUbyte();for(this.restart=a.readUbyte();128>b;++b)this.track[b]=a.readUbyte();a.position=0;this.title=a.readString(20);for(b=this.version=1;32>b;++b){this.samples[b]=null;d=a.readString(4);if("Mupp"==d){i=a.readUbyte();for(g=0;128>g;++g)this.track[g]&&this.track[g]>=i&&this.track[g]--;f=m();f.name=d;f.length=f.repeat=32;f.restart=a.readUbyte();
f.waveLen=a.readUbyte();a.position+=17;f.finetune=a.readByte();f.volume=a.readUbyte();d=a.position+4;i=1084+(i<<10);a.position=i;f.pointer=this.mixer.memory.length;f.waves=new Uint16Array(64);f.volumes=new Uint8Array(64);this.mixer.store(a,896);for(g=0;64>g;++g)f.waves[g]=a.readUbyte()<<5;for(g=0;64>g;++g)f.volumes[g]=a.readUbyte()&127;a.position=i;a.writeInt(1718382436);a.position=d;h+=896}else{d=d.substr(0,2);"El"==d?a.position+=18:(a.position-=4,d=a.readString(22));i=a.readUshort();if(!i){a.position+=
6;continue}f=m();f.name=d;f.pointer=e;f.length=i<<1;f.finetune=a.readByte();f.volume=a.readUbyte();f.loop=a.readUshort()<<1;f.repeat=a.readUshort()<<1;e+=f.length}this.samples[b]=f}for(b=0;128>b;++b)i=this.track[b]<<8,this.track[b]=i,i>c&&(c=i);a.position=1084;c+=256;this.patterns.length=c;for(b=0;b<c;++b){for(i=a.readUint();1718382436==i;)a.position+=1020,i=a.readUint();g=AmigaRow();g.note=i>>16&4095;g.sample=i>>24&240|i>>12&15;g.effect=i>>8&15;g.param=i&255;this.patterns[b]=g}this.mixer.store(a,
e);for(b=1;32>b;++b)if(f=this.samples[b],!(null==f||"Mupp"==f.name)){f.pointer+=h;f.loop?(f.loopPtr=f.pointer+f.loop,f.length=f.loop+f.repeat):(f.loopPtr=this.mixer.memory.length,f.repeat=2);e=f.pointer+4;for(g=f.pointer;g<e;++g)this.mixer.memory[g]=0}f=m();f.pointer=f.loopPtr=this.mixer.memory.length;f.length=f.repeat=2;this.samples[0]=f}}},process:{value:function(){var a,c,b,d,g,f=this.voices[0];if(this.tick)for(;f;)this.effects(f),this.handler(f),d=f.sample,f.channel.pointer=d.loopPtr,f.channel.length=
d.repeat,f=f.next;else for(c=this.track[this.trackPos]+this.patternPos;f;){a=f.channel;f.enabled=0;b=this.patterns[c+f.index];f.effect=b.effect;f.param=b.param;b.sample?(d=f.sample=this.samples[b.sample],f.volume2=d.volume,"Mupp"==d.name?(d.loopPtr=d.pointer+d.waves[0],f.handler=1,f.volume1=d.volumes[0]):(f.handler=0,f.volume1=64)):d=f.sample;b.note&&(3==f.effect||5==f.effect?b.note<f.period?(f.portaDir=1,f.portaPeriod=b.note):b.note>f.period?(f.portaDir=0,f.portaPeriod=b.note):f.portaPeriod=0:(f.period=
b.note,f.vibratoPos=0,f.wavePos=0,f.enabled=1,a.enabled=0,g=f.period*d.finetune>>8,a.period=f.period+g,f.handler?(a.pointer=d.loopPtr,a.length=d.repeat):(a.pointer=d.pointer,a.length=d.length)));switch(f.effect){case 11:this.trackPos=f.param-1;this.jumpFlag=1;break;case 12:f.volume2=f.param;64<f.volume2&&(f.volume2=64);break;case 13:this.jumpFlag=1;break;case 14:this.mixer.filter.active=f.param^1;break;case 15:g=f.param,1>g?g=1:31<g&&(g=31),this.speed=g,this.tick=0}b.note||this.effects(f);this.handler(f);
f.enabled&&(a.enabled=1);a.pointer=d.loopPtr;a.length=d.repeat;f=f.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}},effects:{value:function(a){var c=a.channel,f,d,g=a.period&4095,h,m;if(a.effect||a.param)switch(a.effect){case 0:m=this.tick%3;if(!m)break;m=1==m?a.param>>4:a.param&15;d=37-m;for(f=0;f<d;++f)if(g>=
e[f]){g=e[f+m];break}break;case 1:a.period-=a.param;113>a.period&&(a.period=113);g=a.period;break;case 2:a.period+=a.param;856<a.period&&(a.period=856);g=a.period;break;case 3:case 5:5==a.effect?h=1:a.param&&(a.portaSpeed=a.param,a.param=0);a.portaPeriod&&(a.portaDir?(a.period-=a.portaSpeed,a.period<a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)):(a.period+=a.portaSpeed,a.period>a.portaPeriod&&(a.period=a.portaPeriod,a.portaPeriod=0)));g=a.period;break;case 4:case 6:6==a.effect?h=1:a.param&&
(a.vibratoSpeed=a.param);m=b[a.vibratoPos>>2&31];m=(a.vibratoSpeed&15)*m>>7;g=127<a.vibratoPos?g-m:g+m;m=a.vibratoSpeed>>2&60;a.vibratoPos=a.vibratoPos+m&255;break;case 7:m=i[(a.vibratoPos&15)+((a.param&15)<<4)];a.vibratoPos++;for(f=0;37>f&&!(g>=e[f]);++f);m+=f;35<m&&(m-=12);g=e[m];break;case 10:h=1}c.period=g+(g*a.sample.finetune>>8);h&&(m=a.param>>4,a.volume2=m?a.volume2+m:a.volume2-(a.param&15),64<a.volume2?a.volume2=64:0>a.volume2&&(a.volume2=0))}},handler:{value:function(a){var c;a.handler&&
(c=a.sample,c.loopPtr=c.pointer+c.waves[a.wavePos],a.volume1=c.volumes[a.wavePos],++a.wavePos>c.waveLen&&(a.wavePos=c.restart));a.channel.volume=a.volume1*a.volume2>>6}}});f.voices[0]=p(0);f.voices[0].next=f.voices[1]=p(1);f.voices[1].next=f.voices[2]=p(2);f.voices[2].next=f.voices[3]=p(3);f.track=new Uint16Array(128);return Object.seal(f)}})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var m=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],i=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.MKPlayer=function(e){e=AmigaPlayer(e);Object.defineProperties(e,
{id:{value:"MKPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},restartSave:{value:0,writable:!0},force:{set:function(b){1>b?b=1:5<b&&(b=5);this.version=b;this.vibratoDepth=5==b?6:7;3==b?(this.restartSave=this.restart,this.restart=
0):(this.restart=this.restartSave,this.restartSave=0)}},initialize:{value:function(){var b=this.voices[0];this.reset();this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.sample=this.samples[0],b=b.next}},loader:{value:function(b){var f=0,a,c,j=0,d;if(!(2150>b.length)&&(b.position=1080,a=b.readString(4),!("M.K."!=a&&"FLT4"!=a))){b.position=0;this.title=b.readString(20);this.version=1;b.position+=22;for(a=1;32>a;++a)(d=b.readUshort())?
(c=AmigaSample(),b.position-=24,c.name=b.readString(22),c.length=d<<1,b.position+=3,c.volume=b.readUbyte(),c.loop=b.readUshort()<<1,c.repeat=b.readUshort()<<1,b.position+=22,c.pointer=j,j+=c.length,this.samples[a]=c,32768<c.length&&(this.version=2)):(this.samples[a]=null,b.position+=28);b.position=950;this.length=b.readUbyte();d=b.readUbyte();this.restart=d<length?d:0;for(a=0;128>a;++a)d=b.readUbyte()<<8,this.track[a]=d,d>f&&(f=d);b.position=1084;f+=256;this.patterns.length=f;for(a=0;a<f;++a){c=AmigaRow();
d=b.readUint();c.note=d>>16&4095;c.effect=d>>8&15;c.sample=d>>24&240|d>>12&15;c.param=d&255;this.patterns[a]=c;if(31<c.sample||!this.samples[c.sample])c.sample=0;if(3==c.effect||4==c.effect)this.version=3;if(5==c.effect||6==c.effect)this.version=5;if(6<c.effect&&10>c.effect){this.version=0;return}}this.mixer.store(b,j);for(a=1;32>a;++a)if(c=this.samples[a]){-1<c.name.indexOf("2.0")&&(this.version=5);c.loop?(c.loopPtr=c.pointer+c.loop,c.length=c.loop+c.repeat):(c.loopPtr=this.mixer.memory.length,c.repeat=
2);j=c.pointer+4;for(b=c.pointer;b<j;++b)this.mixer.memory[b]=0}c=AmigaSample();c.pointer=c.loopPtr=this.mixer.memory.length;c.length=c.repeat=2;this.samples[0]=c;5>this.version&&this.restart&&(this.version=4)}}},process:{value:function(){var b,f,a,c,j,d,g=this.voices[0];if(this.tick)for(;g;){b=g.channel;if(!g.effect&&!g.param)b.period=g.period;else{switch(g.effect){case 0:j=this.tick%3;if(!j){b.period=g.period;g=g.next;continue}j=1==j?g.param>>4:g.param&15;c=g.period&4095;a=37-j;for(f=0;f<a;++f)if(c>=
m[f]){b.period=m[f+j];break}break;case 1:g.period-=g.param;113>g.period&&(g.period=113);b.period=g.period;break;case 2:g.period+=g.param;856<g.period&&(g.period=856);b.period=g.period;break;case 3:case 5:5==g.effect?d=1:g.param&&(g.portaSpeed=g.param,g.param=0);g.portaPeriod&&(g.portaDir?(g.period-=g.portaSpeed,g.period<=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)):(g.period+=g.portaSpeed,g.period>=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)));b.period=g.period;break;case 4:case 6:6==
g.effect?d=1:g.param&&(g.vibratoSpeed=g.param);j=g.vibratoPos>>2&31;j=(g.vibratoSpeed&15)*i[j]>>this.vibratoDepth;b.period=127<g.vibratoPos?g.period-j:g.period+j;j=g.vibratoSpeed>>2&60;g.vibratoPos=g.vibratoPos+j&255;break;case 10:d=1}d&&(j=g.param>>4,d=0,g.volume=j?g.volume+j:g.volume-(g.param&15),0>g.volume?g.volume=0:64<g.volume&&(g.volume=64),b.volume=g.volume)}g=g.next}else for(f=this.track[this.trackPos]+this.patternPos;g;){b=g.channel;g.enabled=0;j=this.patterns[f+g.index];g.effect=j.effect;
g.param=j.param;j.sample?(a=g.sample=this.samples[j.sample],b.volume=g.volume=a.volume):a=g.sample;j.note&&(3==g.effect||5==g.effect?j.note<g.period?(g.portaDir=1,g.portaPeriod=j.note):j.note>g.period?(g.portaDir=0,g.portaPeriod=j.note):g.portaPeriod=0:(g.enabled=1,g.vibratoPos=0,b.enabled=0,b.pointer=a.pointer,b.length=a.length,b.period=g.period=j.note));switch(g.effect){case 11:this.trackPos=g.param-1;this.jumpFlag^=1;break;case 12:b.volume=g.param;5==this.version&&(g.volume=g.param);break;case 13:this.jumpFlag^=
1;break;case 14:this.mixer.filter.active=g.param^1;break;case 15:j=g.param,1>j?j=1:31<j&&(j=31),this.speed=j,this.tick=0}g.enabled&&(b.enabled=1);b.pointer=a.loopPtr;b.length=a.repeat;g=g.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1)}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=
e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);e.track=new Uint16Array(128);return Object.seal(e)}})();
(function(){function p(b){return Object.create(null,{index:{value:b,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},loopCtr:{value:0,writable:!0},loopPos:{value:0,writable:!0},step:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,
writable:!0},finetune:{value:0,writable:!0},offset:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},tremoloParam:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloWave:{value:0,writable:!0},vibratoParam:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoWave:{value:0,writable:!0},funkPos:{value:0,writable:!0},funkSpeed:{value:0,writable:!0},funkWave:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.funkWave=this.funkSpeed=this.funkPos=this.vibratoWave=this.vibratoPos=this.vibratoParam=this.tremoloWave=this.tremoloPos=this.tremoloParam=this.glissando=this.portaSpeed=this.portaPeriod=this.portaDir=this.offset=this.finetune=this.repeat=this.loopPtr=this.length=this.pointer=this.volume=this.param=this.effect=this.period=this.step=this.loopPos=this.loopCtr=this.enabled=0}}})}function m(){var b=AmigaSample();Object.defineProperties(b,{finetune:{value:0,writable:!0},realLen:{value:0,
writable:!0}});return Object.seal(b)}var i=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,850,802,757,715,674,637,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,239,225,213,201,189,179,169,159,150,142,134,126,119,113,0,844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,224,211,199,188,177,167,158,149,141,133,125,118,112,0,838,791,746,704,665,
628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,111,0,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,124,117,110,0,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,109,0,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,
244,230,217,205,193,183,172,163,154,145,137,129,122,115,109,0,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,204,192,181,171,161,152,144,136,128,121,114,108,0,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,0,900,850,802,757,715,675,636,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,238,225,212,200,189,179,169,159,150,142,134,126,119,0,894,
844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,125,118,0,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,0,881,832,785,741,699,660,623,588,555,524,494,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,123,117,0,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,
328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,0,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,122,115,0,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,121,114,0],e=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24],b=[0,5,6,
7,8,10,11,13,16,19,22,26,32,43,64,128];window.neoart.PTPlayer=function(f){f=AmigaPlayer(f);Object.defineProperties(f,{id:{value:"PTPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternBreak:{value:0,writable:!0},patternDelay:{value:0,writable:!0},breakPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,
writable:!0},force:{set:function(a){1>a?a=1:3<a&&(a=3);this.version=a;this.vibratoDepth=2>a?6:7}},initialize:{value:function(){var a=this.voices[0];this.tempo=125;this.speed=6;this.jumpFlag=this.breakPos=this.patternDelay=this.patternBreak=this.patternPos=this.trackPos=0;for(this.reset();a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var c=0,b,d,f=0,h;if(!(2150>a.length)&&(a.position=1080,b=a.readString(4),!("M.K."!=b&&"M!K!"!=
b))){a.position=0;this.title=a.readString(20);this.version=1;a.position+=22;for(b=1;32>b;++b)(h=a.readUshort())?(d=m(),a.position-=24,d.name=a.readString(22),d.length=d.realLen=h<<1,a.position+=2,d.finetune=37*a.readUbyte(),d.volume=a.readUbyte(),d.loop=a.readUshort()<<1,d.repeat=a.readUshort()<<1,a.position+=22,d.pointer=f,f+=d.length,this.samples[b]=d):(this.samples[b]=null,a.position+=28);a.position=950;this.length=a.readUbyte();a.position++;for(b=0;128>b;++b)h=a.readUbyte()<<8,this.track[b]=h,
h>c&&(c=h);a.position=1084;c+=256;this.patterns.length=c;for(b=0;b<c;++b){h=AmigaRow();Object.defineProperties(h,{step:{value:0,writable:!0}});d=Object.seal(h);d.step=h=a.readUint();d.note=h>>16&4095;d.effect=h>>8&15;d.sample=h>>24&240|h>>12&15;d.param=h&255;this.patterns[b]=d;if(31<d.sample||!this.samples[d.sample])d.sample=0;15==d.effect&&31<d.param&&(this.version=2);8==d.effect&&(this.version=3)}this.mixer.store(a,f);for(b=1;32>b;++b)if(d=this.samples[b]){d.loop||4<d.repeat?(d.loopPtr=d.pointer+
d.loop,d.length=d.loop+d.repeat):(d.loopPtr=this.mixer.memory.length,d.repeat=2);f=d.pointer+2;for(a=d.pointer;a<f;++a)this.mixer.memory[a]=0}d=m();d.pointer=d.loopPtr=this.mixer.memory.length;d.length=d.repeat=2;this.samples[0]=d}}},process:{value:function(){var a,c,b,d,f,h=this.voices[0];if(this.tick)this.effects();else if(this.patternDelay)this.effects();else{for(b=this.track[this.trackPos]+this.patternPos;h;){a=h.channel;h.enabled=0;h.step||(a.period=h.period);d=this.patterns[b+h.index];h.step=
d.step;h.effect=d.effect;h.param=d.param;d.sample&&(c=h.sample=this.samples[d.sample],h.pointer=c.pointer,h.length=c.length,h.loopPtr=h.funkWave=c.loopPtr,h.repeat=c.repeat,h.finetune=c.finetune,a.volume=h.volume=c.volume);if(d.note){if(3664==(h.step&4080))h.finetune=37*(h.param&15);else if(3==h.effect||5==h.effect)if(d.note==h.period)h.portaPeriod=0;else{c=h.finetune;for(f=c+37;c<f&&!(d.note>=i[c]);++c);c==f&&f--;0<c&&(f=h.finetune/37>>0&8)&&c--;h.portaPeriod=i[c];h.portaDir=d.note>h.portaPeriod?
0:1}else 9==h.effect&&this.moreEffects(h);for(c=0;37>c&&!(d.note>=i[c]);++c);h.period=i[h.finetune+c];3792==(h.step&4080)?(h.funkSpeed&&this.updateFunk(h),this.extended(h)):(4>h.vibratoWave&&(h.vibratoPos=0),4>h.tremoloWave&&(h.tremoloPos=0),a.enabled=0,a.pointer=h.pointer,a.length=h.length,a.period=h.period,h.enabled=1,this.moreEffects(h))}else this.moreEffects(h);h=h.next}for(h=this.voices[0];h;)a=h.channel,h.enabled&&(a.enabled=1),a.pointer=h.loopPtr,a.length=h.repeat,h=h.next}if(++this.tick==
this.speed&&(this.tick=0,this.patternPos+=4,this.patternDelay&&--this.patternDelay&&(this.patternPos-=4),this.patternBreak&&(this.patternBreak=0,this.patternPos=this.breakPos,this.breakPos=0),256==this.patternPos||this.jumpFlag))this.patternPos=this.breakPos,this.jumpFlag=this.breakPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},effects:{value:function(){for(var a,c,b,d,f,h=this.voices[0];h;){a=h.channel;h.funkSpeed&&this.updateFunk(h);if(0==(h.step&4095))a.period=h.period;
else{switch(h.effect){case 0:f=this.tick%3;if(!f){a.period=h.period;h=h.next;continue}f=1==f?h.param>>4:h.param&15;c=h.finetune;for(b=c+37;c<b;++c)if(h.period>=i[c]){a.period=i[c+f];break}break;case 1:h.period-=h.param;113>h.period&&(h.period=113);a.period=h.period;break;case 2:h.period+=h.param;856<h.period&&(h.period=856);a.period=h.period;break;case 3:case 5:5==h.effect?d=1:(h.portaSpeed=h.param,h.param=0);if(h.portaPeriod)if(h.portaDir?(h.period-=h.portaSpeed,h.period<=h.portaPeriod&&(h.period=
h.portaPeriod,h.portaPeriod=0)):(h.period+=h.portaSpeed,h.period>=h.portaPeriod&&(h.period=h.portaPeriod,h.portaPeriod=0)),h.glissando){c=h.finetune;for(f=c+37;c<f&&!(h.period>=i[c]);++c);c==f&&c--;a.period=i[c]}else a.period=h.period;break;case 4:case 6:if(6==h.effect)d=1;else if(h.param){if(f=h.param&15)h.vibratoParam=h.vibratoParam&240|f;if(f=h.param&240)h.vibratoParam=h.vibratoParam&15|f}b=h.vibratoPos>>2&31;(c=h.vibratoWave&3)?(f=255,b<<=3,1==c&&(f=127<h.vibratoPos?f-b:b)):f=e[b];f=(h.vibratoParam&
15)*f>>this.vibratoDepth;a.period=127<h.vibratoPos?h.period-f:h.period+f;f=h.vibratoParam>>2&60;h.vibratoPos=h.vibratoPos+f&255;break;case 7:a.period=h.period;if(h.param){if(f=h.param&15)h.tremoloParam=h.tremoloParam&240|f;if(f=h.param&240)h.tremoloParam=h.tremoloParam&15|f}b=h.tremoloPos>>2&31;(c=h.tremoloWave&3)?(f=255,b<<=3,1==c&&(f=127<h.tremoloPos?f-b:b)):f=e[b];f=(h.tremoloParam&15)*f>>6;a.volume=127<h.tremoloPos?h.volume-f:h.volume+f;f=h.tremoloParam>>2&60;h.tremoloPos=h.tremoloPos+f&255;break;
case 10:d=1;break;case 14:this.extended(h)}d&&(d=0,f=h.param>>4,h.volume=f?h.volume+f:h.volume-(h.param&15),0>h.volume?h.volume=0:64<h.volume&&(h.volume=64),a.volume=h.volume)}h=h.next}}},moreEffects:{value:function(a){var c=a.channel;a.funkSpeed&&this.updateFunk(a);switch(a.effect){case 9:a.param&&(a.offset=a.param);c=a.offset<<8;c>=a.length?a.length=2:(a.pointer+=c,a.length-=c);break;case 11:this.trackPos=a.param-1;this.breakPos=0;this.jumpFlag=1;break;case 12:a.volume=a.param;64<a.volume&&(a.volume=
64);c.volume=a.volume;break;case 13:this.breakPos=10*(a.param>>4)+(a.param&15);this.breakPos=63<this.breakPos?0:this.breakPos<<2;this.jumpFlag=1;break;case 14:this.extended(a);break;case 15:if(!a.param)break;32>a.param?this.speed=a.param:this.mixer.samplesTick=2.5*this.sampleRate/a.param>>0;this.tick=0}}},extended:{value:function(a){var c=a.channel,b;b=a.param&15;switch(a.param>>4){case 0:this.mixer.filter.active=b;break;case 1:if(this.tick)break;a.period-=b;113>a.period&&(a.period=113);c.period=
a.period;break;case 2:if(this.tick)break;a.period+=b;856<a.period&&(a.period=856);c.period=a.period;break;case 3:a.glissando=b;break;case 4:a.vibratoWave=b;break;case 5:a.finetune=37*b;break;case 6:if(this.tick)break;b?(a.loopCtr?a.loopCtr--:a.loopCtr=b,a.loopCtr&&(this.breakPos=a.loopPos<<2,this.patternBreak=1)):a.loopPos=this.patternPos>>2;break;case 7:a.tremoloWave=b;break;case 8:c=a.length-2;b=this.mixer.memory;for(a=a.loopPtr;a<c;)b[a]=0.5*(b[a]+b[++a]);b[++a]=0.5*(b[a]+b[0]);break;case 9:if(this.tick||
!b||!a.period)break;if(this.tick%b)break;c.enabled=0;c.pointer=a.pointer;c.length=a.length;c.delay=30;c.enabled=1;c.pointer=a.loopPtr;c.length=a.repeat;c.period=a.period;break;case 10:if(this.tick)break;a.volume+=b;64<a.volume&&(a.volume=64);c.volume=a.volume;break;case 11:if(this.tick)break;a.volume-=b;0>a.volume&&(a.volume=0);c.volume=a.volume;break;case 12:this.tick==b&&(c.volume=a.volume=0);break;case 13:if(this.tick!=b||!a.period)break;c.enabled=0;c.pointer=a.pointer;c.length=a.length;c.delay=
30;c.enabled=1;c.pointer=a.loopPtr;c.length=a.repeat;c.period=a.period;break;case 14:if(this.tick||this.patternDelay)break;this.patternDelay=++b;break;case 15:if(this.tick)break;(a.funkSpeed=b)&&this.updateFunk(a)}}},updateFunk:{value:function(a){var c=a.channel,f,d;a.funkPos+=b[a.funkSpeed];128>a.funkPos||(a.funkPos=0,1==this.version?(f=a.pointer+a.sample.realLen-a.repeat,d=a.funkWave+a.repeat,d>f&&(d=a.loopPtr,c.length=a.repeat),c.pointer=a.funkWave=d):(f=a.loopPtr+a.repeat,d=a.funkWave+1,d>=f&&
(d=a.loopPtr),this.mixer.memory[d]=-this.mixer.memory[d]))}}});f.voices[0]=p(0);f.voices[0].next=f.voices[1]=p(1);f.voices[1].next=f.voices[2]=p(2);f.voices[2].next=f.voices[3]=p(3);f.track=new Uint16Array(128);return Object.seal(f)}})();
(function(){function p(b){return Object.create(null,{index:{value:b,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:0,writable:!0},row:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},note:{value:0,writable:!0},noteTimer:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},bendTo:{value:0,writable:!0},bendSpeed:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},
envelopeCtr:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchFallCtr:{value:0,writable:!0},sustainCtr:{value:0,writable:!0},phaseTimer:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveList:{value:0,writable:!0},waveTimer:{value:0,writable:!0},waitCtr:{value:0,writable:!0},initialize:{value:function(){this.sample=this.row=this.step=0;this.samplePtr=-1;this.noteTimer=this.note=this.sampleLen=0;this.period=39321;this.waitCtr=this.waveTimer=this.waveList=
this.wavePos=this.phaseSpeed=this.phaseTimer=this.sustainCtr=this.pitchFallCtr=this.pitchCtr=this.envelopeCtr=this.arpeggioCtr=this.bendSpeed=this.bendTo=this.volume=0}}})}function m(){var b=AmigaSample();Object.defineProperties(b,{waveform:{value:0,writable:!0},arpeggio:{value:null,writable:!0},attackSpeed:{value:0,writable:!0},attackMax:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseMin:{value:0,
writable:!0},phaseShift:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},finetune:{value:0,writable:!0},pitchFall:{value:0,writable:!0}});b.arpeggio=new Uint8Array(16);return Object.seal(b)}var i=[1166,408,908],e=[0,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,
160,151,143,135,127,0,0,0,0,0,0,0,4028,3806,3584,3394,3204,3013,2855,2696,2538,2395,2268,2141,2014,1903,1792,1697,1602,1507,1428,1348,1269,1198,1134,1071,1007,952,896,849,801,754,714,674,635,599,567,536,504,476,448,425,401,377,357,337,310,300,284,268,252,238,224,213,201,189,179,169,159,150,142,134,0,0,0,0,0,0,0,3993,3773,3552,3364,3175,2987,2830,2672,2515,2374,2248,2122,1997,1887,1776,1682,1588,1494,1415,1336,1258,1187,1124,1061,999,944,888,841,794,747,708,668,629,594,562,531,500,472,444,421,397,
374,354,334,315,297,281,266,250,236,222,211,199,187,177,167,158,149,141,133,0,0,0,0,0,0,0,3957,3739,3521,3334,3147,2960,2804,2648,2493,2353,2228,2103,1979,1870,1761,1667,1574,1480,1402,1324,1247,1177,1114,1052,990,935,881,834,787,740,701,662,624,589,557,526,495,468,441,417,394,370,351,331,312,295,279,263,248,234,221,209,197,185,176,166,156,148,140,132,0,0,0,0,0,0,0,3921,3705,3489,3304,3119,2933,2779,2625,2470,2331,2208,2084,1961,1853,1745,1652,1560,1467,1390,1313,1235,1166,1104,1042,981,927,873,826,
780,734,695,657,618,583,552,521,491,464,437,413,390,367,348,329,309,292,276,261,246,232,219,207,195,184,174,165,155,146,138,131,0,0,0,0,0,0,0,3886,3671,3457,3274,3090,2907,2754,2601,2448,2310,2188,2065,1943,1836,1729,1637,1545,1454,1377,1301,1224,1155,1094,1033,972,918,865,819,773,727,689,651,612,578,547,517,486,459,433,410,387,364,345,326,306,289,274,259,243,230,217,205,194,182,173,163,153,145,137,130,0,0,0,0,0,0,0,3851,3638,3426,3244,3062,2880,2729,2577,2426,2289,2168,2047,1926,1819,1713,1622,1531,
1440,1365,1289,1213,1145,1084,1024,963,910,857,811,766,720,683,645,607,573,542,512,482,455,429,406,383,360,342,323,304,287,271,256,241,228,215,203,192,180,171,162,152,144,136,128,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127];window.neoart.S1Player=
function(b){b=AmigaPlayer(b);Object.defineProperties(b,{id:{value:"S1Player"},tracksPtr:{value:null,writable:!0},tracks:{value:[],writable:!0},patternsPtr:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},waveLists:{value:null,writable:!0},speedDef:{value:0,writable:!0},patternDef:{value:0,writable:!0},mix1Speed:{value:0,writable:!0},mix2Speed:{value:0,writable:!0},mix1Dest:{value:0,writable:!0},mix2Dest:{value:0,writable:!0},mix1Source1:{value:0,writable:!0},
mix1Source2:{value:0,writable:!0},mix2Source1:{value:0,writable:!0},mix2Source2:{value:0,writable:!0},doFilter:{value:0,writable:!0},doReset:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},trackEnd:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternEnd:{value:0,writable:!0},patternLen:{value:0,writable:!0},mix1Ctr:{value:0,writable:!0},mix2Ctr:{value:0,writable:!0},mix1Pos:{value:0,writable:!0},mix2Pos:{value:0,writable:!0},
audPtr:{value:0,writable:!0},audLen:{value:0,writable:!0},audPer:{value:0,writable:!0},audVol:{value:0,writable:!0},initialize:{value:function(){var b,a,c=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.trackPos=1;this.trackEnd=0;this.patternPos=-1;this.patternEnd=0;this.patternLen=this.patternDef;for(this.mix2Ctr=this.mix2Pos=this.mix1Ctr=this.mix1Pos=0;c;)c.initialize(),b=this.mixer.channels[c.index],c.channel=b,c.step=this.tracksPtr[c.index],a=this.tracks[c.step],c.row=this.patternsPtr[a.pattern],
c.sample=this.patterns[c.row].sample,b.length=32,b.period=c.period,b.enabled=1,c=c.next}},loader:{value:function(b){for(var a,c,j,d,g,h,e,l,o,n,r,s;8<b.bytesAvailable;)if(l=b.readUshort(),16890==l&&(j=b.readUshort(),l=b.readUshort(),53736==l&&(l=b.readUshort(),65492==l))){s=4076==j?4090:5222==j?5188:j;h=j+b.position-6;break}if(h&&(b.position=h," SID-MON BY R.v.VLIET  (c) 1988 "==b.readString(32))){b.position=h-44;l=b.readUint();for(c=1;4>c;++c)this.tracksPtr[c]=(b.readUint()-l)/6>>0;b.position=h-
8;l=b.readUint();g=b.readUint();g<l&&(g=b.length-h);o=g-l>>2;this.patternsPtr=new Uint32Array(o);b.position=h+l+4;for(c=1;c<o;++c){l=b.readUint()/5>>0;if(0==l){o=c;break}this.patternsPtr[c]=l}this.patternsPtr.length=o;b.position=h-44;l=b.readUint();b.position=h-28;g=(b.readUint()-l)/6>>0;this.tracks.length=g;b.position=h+l;for(c=0;c<g;++c){l=AmigaStep();l.pattern=b.readUint();l.pattern>=o&&(l.pattern=0);b.readByte();l.transpose=b.readByte();if(-99>l.transpose||99<l.transpose)l.transpose=0;this.tracks[c]=
l}b.position=h-24;l=b.readUint();r=b.readUint()-l;for(c=0;32>c;++c)this.mixer.memory[c]=0;this.mixer.store(b,r,h+l);r>>=5;b.position=h-16;l=b.readUint();g=b.readUint()-l+16;j=r+2<<4;this.waveLists=new Uint8Array(g<j?j:g);b.position=h+l;for(c=0;c<j;)this.waveLists[c++]=c>>4,this.waveLists[c++]=255,this.waveLists[c++]=255,this.waveLists[c++]=16,c+=12;for(c=16;c<g;++c)this.waveLists[c]=b.readUbyte();b.position=h-20;b.position=h+b.readUint();this.mix1Source1=b.readUint();this.mix2Source1=b.readUint();
this.mix1Source2=b.readUint();this.mix2Source2=b.readUint();this.mix1Dest=b.readUint();this.mix2Dest=b.readUint();this.patternDef=b.readUint();this.trackLen=b.readUint();this.speedDef=b.readUint();this.mix1Speed=b.readUint();this.mix2Speed=b.readUint();this.mix1Source1>r&&(this.mix1Source1=0);this.mix2Source1>r&&(this.mix2Source1=0);this.mix1Source2>r&&(this.mix1Source2=0);this.mix2Source2>r&&(this.mix2Source2=0);this.mix1Dest>r&&(this.mix1Speed=0);this.mix2Dest>r&&(this.mix2Speed=0);0==this.speedDef&&
(this.speedDef=4);b.position=h-28;j=b.readUint();o=b.readUint()-j>>5;63<o&&(o=63);g=o+1;b.position=h-4;l=b.readUint();if(1==l){b.position=1820;l=b.readUshort();if(19962!=l&&(b.position=1788,l=b.readUshort(),19962!=l)){this.version=0;return}b.position+=b.readUshort();this.samples.length=g+3;for(c=0;3>c;++c)e=m(),e.waveform=16+c,e.length=i[c],e.pointer=this.mixer.store(b,e.length),e.loop=e.loopPtr=0,e.repeat=4,e.volume=64,this.samples[g+c]=e,b.position+=e.length}else this.samples.length=g,b.position=
h+l,a=b.readUint(),n=(a>>5)+15,d=b.position,a+=d;e=m();this.samples[0]=e;b.position=h+j;for(c=1;c<g;++c){e=m();e.waveform=b.readUint();for(j=0;16>j;++j)e.arpeggio[j]=b.readUbyte();e.attackSpeed=b.readUbyte();e.attackMax=b.readUbyte();e.decaySpeed=b.readUbyte();e.decayMin=b.readUbyte();e.sustain=b.readUbyte();b.readByte();e.releaseSpeed=b.readUbyte();e.releaseMin=b.readUbyte();e.phaseShift=b.readUbyte();e.phaseSpeed=b.readUbyte();e.finetune=b.readUbyte();e.pitchFall=b.readByte();5188==s?(e.pitchFall=
e.finetune,e.finetune=0):(15<e.finetune&&(e.finetune=0),e.finetune*=67);e.phaseShift>r&&(e.phaseShift=0,e.phaseSpeed=0);if(15<e.waveform)if(15<n&&e.waveform>n)e.waveform=0;else{l=d+(e.waveform-16<<5);if(l>=b.length)continue;j=b.position;b.position=l;e.pointer=b.readUint();e.loop=b.readUint();e.length=b.readUint();e.name=b.readString(20);0==e.loop||99999==e.loop||199999==e.loop||e.loop>=e.length?(e.loop=0,e.repeat=4090==s?2:4):(e.repeat=e.length-e.loop,e.loop-=e.pointer);e.length-=e.pointer;e.length<
e.loop+e.repeat&&(e.length=e.loop+e.repeat);e.pointer=this.mixer.store(b,e.length,a+e.pointer);e.loopPtr=6>e.repeat||0==e.loop?0:e.pointer+e.loop;b.position=j}else e.waveform>r&&(e.waveform=0);this.samples[c]=e}b.position=h-12;l=b.readUint();g=(b.readUint()-l)/5>>0;this.patterns.length=g;b.position=h+l;for(c=0;c<g;++c)a=AmigaRow(),Object.defineProperties(a,{speed:{value:0,writable:!0}}),a=Object.seal(a),a.note=b.readUbyte(),a.sample=b.readUbyte(),a.effect=b.readUbyte(),a.param=b.readUbyte(),a.speed=
b.readUbyte(),5188==s?(0<a.note&&255>a.note&&(a.note+=469),0<a.effect&&255>a.effect&&(a.effect+=469),59<a.sample&&(a.sample=o+(a.sample-60))):a.sample>o&&(a.sample=0),this.patterns[c]=a;4464==s||4550==s||5188==s?(4464==s&&(this.mix1Speed=this.mix2Speed=0),this.doReset=this.doFilter=0):this.doReset=this.doFilter=1;this.version=1}}},process:{value:function(){var b,a,c,j=this.mixer.memory,d,g;for(g=this.voices[0];g;){b=g.channel;this.audPtr=-1;this.audLen=this.audPer=this.audVol=0;if(0==this.tick)if(this.patternEnd&&
(this.trackEnd?g.step=this.tracksPtr[g.index]:g.step++,c=this.tracks[g.step],g.row=this.patternsPtr[c.pattern],this.doReset&&(g.noteTimer=0)),0==g.noteTimer){d=this.patterns[g.row];0==d.sample?d.note&&(g.noteTimer=d.speed,g.waitCtr&&(a=this.samples[g.sample],this.audPtr=a.pointer,this.audLen=a.length,g.samplePtr=a.loopPtr,g.sampleLen=a.repeat,g.waitCtr=1,b.enabled=0)):(a=this.samples[d.sample],g.waitCtr&&(b.enabled=g.waitCtr=0),15<a.waveform?(this.audPtr=a.pointer,this.audLen=a.length,g.samplePtr=
a.loopPtr,g.sampleLen=a.repeat,g.waitCtr=1):(g.wavePos=0,g.waveList=a.waveform,c=g.waveList<<4,this.audPtr=this.waveLists[c]<<5,this.audLen=32,g.waveTimer=this.waveLists[++c]),g.noteTimer=d.speed,g.sample=d.sample,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=0);if(d.note&&(g.noteTimer=d.speed,255!=d.note))switch(a=this.samples[g.sample],c=this.tracks[g.step],g.note=d.note+c.transpose,g.period=this.audPer=e[1+a.finetune+g.note],g.phaseSpeed=a.phaseSpeed,g.bendSpeed=g.volume=0,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=
0,d.effect){case 0:if(0==d.param)break;a.attackSpeed=d.param;a.attackMax=d.param;g.waveTimer=0;break;case 2:this.speed=d.param;g.waveTimer=0;break;case 3:this.patternLen=d.param;g.waveTimer=0;break;default:g.bendTo=d.effect+c.transpose,g.bendSpeed=d.param}g.row++}else g.noteTimer--;a=this.samples[g.sample];this.audVol=g.volume;switch(g.envelopeCtr){case 0:this.audVol+=a.attackSpeed;this.audVol>a.attackMax&&(this.audVol=a.attackMax,g.envelopeCtr+=2);break;case 2:this.audVol-=a.decaySpeed;if(this.audVol<=
a.decayMin||-256>this.audVol)this.audVol=a.decayMin,g.envelopeCtr+=2,g.sustainCtr=a.sustain;break;case 4:g.sustainCtr--;if(0==g.sustainCtr||-256==g.sustainCtr)g.envelopeCtr+=2;break;case 6:if(this.audVol-=a.releaseSpeed,this.audVol<=a.releaseMin||-256>this.audVol)this.audVol=a.releaseMin,g.envelopeCtr=8}g.volume=this.audVol;g.arpeggioCtr=++g.arpeggioCtr&15;c=a.finetune+a.arpeggio[g.arpeggioCtr]+g.note;g.period=this.audPer=e[c];if(g.bendSpeed&&(d=e[a.finetune+g.bendTo],c=~g.bendSpeed+1,-128>c&&(c&=
255),g.pitchCtr+=c,g.period+=g.pitchCtr,0>c&&g.period<=d||0<c&&g.period>=d))g.note=g.bendTo,g.period=d,g.bendSpeed=0,g.pitchCtr=0;a.phaseShift&&(g.phaseSpeed?g.phaseSpeed--:(g.phaseTimer=++g.phaseTimer&31,c=(a.phaseShift<<5)+g.phaseTimer,g.period+=j[c]>>2));g.pitchFallCtr-=a.pitchFall;-256>g.pitchFallCtr&&(g.pitchFallCtr+=256);g.period+=g.pitchFallCtr;0==g.waitCtr&&(g.waveTimer?g.waveTimer--:16>g.wavePos&&(c=(g.waveList<<4)+g.wavePos,d=this.waveLists[c++],255==d?g.wavePos=this.waveLists[c]&254:(this.audPtr=
d<<5,g.waveTimer=this.waveLists[c],g.wavePos+=2)));-1<this.audPtr&&(b.pointer=this.audPtr);0!=this.audPer&&(b.period=g.period);0!=this.audLen&&(b.length=this.audLen);b.volume=a.volume?a.volume:this.audVol>>2;b.enabled=1;g=g.next}this.trackEnd=this.patternEnd=0;++this.tick>this.speed&&(this.tick=0,++this.patternPos==this.patternLen&&(this.patternPos=0,this.patternEnd=1,++this.trackPos==this.trackLen&&(this.trackPos=this.trackEnd=this.mixer.complete=1)));if(this.mix1Speed){if(0==this.mix1Ctr){this.mix1Ctr=
this.mix1Speed;c=this.mix1Pos=++this.mix1Pos&31;b=(this.mix1Dest<<5)+31;g=(this.mix1Source1<<5)+31;d=this.mix1Source2<<5;for(a=31;-1<a;--a)j[b--]=j[g--]+j[d+c]>>1,c=--c&31}this.mix1Ctr--}if(this.mix2Speed){if(0==this.mix2Ctr){this.mix2Ctr=this.mix2Speed;c=this.mix2Pos=++this.mix2Pos&31;b=(this.mix2Dest<<5)+31;g=(this.mix2Source1<<5)+31;d=this.mix2Source2<<5;for(a=31;-1<a;--a)j[b--]=j[g--]+j[d+c]>>1,c=--c&31}this.mix2Ctr--}this.doFilter&&(c=this.mix1Pos+32,j[c]=~j[c]+1);for(g=this.voices[0];g;)b=g.channel,
1==g.waitCtr?g.waitCtr++:2==g.waitCtr&&(g.waitCtr++,b.pointer=g.samplePtr,b.length=g.sampleLen),g=g.next}}});b.voices[0]=p(0);b.voices[0].next=b.voices[1]=p(1);b.voices[1].next=b.voices[2]=p(2);b.voices[2].next=b.voices[3]=p(3);b.tracksPtr=new Uint32Array(4);return Object.seal(b)}})();
(function(){function p(e){return Object.create(null,{index:{value:e,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},instr:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},instrument:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},original:{value:0,writable:!0},adsrPos:{value:0,writable:!0},
sustainCtr:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendCtr:{value:0,writable:!0},noteSlideTo:{value:0,writable:!0},noteSlideSpeed:{value:0,writable:!0},waveCtr:{value:0,writable:!0},wavePos:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},speed:{value:0,writable:!0},initialize:{value:function(){this.sample=this.instr=this.row=this.step=null;this.speed=this.vibratoPos=this.vibratoCtr=
this.arpeggioPos=this.arpeggioCtr=this.wavePos=this.waveCtr=this.noteSlideSpeed=this.noteSlideTo=this.pitchBendCtr=this.pitchBend=this.sustainCtr=this.adsrPos=this.original=this.volume=this.period=this.note=this.instrument=this.pattern=this.enabled=0}}})}function m(){return Object.create(null,{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},waveDelay:{value:0,writable:!0},waveSpeed:{value:0,writable:!0},arpeggio:{value:0,writable:!0},arpeggioLen:{value:0,writable:!0},arpeggioDelay:{value:0,
writable:!0},arpeggioSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoLen:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendDelay:{value:0,writable:!0},attackMax:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseMin:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0}})}var i=[0,5760,5424,5120,
4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95];window.neoart.S2Player=function(e){e=AmigaPlayer(e);Object.defineProperties(e,{id:{value:"S2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},instruments:{value:[],writable:!0},
samples:{value:[],writable:!0},arpeggios:{value:null,writable:!0},vibratos:{value:null,writable:!0},waves:{value:null,writable:!0},length:{value:0,writable:!0},speedDef:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},arpeggioFx:{value:null,writable:!0},arpeggioPos:{value:0,writable:!0},initialize:{value:function(){var b=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.patternPos=
this.trackPos=0;for(this.patternLen=64;b;)b.initialize(),b.channel=this.mixer.channels[b.index],b.instr=this.instruments[0],this.arpeggioFx[b.index]=0,b=b.next}},loader:{value:function(b){var f=0,a=0,c,e,d,g=0,h,i,l;b.position=58;if("SIDMON II - THE MIDI VERSION"==b.readString(28)){b.position=2;this.length=b.readUbyte();this.speedDef=b.readUbyte();this.samples.length=b.readUshort()>>6;b.position=14;d=b.readUint();this.tracks.length=d;for(b.position=90;a<d;++a)c=AmigaStep(),Object.defineProperties(c,
{soundTranspose:{value:0,writable:!0}}),c=Object.seal(c),c.pattern=b.readUbyte(),c.pattern>f&&(f=c.pattern),this.tracks[a]=c;for(a=0;a<d;++a)c=this.tracks[a],c.transpose=b.readByte();for(a=0;a<d;++a)c=this.tracks[a],c.soundTranspose=b.readByte();c=b.position;b.position=26;d=b.readUint()>>5;this.instruments.length=++d;b.position=c;this.instruments[0]=m();for(a=0;++a<d;)c=m(),c.wave=b.readUbyte()<<4,c.waveLen=b.readUbyte(),c.waveSpeed=b.readUbyte(),c.waveDelay=b.readUbyte(),c.arpeggio=b.readUbyte()<<
4,c.arpeggioLen=b.readUbyte(),c.arpeggioSpeed=b.readUbyte(),c.arpeggioDelay=b.readUbyte(),c.vibrato=b.readUbyte(),c.vibratoLen=b.readUbyte(),c.vibratoSpeed=b.readUbyte(),c.vibratoDelay=b.readUbyte(),c.pitchBend=b.readByte(),c.pitchBendDelay=b.readUbyte(),b.readByte(),b.readByte(),c.attackMax=b.readUbyte(),c.attackSpeed=b.readUbyte(),c.decayMin=b.readUbyte(),c.decaySpeed=b.readUbyte(),c.sustain=b.readUbyte(),c.releaseMin=b.readUbyte(),c.releaseSpeed=b.readUbyte(),this.instruments[a]=c,b.position+=
9;c=b.position;b.position=30;d=b.readUint();this.waves=new Uint8Array(d);b.position=c;for(a=0;a<d;++a)this.waves[a]=b.readUbyte();c=b.position;b.position=34;d=b.readUint();this.arpeggios=new Int8Array(d);b.position=c;for(a=0;a<d;++a)this.arpeggios[a]=b.readByte();c=b.position;b.position=38;d=b.readUint();this.vibratos=new Int8Array(d);b.position=c;for(a=0;a<d;++a)this.vibratos[a]=b.readByte();d=this.samples.length;for(a=c=0;a<d;++a)i=AmigaSample(),Object.defineProperties(i,{negStart:{value:0,writable:!0},
negLen:{value:0,writable:!0},negSpeed:{value:0,writable:!0},negDir:{value:0,writable:!0},negOffset:{value:0,writable:!0},negPos:{value:0,writable:!0},negCtr:{value:0,writable:!0},negToggle:{value:0,writable:!0}}),i=Object.seal(i),b.readUint(),i.length=b.readUshort()<<1,i.loop=b.readUshort()<<1,i.repeat=b.readUshort()<<1,i.negStart=c+(b.readUshort()<<1),i.negLen=b.readUshort()<<1,i.negSpeed=b.readUshort(),i.negDir=b.readUshort(),i.negOffset=b.readShort(),i.negPos=b.readUint(),i.negCtr=b.readUshort(),
b.position+=6,i.name=b.readString(32),i.pointer=c,i.loopPtr=c+i.loop,c+=i.length,this.samples[a]=i;i=c;d=++f;f=new Uint16Array(++f);for(a=0;a<d;++a)f[a]=b.readUshort();c=b.position;b.position=50;d=b.readUint();this.patterns=[];b.position=c;e=1;for(a=0;a<d;++a)h=AmigaRow(),Object.defineProperties(h,{speed:{value:0,writable:!0}}),h=Object.seal(h),(l=b.readByte())?0>l?h.speed=~l:112>l?(h.note=l,l=b.readByte(),a++,0>l?h.speed=~l:112>l?(h.sample=l,l=b.readByte(),a++,0>l?h.speed=~l:(h.effect=l,h.param=
b.readUbyte(),a++)):(h.effect=l,h.param=b.readUbyte(),a++)):(h.effect=l,h.param=b.readUbyte(),a++):(h.effect=b.readByte(),h.param=b.readUbyte(),a+=2),this.patterns[g++]=h,c+f[e]==b.position&&(f[e++]=g);f[e]=this.patterns.length;0!=(b.position&1)&&b.position++;this.mixer.store(b,i);d=this.tracks.length;for(a=0;a<d;++a)c=this.tracks[a],c.pattern=f[c.pattern];this.length++;this.version=2}}},process:{value:function(){var b,f,a,c,e,d=this.voices[0];this.arpeggioPos=++this.arpeggioPos&3;if(++this.tick>=
this.speed){for(this.tick=0;d;)b=d.channel,d.enabled=d.note=0,this.patternPos||(d.step=this.tracks[this.trackPos+d.index*this.length],d.pattern=d.step.pattern,d.speed=0),0>--d.speed&&(d.row=a=this.patterns[d.pattern++],d.speed=a.speed,a.note&&(d.enabled=1,d.note=a.note+d.step.transpose,b.enabled=0)),d.pitchBend=0,d.note&&(d.waveCtr=d.sustainCtr=0,d.arpeggioCtr=d.arpeggioPos=0,d.vibratoCtr=d.vibratoPos=0,d.pitchBendCtr=d.noteSlideSpeed=0,d.adsrPos=4,d.volume=0,a.sample&&(d.instrument=a.sample,d.instr=
this.instruments[d.instrument+d.step.soundTranspose],d.sample=this.samples[this.waves[d.instr.wave]]),d.original=d.note+this.arpeggios[d.instr.arpeggio],b.period=d.period=i[d.original],c=d.sample,b.pointer=c.pointer,b.length=c.length,b.enabled=d.enabled,b.pointer=c.loopPtr,b.length=c.repeat),d=d.next;++this.patternPos==this.patternLen&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}for(d=this.voices[0];d;){if(d.sample&&(c=d.sample,!c.negToggle))if(c.negToggle=
1,c.negCtr)c.negCtr=--c.negCtr&31;else{c.negCtr=c.negSpeed;if(!c.negDir){d=d.next;continue}e=c.negStart=c.negPos;this.mixer.memory[e]=~this.mixer.memory[e];c.negPos+=c.negOffset;e=c.negLen-1;0>c.negPos?2==c.negDir?c.negPos=e:(c.negOffset=~c.negOffset+1,c.negPos+=c.negOffset):e<c.negPos&&(1==c.negDir?c.negPos=0:(c.negOffset=~c.negOffset+1,c.negPos+=c.negOffset))}d=d.next}for(d=this.voices[0];d;)d.sample&&(d.sample.negToggle=0),d=d.next;for(d=this.voices[0];d;){b=d.channel;f=d.instr;switch(d.adsrPos){case 4:d.volume+=
f.attackSpeed;f.attackMax<=d.volume&&(d.volume=f.attackMax,d.adsrPos--);break;case 3:f.decaySpeed?(d.volume-=f.decaySpeed,f.decayMin>=d.volume&&(d.volume=f.decayMin,d.adsrPos--)):d.adsrPos--;break;case 2:d.sustainCtr==f.sustain?d.adsrPos--:d.sustainCtr--;break;case 1:d.volume-=f.releaseSpeed,f.releaseMin>=d.volume&&(d.volume=f.releaseMin,d.adsrPos--)}b.volume=d.volume>>2;f.waveLen&&(d.waveCtr==f.waveDelay?(d.waveCtr=f.waveDelay-f.waveSpeed,d.wavePos==f.waveLen?d.wavePos=0:d.wavePos++,d.sample=c=this.samples[this.waves[f.wave+
d.wavePos]],b.pointer=c.pointer,b.length=c.length):d.waveCtr++);f.arpeggioLen&&(d.arpeggioCtr==f.arpeggioDelay?(d.arpeggioCtr=f.arpeggioDelay-f.arpeggioSpeed,d.arpeggioPos==f.arpeggioLen?d.arpeggioPos=0:d.arpeggioPos++,e=d.original+this.arpeggios[f.arpeggio+d.arpeggioPos],d.period=i[e]):d.arpeggioCtr++);a=d.row;if(!this.tick)switch(a.effect){case 112:this.arpeggioFx[0]=a.param>>4;this.arpeggioFx[2]=a.param&15;e=d.original+this.arpeggioFx[this.arpeggioPos];d.period=i[e];break;case 113:d.pitchBend=
~a.param+1;break;case 114:d.pitchBend=a.param;break;case 115:if(0!=d.adsrPos)break;0!=d.instrument&&(d.volume=f.attackMax);d.volume+=a.param<<2;256<=d.volume&&(d.volume=-1);break;case 116:if(0!=d.adsrPos)break;0!=d.instrument&&(d.volume=f.attackMax);d.volume-=a.param<<2;0>d.volume&&(d.volume=0)}switch(a.effect){case 117:f.attackMax=a.param;f.attackSpeed=a.param;break;case 118:this.patternLen=a.param;break;case 119:b.volume=a.param;d.volume=a.param<<2;255<=d.volume&&(d.volume=255);break;case 120:if(e=
a.param&15)this.speed=e}f.vibratoLen&&(d.vibratoCtr==f.vibratoDelay?(d.vibratoCtr=f.vibratoDelay-f.vibratoSpeed,d.vibratoPos==f.vibratoLen?d.vibratoPos=0:d.vibratoPos++,d.period+=this.vibratos[f.vibrato+d.vibratoPos]):d.vibratoCtr++);f.pitchBend&&(d.pitchBendCtr==f.pitchBendDelay?d.pitchBend+=f.pitchBend:d.pitchBendCtr++);a.param&&a.effect&&112>a.effect&&(d.noteSlideTo=i[a.effect+d.step.transpose],e=a.param,0>d.noteSlideTo-d.period&&(e=~e+1),d.noteSlideSpeed=e);if(d.noteSlideTo&&d.noteSlideSpeed&&
(d.period+=d.noteSlideSpeed,0>d.noteSlideSpeed&&d.period<d.noteSlideTo||0<d.noteSlideSpeed&&d.period>d.noteSlideTo))d.noteSlideSpeed=0,d.period=d.noteSlideTo;d.period+=d.pitchBend;95>d.period?d.period=95:5760<d.period&&(d.period=5760);b.period=d.period;d=d.next}}}});e.voices[0]=p(0);e.voices[0].next=e.voices[1]=p(1);e.voices[1].next=e.voices[2]=p(2);e.voices[2].next=e.voices[3]=p(3);e.arpeggioFx=new Uint8Array(4);return Object.seal(e)}})();
(function(){function p(i){return Object.create(null,{index:{value:i,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},last:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.param=this.effect=this.last=this.period=this.enabled=0}}})}var m=[856,808,762,720,678,640,604,570,538,508,480,453,428,
404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0];window.neoart.STPlayer=function(i){i=AmigaPlayer(i);Object.defineProperties(i,{id:{value:"STPlayer"},standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},force:{set:function(e){1>e?
e=1:4<e&&(e=4);this.version=e}},ntsc:{set:function(e){this.standard=e;this.frequency(e);3>this.version&&(e=(e?20.44952532:20.637767904)*(this.sampleRate/1E3)/120,this.mixer.samplesTick=(240-this.tempo)*e>>0)}},initialize:{value:function(){var e=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;e;)e.initialize(),e.channel=this.mixer.channels[e.index],e.sample=this.samples[0],e=e.next}},loader:{value:function(e){var b=0,f,a,c=0,j=0,d;
if(!(1626>e.length)){this.title=e.readString(20);c+=this.isLegal(this.title);this.version=1;e.position=42;for(f=1;16>f;++f)(d=e.readUshort())?(a=AmigaSample(),e.position-=24,a.name=e.readString(22),a.length=d<<1,e.position+=3,a.volume=e.readUbyte(),a.loop=e.readUshort(),a.repeat=e.readUshort()<<1,e.position+=22,a.pointer=j,j+=a.length,this.samples[f]=a,c+=this.isLegal(a.name),9999<a.length&&(this.version=3)):(this.samples[f]=null,e.position+=28);e.position=470;this.length=e.readUbyte();this.tempo=
e.readUbyte();for(f=0;128>f;++f)d=e.readUbyte()<<8,16384<d&&c--,this.track[f]=d,d>b&&(b=d);e.position=600;b+=256;this.patterns.length=b;f=e.length-j-600>>2;b>f&&(b=f);for(f=0;f<b;++f){a=AmigaRow();a.note=e.readUshort();d=e.readUbyte();a.param=e.readUbyte();a.effect=d&15;a.sample=d>>4;this.patterns[f]=a;2<a.effect&&11>a.effect&&c--;a.note&&(113>a.note||856<a.note)&&c--;if(a.sample&&(15<a.sample||!this.samples[a.sample]))15<a.sample&&c--,a.sample=0;if(2<a.effect||!a.effect&&0!=a.param)this.version=
2;if(11==a.effect||13==a.effect)this.version=4}this.mixer.store(e,j);for(f=1;16>f;++f)if(a=this.samples[f]){a.loop?(a.loopPtr=a.pointer+a.loop,a.pointer=a.loopPtr,a.length=a.repeat):(a.loopPtr=this.mixer.memory.length,a.repeat=2);j=a.pointer+4;for(e=a.pointer;e<j;++e)this.mixer.memory[e]=0}a=AmigaSample();a.pointer=a.loopPtr=this.mixer.memory.length;a.length=a.repeat=2;this.samples[0]=a;1>c&&(this.version=0)}}},process:{value:function(){var e,b,f,a=this.voices[0];if(this.tick)for(;a;){if(a.param)if(e=
a.channel,1==this.version)1==a.effect?this.arpeggio(a):2==a.effect&&(f=a.param>>4,a.period=f?a.period+f:a.period-(a.param&15),e.period=a.period);else{switch(a.effect){case 0:this.arpeggio(a);break;case 1:a.period-=a.param&15;113>a.period&&(a.period=113);e.period=a.period;break;case 2:a.period+=a.param&15,856<a.period&&(a.period=856),e.period=a.period}if(2!=(this.version&2)){a=a.next;continue}switch(a.effect){case 12:e.volume=a.param;break;case 13:this.mixer.filter.active=0;break;case 14:this.speed=
a.param&15}}a=a.next}else for(f=this.track[this.trackPos]+this.patternPos;a;){e=a.channel;a.enabled=0;b=this.patterns[f+a.index];a.period=b.note;a.effect=b.effect;a.param=b.param;b.sample?(b=a.sample=this.samples[b.sample],e.volume=2==(this.version&2)&&12==a.effect?a.param:b.volume):b=a.sample;a.period&&(a.enabled=1,e.enabled=0,e.pointer=b.pointer,e.length=b.length,e.period=a.last=a.period);a.enabled&&(e.enabled=1);e.pointer=b.loopPtr;e.length=b.repeat;if(!(4>this.version))switch(a.effect){case 11:this.trackPos=
a.param-1;this.jumpFlag^=1;break;case 12:e.volume=a.param;break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=a.param^1;break;case 15:if(!a.param)break;this.speed=a.param&15;this.tick=0}a=a.next}if(++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag))this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1)}},arpeggio:{value:function(e){var b=e.channel,f=0,a=this.tick%3;if(a){for(a=1==a?e.param>>
4:e.param&15;e.last!=m[f];)f++;b.period=m[f+a]}else b.period=e.last}},isLegal:{value:function(e){var b,f=0,a=e.length;if(!a)return 0;for(;f<a;++f)if((b=e.charCodeAt(f))&&(32>b||127<b))return 0;return 1}}});i.voices[0]=p(0);i.voices[0].next=i.voices[1]=p(1);i.voices[1].next=i.voices[2]=p(2);i.voices[2].next=i.voices[3]=p(3);i.track=new Uint16Array(128);return Object.seal(i)}})();
(function(){function p(a){a=Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},flags:{value:0,writable:!0},delay:{value:0,writable:!0},channel:{value:null,writable:!0},patternLoop:{value:0,writable:!0},patternLoopRow:{value:0,writable:!0},playing:{value:null,writable:!0},note:{value:0,writable:!0},keyoff:{value:0,writable:!0},period:{value:0,writable:!0},finetune:{value:0,writable:!0},arpDelta:{value:0,writable:!0},vibDelta:{value:0,writable:!0},instrument:{value:null,writable:!0},
autoVibratoPos:{value:0,writable:!0},autoSweep:{value:0,writable:!0},autoSweepPos:{value:0,writable:!0},sample:{value:null,writable:!0},sampleOffset:{value:0,writable:!0},volume:{value:0,writable:!0},volEnabled:{value:0,writable:!0},volEnvelope:{value:null,writable:!0},volDelta:{value:0,writable:!0},volSlide:{value:0,writable:!0},volSlideMaster:{value:0,writable:!0},fineSlideU:{value:0,writable:!0},fineSlideD:{value:0,writable:!0},fadeEnabled:{value:0,writable:!0},fadeDelta:{value:0,writable:!0},
fadeVolume:{value:0,writable:!0},panning:{value:0,writable:!0},panEnabled:{value:0,writable:!0},panEnvelope:{value:null,writable:!0},panSlide:{value:0,writable:!0},portaU:{value:0,writable:!0},portaD:{value:0,writable:!0},finePortaU:{value:0,writable:!0},finePortaD:{value:0,writable:!0},xtraPortaU:{value:0,writable:!0},xtraPortaD:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},glissPeriod:{value:0,writable:!0},vibratoPos:{value:0,
writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoReset:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloSpeed:{value:0,writable:!0},tremoloDepth:{value:0,writable:!0},waveControl:{value:0,writable:!0},tremorPos:{value:0,writable:!0},tremorOn:{value:0,writable:!0},tremorOff:{value:0,writable:!0},tremorVolume:{value:0,writable:!0},retrigx:{value:0,writable:!0},retrigy:{value:0,writable:!0},reset:{value:function(){this.volume=this.sample.volume;this.panning=
this.sample.panning;this.finetune=this.sample.finetune>>3<<2;this.fadeDelta=this.fadeEnabled=this.volDelta=this.keyoff=0;this.fadeVolume=65536;this.autoVibratoPos=0;this.autoSweep=1;this.vibratoReset=this.vibDelta=this.autoSweepPos=0;4>(this.waveControl&15)&&(this.vibratoPos=0);4>this.waveControl>>4&&(this.tremoloPos=0)}},autoVibrato:{value:function(){var a;this.autoVibratoPos=this.autoVibratoPos+this.playing.vibratoSpeed&255;switch(this.playing.vibratoType){case 0:a=g[this.autoVibratoPos];break;
case 1:a=128>this.autoVibratoPos?-64:64;break;case 2:a=(64+(this.autoVibratoPos>>1)&127)-64;break;case 3:a=(64-(this.autoVibratoPos>>1)&127)-64}a*=this.playing.vibratoDepth;this.autoSweep&&(this.playing.vibratoSweep?this.autoSweepPos>this.playing.vibratoSweep?(this.autoSweepPos&2&&(a*=this.autoSweepPos/this.playing.vibratoSweep),this.autoSweep=0):a*=++this.autoSweepPos/this.playing.vibratoSweep:this.autoSweep=0);this.flags|=j;return a>>6}},tonePortamento:{value:function(){this.glissPeriod||(this.glissPeriod=
this.period);this.period<this.portaPeriod?(this.glissPeriod+=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period>=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0)):this.period>this.portaPeriod&&(this.glissPeriod-=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period<=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0));
this.flags|=j}},tremolo:{value:function(){var a=255,c=this.tremoloPos&31;switch(this.waveControl>>4&3){case 0:a=h[c];break;case 1:a=c<<3}this.volDelta=a*this.tremoloDepth>>6;31<this.tremoloPos&&(this.volDelta=-this.volDelta);this.tremoloPos=this.tremoloPos+this.tremoloSpeed&63;this.flags|=d}},tremor:{value:function(){this.tremorPos==this.tremorOn?(this.tremorVolume=this.volume,this.volume=0):(this.tremorPos=0,this.volume=this.tremorVolume);this.flags|=d;this.tremorPos++}},vibrato:{value:function(){var a=
255,c=this.vibratoPos&31;switch(this.waveControl&3){case 0:a=h[c];break;case 1:a=c<<3,31<this.vibratoPos&&(a=255-a)}this.vibDelta=a*this.vibratoDepth>>7;31<this.vibratoPos&&(this.vibDelta=-this.vibDelta);this.vibratoPos=this.vibratoPos+this.vibratoSpeed&63;this.flags|=j}}});a.volEnvelope=i();a.panEnvelope=i();return Object.seal(a)}function m(){return Object.create(null,{points:{value:[],writable:!0},total:{value:0,writable:!0},sustain:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopEnd:{value:0,
writable:!0},flags:{value:0,writable:!0}})}function i(){return Object.create(null,{value:{value:0,writable:!0},position:{value:0,writable:!0},frame:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},stopped:{value:0,writable:!0},reset:{value:function(){this.stopped=this.fraction=this.delta=this.frame=this.position=this.value=0}}})}function e(){var a=Object.create(null,{name:{value:"",writable:!0},samples:{value:[],writable:!0},noteSamples:{value:null,writable:!0},fadeout:{value:0,
writable:!0},volData:{value:null,writable:!0},volEnabled:{value:0,writable:!0},panData:{value:null,writable:!0},panEnabled:{value:0,writable:!0},vibratoType:{value:0,writable:!0},vibratoSweep:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0}});a.noteSamples=new Uint8Array(96);a.volData=m();a.panData=m();return Object.seal(a)}function b(a,c){var b=Object.create(null,{rows:{value:[],writable:!0},length:{value:0,writable:!0},size:{value:0,writable:!0}});b.rows.length=
b.size=a*c;b.length=a;return Object.seal(b)}function f(a,c){var b=Object.create(null,{frame:{value:0,writable:!0},value:{value:0,writable:!0}});b.frame=a||0;b.value=c||0;return Object.seal(b)}function a(){return Object.create(null,{note:{value:0,writable:!0},instrument:{value:0,writable:!0},volume:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}function c(){var a=SBSample();Object.defineProperties(a,{finetune:{value:0,writable:!0},panning:{value:0,writable:!0},relative:{value:0,
writable:!0}});return Object.seal(a)}var j=1,d=2,g=[0,-2,-3,-5,-6,-8,-9,-11,-12,-14,-16,-17,-19,-20,-22,-23,-24,-26,-27,-29,-30,-32,-33,-34,-36,-37,-38,-39,-41,-42,-43,-44,-45,-46,-47,-48,-49,-50,-51,-52,-53,-54,-55,-56,-56,-57,-58,-59,-59,-60,-60,-61,-61,-62,-62,-62,-63,-63,-63,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-63,-63,-63,-62,-62,-62,-61,-61,-60,-60,-59,-59,-58,-57,-56,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-39,-38,-37,-36,-34,-33,-32,-30,-29,-27,-26,-24,-23,-22,
-20,-19,-17,-16,-14,-12,-11,-9,-8,-6,-5,-3,-2,0,2,3,5,6,8,9,11,12,14,16,17,19,20,22,23,24,26,27,29,30,32,33,34,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,56,57,58,59,59,60,60,61,61,62,62,62,63,63,63,64,64,64,64,64,64,64,64,64,64,64,63,63,63,62,62,62,61,61,60,60,59,59,58,57,56,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,39,38,37,36,34,33,32,30,29,27,26,24,23,22,20,19,17,16,14,12,11,9,8,6,5,3,2],h=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,
212,197,180,161,141,120,97,74,49,24],q=[0,0.04417,0.062489,0.076523,0.088371,0.098821,0.108239,0.116927,0.124977,0.132572,0.139741,0.146576,0.153077,0.159335,0.16535,0.171152,0.176772,0.18221,0.187496,0.19263,0.197643,0.202503,0.207273,0.211951,0.216477,0.220943,0.225348,0.229631,0.233854,0.237985,0.242056,0.246066,0.249985,0.253873,0.25767,0.261437,0.265144,0.268819,0.272404,0.275989,0.279482,0.282976,0.286409,0.289781,0.293153,0.296464,0.299714,0.302965,0.306185,0.309344,0.312473,0.315602,0.318671,
0.321708,0.324746,0.327754,0.3307,0.333647,0.336563,0.339449,0.342305,0.345161,0.347986,0.350781,0.353545,0.356279,0.359013,0.361717,0.364421,0.367094,0.369737,0.37238,0.374992,0.377574,0.380157,0.382708,0.38526,0.387782,0.390303,0.392794,0.395285,0.397746,0.400176,0.402606,0.405037,0.407437,0.409836,0.412206,0.414576,0.416915,0.419254,0.421563,0.423841,0.42618,0.428458,0.430737,0.432985,0.435263,0.437481,0.439729,0.441916,0.444134,0.446321,0.448508,0.450665,0.452852,0.455009,0.457136,0.459262,0.461389,
0.463485,0.465611,0.467708,0.469773,0.471839,0.473935,0.47597,0.478036,0.480072,0.482077,0.484112,0.486117,0.488122,0.490127,0.492101,0.494106,0.496051,0.498025,0.5,0.501944,0.503888,0.505802,0.507746,0.50966,0.511574,0.513488,0.515371,0.517255,0.519138,0.521022,0.522905,0.524758,0.526611,0.528465,0.530318,0.53214,0.533993,0.535816,0.537639,0.539462,0.541254,0.543046,0.544839,0.546631,0.548423,0.550216,0.551978,0.553739,0.555501,0.557263,0.558995,0.560757,0.562489,0.56422,0.565952,0.567683,0.569384,
0.571116,0.572817,0.574518,0.57622,0.57789,0.579592,0.581262,0.582964,0.584634,0.586305,0.587946,0.589617,0.591257,0.592928,0.594568,0.596209,0.597849,0.599459,0.6011,0.60271,0.60435,0.60596,0.60757,0.60915,0.61076,0.61237,0.61395,0.61556,0.617139,0.618719,0.620268,0.621848,0.623428,0.624977,0.626557,0.628106,0.629655,0.631205,0.632754,0.634303,0.635822,0.637372,0.63889,0.64044,0.641959,0.643478,0.644966,0.646485,0.648004,0.649523,0.651012,0.6525,0.653989,0.655477,0.656966,0.658454,0.659943,0.661431,
0.66289,0.664378,0.665836,0.667294,0.668783,0.670241,0.671699,0.673127,0.674585,0.676043,0.677471,0.678929,0.680357,0.681785,0.683213,0.684641,0.686068,0.687496,0.688894,0.690321,0.691749,0.693147,0.694574,0.695972,0.697369,0.698767,0.700164,0.701561,0.702928,0.704326,0.705723,0.70711],l=[0,0.005863,0.013701,0.021569,0.029406,0.037244,0.045082,0.052919,0.060757,0.068625,0.076463,0.0843,0.092138,0.099976,0.107844,0.115681,0.123519,0.131357,0.139194,0.147032,0.1549,0.162738,0.170575,0.178413,0.186251,
0.194119,0.201956,0.209794,0.217632,0.225469,0.233307,0.241175,0.249013,0.25685,0.264688,0.272526,0.280394,0.288231,0.296069,0.303907,0.311744,0.319582,0.32745,0.335288,0.343125,0.350963,0.3588,0.366669,0.374506,0.382344,0.390182,0.398019,0.405857,0.413725,0.421563,0.4294,0.437238,0.445076,0.452944,0.460781,0.468619,0.476457,0.484294,0.492132,0.5],o=[29024,27392,25856,24384,23040,21696,20480,19328,18240,17216,16256,15360,14512,13696,12928,12192,11520,10848,10240,9664,9120,8608,8128,7680,7256,6848,
6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3628,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1814,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,227,214,202,190,180,169,160,151,142,134,127,120,113,107,101,95,90,85,80,75,71,67,63,60,57,53,50,48,45,42,40,38,36,34,32,30,28];window.neoart.F2Player=function(g){g=SBPlayer(g);Object.defineProperties(g,{id:{value:"F2Player"},patterns:{value:[],
writable:!0},instruments:{value:[],writable:!0},voices:{value:[],writable:!0},linear:{value:0,writable:!0},complete:{value:0,writable:!0},order:{value:0,writable:!0},position:{value:0,writable:!0},nextOrder:{value:0,writable:!0},nextPosition:{value:0,writable:!0},pattern:{value:null,writable:!0},patternDelay:{value:0,writable:!0},patternOffset:{value:0,writable:!0},timer:{value:0,writable:!0},initialize:{value:function(){var a=0,c;this.reset();this.timer=this.speed;this.position=this.order=0;this.nextPosition=
this.nextOrder=-1;this.complete=this.patternOffset=this.patternDelay=0;this.master=64;for(this.voices.length=this.channels;a<this.channels;++a)c=p(a),c.channel=this.mixer.channels[a],c.playing=this.instruments[0],c.sample=c.playing.samples[0],this.voices[a]=c,a&&(this.voices[a-1].next=c)}},loader:{value:function(d){var g,j,h,i,l,n,o,k=22,p,q;if(!(360>d.length)){d.position=17;this.title=d.readString(20);d.position++;j=d.readString(20);if("FastTracker v2.00   "==j)this.version=1;else if("Sk@le Tracker"==
j)this.version=k=2;else if("MadTracker 2.0"==j)this.version=3;else if("MilkyTracker        "==j)this.version=4;else if(-1!=j.indexOf("OpenMPT"))this.version=5;else return;d.readUshort();g=d.readUint();this.length=d.readUshort();this.restart=d.readUshort();this.channels=d.readUshort();q=p=d.readUshort();this.instruments=[];this.instruments.length=d.readUshort()+1;this.linear=d.readUshort();this.speed=d.readUshort();this.tempo=d.readUshort();this.track=new Uint8Array(this.length);for(j=0;j<this.length;++j)h=
d.readUbyte(),h>=q&&(p=h+1),this.track[j]=h;this.patterns=[];this.patterns.length=p;if(p!=q){i=b(64,this.channels);h=i.size;for(j=0;j<h;++j)i.rows[j]=a();this.patterns[--p]=i}d.position=o=g+60;n=q;for(j=0;j<n;++j){g=d.readUint();d.position++;i=b(d.readUshort(),this.channels);p=i.size;q=d.readUshort();d.position=o+g;l=d.position+q;if(q)for(h=0;h<p;++h)g=a(),q=d.readUbyte(),q&128?(q&1&&(g.note=d.readUbyte()),q&2&&(g.instrument=d.readUbyte()),q&4&&(g.volume=d.readUbyte()),q&8&&(g.effect=d.readUbyte()),
q&16&&(g.param=d.readUbyte())):(g.note=q,g.instrument=d.readUbyte(),g.volume=d.readUbyte(),g.effect=d.readUbyte(),g.param=d.readUbyte()),97!=g.note&&96<g.note&&(g.note=0),i.rows[h]=g;else for(h=0;h<p;++h)i.rows[h]=a();this.patterns[j]=i;o=d.position;o!=l&&(o=d.position=l)}l=d.position;n=this.instruments.length;for(j=1;j<n;++j){h=d.readUint();if(d.position+h>=d.length)break;i=e();i.name=d.readString(22);d.position++;q=d.readUshort();16<q&&(q=16);g=d.readUint();2==k&&64!=g&&(g=64);if(q){i.samples=[];
i.samples.length=q;for(h=0;96>h;++h)i.noteSamples[h]=d.readUbyte();for(h=0;12>h;++h)i.volData.points[h]=f(d.readUshort(),d.readUshort());for(h=0;12>h;++h)i.panData.points[h]=f(d.readUshort(),d.readUshort());i.volData.total=d.readUbyte();i.panData.total=d.readUbyte();i.volData.sustain=d.readUbyte();i.volData.loopStart=d.readUbyte();i.volData.loopEnd=d.readUbyte();i.panData.sustain=d.readUbyte();i.panData.loopStart=d.readUbyte();i.panData.loopEnd=d.readUbyte();i.volData.flags=d.readUbyte();i.panData.flags=
d.readUbyte();i.volData.flags&1&&(i.volEnabled=1);i.panData.flags&1&&(i.panEnabled=1);i.vibratoType=d.readUbyte();i.vibratoSweep=d.readUbyte();i.vibratoDepth=d.readUbyte();i.vibratoSpeed=d.readUbyte();i.fadeout=d.readUshort()<<1;d.position+=k;o=d.position;this.instruments[j]=i;for(h=0;h<q;++h)l=c(),l.length=d.readUint(),l.loopStart=d.readUint(),l.loopLen=d.readUint(),l.volume=d.readUbyte(),l.finetune=d.readByte(),l.loopMode=d.readUbyte(),l.panning=d.readUbyte(),l.relative=d.readByte(),d.position++,
l.name=d.readString(22),i.samples[h]=l,d.position=o+=g;for(h=0;h<q;++h)l=i.samples[h],l.length&&(o=d.position+l.length,l.loopMode&16&&(l.bits=16,l.loopMode^=16,l.length>>=1,l.loopStart>>=1,l.loopLen>>=1),l.loopLen||(l.loopMode=0),l.store(d),l.loopMode&&(l.length=l.loopStart+l.loopLen),d.position=o)}else d.position=l+h;l=d.position;if(l>=d.length)break}i=e();i.volData=m();i.panData=m();i.samples=[];for(j=0;12>j;++j)i.volData.points[j]=f(),i.panData.points[j]=f();l=c();l.length=220;l.data=new Float32Array(220);
for(j=0;220>j;++j)l.data[j]=0;i.samples[0]=l;this.instruments[0]=i}}},process:{value:function(){var a,c,b,g,f,e,h,i,k=this.voices[0];if(this.tick)for(;k;){e=this.pattern.rows[this.position+k.index];if(k.delay)if((e.param&15)==this.tick)k.flags=k.delay,k.delay=0;else{k=k.next;continue}if(e.volume)switch(c=e.volume>>4,b=e.volume&15,c){case 6:k.volume-=b;0>k.volume&&(k.volume=0);k.flags|=d;break;case 7:k.volume+=b;64<k.volume&&(k.volume=64);k.flags|=d;break;case 11:k.vibrato();break;case 13:k.panning-=
b;0>k.panning&&(k.panning=0);k.flags|=4;break;case 14:k.panning+=b;255<k.panning&&(k.panning=255);k.flags|=4;break;case 15:k.portaPeriod&&k.tonePortamento()}c=e.param>>4;b=e.param&15;switch(e.effect){case 0:if(!e.param)break;i=(this.tick-this.timer)%3;0>i&&(i+=3);2==this.tick&&18==this.timer&&(i=0);i?1==i?this.linear?k.arpDelta=-(b<<6):(i=this.amiga(k.note+b,k.finetune),k.arpDelta=i-k.period):this.linear?k.arpDelta=-(c<<6):(i=this.amiga(k.note+c,k.finetune),k.arpDelta=i-k.period):k.arpDelta=0;k.flags|=
j;break;case 1:k.period-=k.portaU;0>k.period&&(k.period=0);k.flags|=j;break;case 2:k.period+=k.portaD;9212<k.period&&(k.period=9212);k.flags|=j;break;case 3:k.portaPeriod&&k.tonePortamento();break;case 4:c&&(k.vibratoSpeed=c);b&&(k.vibratoDepth=b<<2);k.vibrato();break;case 5:f=1;k.portaPeriod&&k.tonePortamento();break;case 6:f=1;k.vibrato();break;case 7:k.tremolo();break;case 10:f=1;break;case 14:switch(c){case 9:0==this.tick%b&&(k.volEnvelope.reset(),k.panEnvelope.reset(),k.flags|=d|12);break;case 12:this.tick==
b&&(k.volume=0,k.flags|=d)}break;case 17:c=k.volSlideMaster>>4;b=k.volSlideMaster&15;c?(this.master+=c,64<this.master&&(this.master=64),k.flags|=d):b&&(this.master-=b,0>this.master&&(this.master=0),k.flags|=d);break;case 20:this.tick==e.param&&(k.fadeEnabled=1,k.keyoff=1);break;case 24:c=k.panSlide>>4;b=k.panSlide&15;c?(k.panning+=c,255<k.panning&&(k.panning=255),k.flags|=4):b&&(k.panning-=b,0>k.panning&&(k.panning=0),k.flags|=4);break;case 27:a=this.tick;e.volume||a++;if(a%k.retrigy)break;(!e.volume||
80<e.volume)&&k.retrigx&&this.retrig(k);k.flags|=8;break;case 29:k.tremor()}f&&(c=k.volSlide>>4,b=k.volSlide&15,f=0,c?(k.volume+=c,k.flags|=d):b&&(k.volume-=b,k.flags|=d));k=k.next}else{0<=this.nextOrder&&(this.order=this.nextOrder);0<=this.nextPosition&&(this.position=this.nextPosition);this.nextOrder=this.nextPosition=-1;for(this.pattern=this.patterns[this.track[this.order]];k;){e=this.pattern.rows[this.position+k.index];a=e.volume>>4;f=3==e.effect||5==e.effect||15==a;c=e.param>>4;k.keyoff=0;k.arpDelta&&
(k.arpDelta=0,k.flags|=j);if(e.instrument)k.instrument=e.instrument<this.instruments.length?this.instruments[e.instrument]:null,k.volEnvelope.reset(),k.panEnvelope.reset(),k.flags|=d|36;else if(97==e.note||20==e.effect&&!e.param)k.fadeEnabled=1,k.keyoff=1;e.note&&97!=e.note?k.instrument?(b=k.instrument,i=e.note-1,h=b.samples[b.noteSamples[i]],i+=h.relative,0<=i&&118>=i&&(f||(k.note=i,k.sample=h,e.instrument?(k.volEnabled=b.volEnabled,k.panEnabled=b.panEnabled,k.flags|=15):k.flags|=j|8),e.instrument?
(k.reset(),k.fadeDelta=b.fadeout):k.finetune=h.finetune>>3<<2,14==e.effect&&5==c&&(k.finetune=(e.param&15)-8<<3),i=this.linear?(120-i<<6)-k.finetune:this.amiga(i,k.finetune),f?k.portaPeriod=i:(k.period=i,k.glissPeriod=0))):(k.volume=0,k.flags=d|32):k.vibratoReset&&4!=e.effect&&6!=e.effect&&(k.vibDelta=0,k.vibratoReset=0,k.flags|=j);if(e.volume)if(16<=e.volume&&80>=e.volume)k.volume=e.volume-16,k.flags|=d|32;else switch(b=e.volume&15,a){case 6:k.volume-=b;0>k.volume&&(k.volume=0);k.flags|=d;break;
case 7:k.volume+=b;64<k.volume&&(k.volume=64);k.flags|=d;break;case 10:b&&(k.vibratoSpeed=b);break;case 11:b&&(k.vibratoDepth=b<<2);break;case 12:k.panning=b<<4;k.flags|=4;break;case 15:b&&(k.portaSpeed=b<<4)}if(e.effect)switch(b=e.param&15,e.effect){case 1:e.param&&(k.portaU=e.param<<2);break;case 2:e.param&&(k.portaD=e.param<<2);break;case 3:e.param&&15!=a&&(k.portaSpeed=e.param);break;case 4:k.vibratoReset=1;break;case 5:e.param&&(k.volSlide=e.param);break;case 6:e.param&&(k.volSlide=e.param);
k.vibratoReset=1;break;case 7:c&&(k.tremoloSpeed=c);b&&(k.tremoloDepth=b);break;case 8:k.panning=e.param;k.flags|=4;break;case 9:e.param&&(k.sampleOffset=e.param<<8);k.sampleOffset>=k.sample.length&&(k.volume=0,k.sampleOffset=0,k.flags&=~(j|8),k.flags|=d|32);break;case 10:e.param&&(k.volSlide=e.param);break;case 11:this.nextOrder=e.param;this.nextOrder>=this.length?this.complete=1:this.nextPosition=0;g=1;this.patternOffset=0;break;case 12:k.volume=e.param;k.flags|=d|32;break;case 13:this.nextPosition=
(10*c+b)*this.channels;this.patternOffset=0;g||(this.nextOrder=this.order+1,this.nextOrder>=this.length&&(this.complete=1,this.nextPosition=-1));break;case 14:switch(c){case 1:b&&(k.finePortaU=b<<2);k.period-=k.finePortaU;k.flags|=j;break;case 2:b&&(k.finePortaD=b<<2);k.period+=k.finePortaD;k.flags|=j;break;case 3:k.glissando=b;break;case 4:k.waveControl=k.waveControl&240|b;break;case 6:b?(k.patternLoop?k.patternLoop--:k.patternLoop=b,k.patternLoop&&(this.nextPosition=k.patternLoopRow)):k.patternLoopRow=
this.patternOffset=this.position;break;case 7:k.waveControl=k.waveControl&15|b<<4;break;case 10:b&&(k.fineSlideU=b);k.volume+=k.fineSlideU;k.flags|=d;break;case 11:b&&(k.fineSlideD=b);k.volume-=k.fineSlideD;k.flags|=d;break;case 13:k.delay=k.flags;k.flags=0;break;case 14:this.patternDelay=b*this.timer}break;case 15:if(!e.param)break;32>e.param?this.timer=e.param:this.mixer.samplesTick=2.5*this.sampleRate/e.param>>0;break;case 16:this.master=e.param;64<this.master&&(this.master=64);k.flags|=d;break;
case 17:e.param&&(k.volSlideMaster=e.param);break;case 21:if(!k.instrument||!k.instrument.volEnabled)break;b=k.instrument;i=e.param;c=b.volData.total;for(a=0;a<c&&!(i<b.volData.points[a].frame);a++);k.volEnvelope.position=--a;c--;b.volData.flags&4&&a==b.volData.loopEnd&&(a=k.volEnvelope.position=b.volData.loopStart,i=b.volData.points[a].frame,k.volEnvelope.frame=i);a>=c?(k.volEnvelope.value=b.volData.points[c].value,k.volEnvelope.stopped=1):(k.volEnvelope.stopped=0,k.volEnvelope.frame=i,i>b.volData.points[a].frame&&
k.volEnvelope.position++,c=b.volData.points[a],a=b.volData.points[++a],i=a.frame-c.frame,k.volEnvelope.delta=(i?(a.value-c.value<<8)/i>>0:0)||0,k.volEnvelope.fraction=c.value<<8);break;case 24:e.param&&(k.panSlide=e.param);break;case 27:c&&(k.retrigx=c);b&&(k.retrigy=b);if(!e.volume&&k.retrigy){a=this.tick+1;if(a%k.retrigy)break;80<e.volume&&k.retrigx&&this.retrig(k)}break;case 29:e.param&&(k.tremorOn=++c,k.tremorOff=++b+c);break;case 33:1==c?(b&&(k.xtraPortaU=b),k.period-=k.xtraPortaU,k.flags|=j):
2==c&&(b&&(k.xtraPortaD=b),k.period+=k.xtraPortaD,k.flags|=j)}k=k.next}}if(++this.tick>=this.timer+this.patternDelay&&(this.patternDelay=this.tick=0,0>this.nextPosition&&(this.nextPosition=this.position+this.channels,this.nextPosition>=this.pattern.size||this.complete)))this.nextOrder=this.order+1,this.nextPosition=this.patternOffset,this.nextOrder>=this.length&&(this.nextOrder=this.restart,this.mixer.complete=1)}},fast:{value:function(){for(var a,b,c,e,g,f=this.voices[0],i;f;)a=f.channel,c=f.flags,
f.flags=0,c&8&&(a.index=f.sampleOffset,a.pointer=-1,a.dir=0,a.fraction=0,a.sample=f.sample,a.length=f.sample.length,a.enabled=a.sample.data?1:0,f.playing=f.instrument,f.sampleOffset=0),e=f.playing,b=e.vibratoSpeed?f.autoVibrato():0,i=f.volume+f.volDelta,e.volEnabled?(f.volEnabled&&!f.volEnvelope.stopped&&this.envelope(f,f.volEnvelope,e.volData),i=i*f.volEnvelope.value>>6,c|=d,f.fadeEnabled&&(f.fadeVolume-=f.fadeDelta,0>f.fadeVolume?(i=0,f.fadeVolume=0,f.fadeEnabled=0,f.volEnvelope.value=0,f.volEnvelope.stopped=
1,f.panEnvelope.stopped=1):i=i*f.fadeVolume>>16)):f.keyoff&&(i=0,c|=d),g=f.panning,e.panEnabled&&(f.panEnabled&&!f.panEnvelope.stopped&&this.envelope(f,f.panEnvelope,e.panData),g=f.panEnvelope.value<<2,c|=4,0>g?g=0:255<g&&(g=255)),c&d&&(0>i?i=0:64<i&&(i=64),a.volume=l[i*this.master>>6],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),c&4&&(a.panning=g,a.lpan=q[256-g],a.rpan=q[g],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),c&j&&(b+=f.period+f.arpDelta+f.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,
(4608-b)/768)/this.sampleRate>>0)/65536:(65536*(14317456/b)/this.sampleRate>>0)/65536,a.delta=a.speed>>0,a.speed-=a.delta),f=f.next}},accurate:{value:function(){for(var a,c,b,e,f,g,i,h=this.voices[0];h;)a=h.channel,b=h.flags,h.flags=0,b&8&&(a.sample&&(b|=32,a.mixCounter=220,a.oldSample=null,a.oldPointer=-1,a.enabled&&(a.oldDir=a.dir,a.oldFraction=a.fraction,a.oldSpeed=a.speed,a.oldSample=a.sample,a.oldPointer=a.pointer,a.oldLength=a.length,a.lmixRampD=a.lvol,a.lmixDeltaD=a.lvol/220,a.rmixRampD=a.rvol,
a.rmixDeltaD=a.rvol/220)),a.dir=1,a.fraction=0,a.sample=h.sample,a.pointer=h.sampleOffset,a.length=h.sample.length,a.enabled=a.sample.data?1:0,h.playing=h.instrument,h.sampleOffset=0),e=h.playing,c=e.vibratoSpeed?h.autoVibrato():0,f=h.volume+h.volDelta,e.volEnabled?(h.volEnabled&&!h.volEnvelope.stopped&&this.envelope(h,h.volEnvelope,e.volData),f=f*h.volEnvelope.value>>6,b|=d,h.fadeEnabled&&(h.fadeVolume-=h.fadeDelta,0>h.fadeVolume?(f=0,h.fadeVolume=0,h.fadeEnabled=0,h.volEnvelope.value=0,h.volEnvelope.stopped=
1,h.panEnvelope.stopped=1):f=f*h.fadeVolume>>16)):h.keyoff&&(f=0,b|=d),g=h.panning,e.panEnabled&&(h.panEnabled&&!h.panEnvelope.stopped&&this.envelope(h,h.panEnvelope,e.panData),g=h.panEnvelope.value<<2,b|=4,0>g?g=0:255<g&&(g=255)),a.enabled?(b&d&&(0>f?f=0:64<f&&(f=64),f=l[f*this.master>>6],e=f*q[256-g],i=f*q[g],f!=a.volume&&!a.mixCounter?(a.volCounter=b&32?220:this.mixer.samplesTick,a.lvolDelta=(e-a.lvol)/a.volCounter,a.rvolDelta=(i-a.rvol)/a.volCounter):(a.lvol=e,a.rvol=i),a.volume=f),b&4&&(f=q[256-
g],e=q[g],g!=a.panning&&!a.mixCounter&&!a.volCounter?(a.panCounter=this.mixer.samplesTick,a.lpanDelta=(f-a.lpan)/a.panCounter,a.rpanDelta=(e-a.rpan)/a.panCounter):(a.lpan=f,a.rpan=e),a.panning=g),b&j&&(c+=h.period+h.arpDelta+h.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-c)/768)/this.sampleRate>>0)/65536:(65536*(14317456/c)/this.sampleRate>>0)/65536),a.mixCounter&&(a.lmixRampU=0,a.lmixDeltaU=a.lvol/220,a.rmixRampU=0,a.rmixDeltaU=a.rvol/220)):(a.volCounter=0,a.panCounter=0),h=h.next}},
envelope:{value:function(a,b,c){var d=b.position,e=c.points[d];if(b.frame==e.frame){c.flags&4&&d==c.loopEnd&&(d=b.position=c.loopStart,e=c.points[d],b.frame=e.frame);if(d==c.total-1){b.value=e.value;b.stopped=1;return}if(c.flags&2&&d==c.sustain&&!a.fadeEnabled){b.value=e.value;return}b.position++;a=c.points[b.position];b.delta=(a.value-e.value<<8)/(a.frame-e.frame)>>0||0;b.fraction=e.value<<8}else b.fraction+=b.delta;b.value=b.fraction>>8;b.frame++}},amiga:{value:function(a,b){var c=0,d=o[++a];0>
b?c=(o[--a]-d)/64:0<b&&(c=(d-o[++a])/64);return d-c*b>>0}},retrig:{value:function(a){switch(a.retrigx){case 1:a.volume--;break;case 2:a.volume++;break;case 3:a.volume-=4;break;case 4:a.volume-=8;break;case 5:a.volume-=16;break;case 6:a.volume=(a.volume<<1)/3;break;case 7:a.volume>>=1;break;case 8:a.volume=a.sample.volume;break;case 9:a.volume++;break;case 10:a.volume+=2;break;case 11:a.volume+=4;break;case 12:a.volume+=8;break;case 13:a.volume+=16;break;case 14:a.volume=3*a.volume>>1;break;case 15:a.volume<<=
1}0>a.volume?a.volume=0:64<a.volume&&(a.volume=64);a.flags|=d}}});return Object.seal(g)}})();
